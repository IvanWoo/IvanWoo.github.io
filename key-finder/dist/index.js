var or="production";function Le(t,e,n,i){var s=arguments.length,c=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,n,i);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(c=(s<3?r(c):s>3?r(e,n,c):r(e,n))||c);return s>3&&c&&Object.defineProperty(e,n,c),c}var Ve=(t,e={})=>{let n=Reflect.ownKeys(t),i=Reflect.ownKeys(e),s=Symbol("isa");function c(r){for(let o of n){let a=Object.getOwnPropertyDescriptor(r.prototype,o);!a||a.configurable?Object.defineProperty(r.prototype,o,{value:t[o],writable:!0}):console.log(`not patching: ${r.name}.${o.toString()}`)}return Object.defineProperty(r.prototype,s,{value:!0}),r}for(let r of i)Object.defineProperty(c,r,{value:e[r],enumerable:e.propertyIsEnumerable(r)});return Object.defineProperty(c,Symbol.hasInstance,{value:r=>!!r[s]}),c};var ve=(t,e=n=>n!==void 0?": "+n:"")=>class extends Error{constructor(n){super(t(n)+e(n))}};var H=Array.isArray;var re=t=>typeof t=="string";var Nn=Ve({addWatch(t,e){return this._watches=this._watches||{},this._watches[t]?!1:(this._watches[t]=e,!0)},removeWatch(t){if(!!this._watches)return this._watches[t]?(delete this._watches[t],!0):!1},notifyWatches(t,e){if(!this._watches)return;let n=this._watches;for(let i in n)n[i](i,t,e)}}),Dn=t=>t&&(t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Int8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Uint8ClampedArray),Fn=ve(()=>"illegal state"),jn=t=>{throw new Fn(t)},ze=t=>H(t)?t:re(t)?t.length>0?t.split("."):[]:t!=null?[t]:[],sr=t=>qe(t);function qe(t){let e=ze(t),[n,i,s,c]=e;switch(e.length){case 0:return r=>r;case 1:return r=>r!=null?r[n]:void 0;case 2:return r=>r!=null&&(r=r[n])!=null?r[i]:void 0;case 3:return r=>r!=null&&(r=r[n])!=null&&(r=r[i])!=null?r[s]:void 0;case 4:return r=>r!=null&&(r=r[n])!=null&&(r=r[i])!=null&&(r=r[s])!=null?r[c]:void 0;default:return r=>{let o=e.length-1,a=r;for(let u=0;a!=null&&u<=o;u++)a=a[e[u]];return a}}}var ar=t=>xe(t);function xe(t){let e=ze(t),[n,i,s,c]=e;switch(e.length){case 0:return(o,a)=>a;case 1:return(o,a)=>(o=ne(o),o[n]=a,o);case 2:return(o,a)=>{let u;return o=ne(o),o[n]=u=ne(o[n]),u[i]=a,o};case 3:return(o,a)=>{let u,f;return o=ne(o),o[n]=u=ne(o[n]),u[i]=f=ne(u[i]),f[s]=a,o};case 4:return(o,a)=>{let u,f,h;return o=ne(o),o[n]=u=ne(o[n]),u[i]=f=ne(u[i]),f[s]=h=ne(f[s]),h[c]=a,o};default:let r;for(let o=e.length;--o>=0;)r=Rn(e[o],r);return r}}var ne=t=>H(t)||Dn(t)?t.slice():Object.assign({},t),Rn=(t,e)=>(n,i)=>(n=ne(n),n[t]=e?e(n[t],i):i,n),Ce=(t,e,n,...i)=>Pn(t,e,n,...i);function Pn(t,e,n,...i){return xe(e)(t,n.apply(null,(i.unshift(qe(e)(t)),i)))}var $e=(t,e,n)=>xe(e)(t,n),me=class{constructor(e,n){n&&!n(e)&&jn("initial state value did not validate"),this._value=e,this.valid=n}get value(){return this._value}set value(e){this.reset(e)}deref(){return this._value}equiv(e){return this===e}reset(e){let n=this._value;return this.valid&&!this.valid(e)?n:(this._value=e,this.notifyWatches(n,e),e)}resetIn(e,n){return this.reset($e(this._value,e,n))}resetInUnsafe(e,n){return this.reset($e(this._value,e,n))}swap(e,...n){return this.reset(e.apply(null,[this._value,...n]))}swapIn(e,n,...i){return this.reset(Ce(this._value,e,n,...i))}swapInUnsafe(e,n,...i){return this.reset(Ce(this._value,e,n,...i))}addWatch(e,n){}removeWatch(e){}notifyWatches(e,n){}release(){return delete this._watches,delete this._value,!0}};me=Le([Nn],me);var cr=Object.getPrototypeOf({}),We="function",ur="string",K=(t,e)=>{let n;if(t===e)return!0;if(t!=null){if(typeof t.equiv===We)return t.equiv(e)}else return t==e;if(e!=null){if(typeof e.equiv===We)return e.equiv(t)}else return t==e;return typeof t===ur||typeof e===ur?!1:(n=Object.getPrototypeOf(t),(n==null||n===cr)&&(n=Object.getPrototypeOf(e),n==null||n===cr)?jt(t,e):typeof t!==We&&t.length!==void 0&&typeof e!==We&&e.length!==void 0?Nt(t,e):t instanceof Set&&e instanceof Set?Dt(t,e):t instanceof Map&&e instanceof Map?Ft(t,e):t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():t instanceof RegExp&&e instanceof RegExp?t.toString()===e.toString():t!==t&&e!==e)},Nt=(t,e,n=K)=>{let i=t.length;if(i===e.length)for(;--i>=0&&n(t[i],e[i]););return i<0},Dt=(t,e,n=K)=>t.size===e.size&&n([...t.keys()].sort(),[...e.keys()].sort()),Ft=(t,e,n=K)=>t.size===e.size&&n([...t].sort(),[...e].sort()),jt=(t,e,n=K)=>{if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let i in t)if(!e.hasOwnProperty(i)||!n(t[i],e[i]))return!1;return!0};var Gn=0,Un=()=>Gn++;function Rt(t,e,n,i,s){return new fr(t,e,n,i,s)}var fr=class{constructor(e,n,i,s=!0,c=K){this.parent=e,this.id=`view-${Un()}`,this.tx=i||(a=>a),this.path=ze(n),this.isDirty=!0,this.isLazy=s;let r=sr(this.path),o=this.parent.deref();this.unprocessed=o?r(o):void 0,s||(this.state=this.tx(this.unprocessed),this.unprocessed=void 0),e.addWatch(this.id,(a,u,f)=>{let h=u&&r(u),d=f&&r(f);c(d,h)||(s?this.unprocessed=d:this.state=this.tx(d),this.isDirty=!0)})}get value(){return this.deref()}deref(){return this.isDirty&&(this.isLazy&&(this.state=this.tx(this.unprocessed),this.unprocessed=void 0),this.isDirty=!1),this.state}changed(){return this.isDirty}view(){return this.isDirty&&this.isLazy?this.tx(this.unprocessed):this.state}release(){return this.unprocessed=void 0,this.isLazy||(this.state=this.tx(void 0)),this.isDirty=!0,this.parent.removeWatch(this.id)}};var pe=Symbol(),Oe=()=>{},lr="*";var Ne=t=>typeof t=="function";var Hn=ve(()=>"illegal argument(s)"),ce=t=>{throw new Hn(t)};var se=(t,e)=>t!=null&&typeof t[e]=="function";var Bn=t=>t!=null&&typeof t.deref=="function",Ye=t=>Bn(t)?t.deref():t,hr=t=>t!=null&&typeof t!="string"&&typeof t[Symbol.iterator]=="function",dr=Object.getPrototypeOf,Ln=t=>{let e;return t!=null&&typeof t=="object"&&((e=dr(t))===null||dr(e)===null)},Ke,Je,Vn=[],zn=[],qn=t=>Ke&&Ke.length>=t?Ke:Ke=new Int32Array(t),$n=t=>Je&&Je.length>=t?Je:Je=new Int32Array(t),mr=(t,e,n,i,s)=>{let c=e.length,r=t.linear;if(t.distance=c,s!=="only-distance"){for(let o=0,a=0;o<c;o++,a+=3)r[a]=i,r[a+1]=o,r[a+2]=e[o];if(s==="full"){let o=t[n];for(let a=0;a<c;a++)o[a]=e[a]}}return t},Kn=(t,e,n="full",i=K)=>{let s={distance:0,adds:{},dels:{},const:{},linear:[]};if(t===e||t==null&&e==null)return s;if(t==null||t.length===0)return mr(s,e,"adds",1,n);if(e==null||e.length===0)return mr(s,t,"dels",-1,n);let c=t.length>=e.length,r,o,a,u;c?(r=e,o=t):(r=t,o=e),a=r.length,u=o.length;let f=a+1,h=u-a,d=h+f,g=a+u+3,E=$n(g).fill(-1,0,g),M=qn(g).fill(-1,0,g),I=Vn,v=zn,_=(R,U,Z)=>{let oe,B;U>Z?(oe=E[R-1],B=U):(oe=E[R+1],B=Z);let ee=B-(R-f);for(;ee<a&&B<u&&i(r[ee],o[B]);)ee++,B++;E[R]=v.length/3,v.push(ee,B,oe),M[R]=B},T=-1,A;do{for(T++,A=-T+f;A<d;A++)_(A,M[A-1]+1,M[A+1]);for(A=d+T;A>d;A--)_(A,M[A-1]+1,M[A+1]);_(d,M[d-1]+1,M[d+1])}while(M[d]!==u);if(s.distance=h+2*T,n!=="only-distance"){for(T=E[d]*3;T>=0;)I.push(T),T=v[T+2]*3;n==="full"?Wn(I,v,s,r,o,c):Yn(I,v,s,r,o,c,n==="only-distance-linear")}return I.length=0,v.length=0,s},Wn=(t,e,n,i,s,c)=>{let r=n.linear,o=n.const,a=t.length,u=0,f=0,h,d,g,E;for(c?(h=n.dels,d=n.adds,g=-1,E=1):(h=n.adds,d=n.dels,g=1,E=-1);--a>=0;){let M=t[a],I=e[M],v=e[M+1],_=v-I;for(;u<I||f<v;){let T=f-u;_>T?(r.push(g,f,h[f]=s[f]),f++):_<T?(r.push(E,u,d[u]=i[u]),u++):(r.push(0,u,o[u]=i[u]),u++,f++)}}},Yn=(t,e,n,i,s,c,r)=>{let o=n.linear,a=c?-1:1,u=c?1:-1,f=t.length,h=0,d=0;for(;--f>=0;){let g=t[f],E=e[g],M=e[g+1],I=M-E;for(;h<E||d<M;){let v=d-h;I>v?(o.push(a,d,s[d]),d++):I<v?(o.push(u,h,i[h]),h++):(r&&o.push(0,h,i[h]),h++,d++)}}},Qn=(t,e,n="full",i=K)=>t===e?{distance:0}:n==="only-distance"?Jn(t,e,i):Xn(t,e,i),Jn=(t,e,n)=>{t||(t={}),e||(e={});let i=0;for(let s in t){let c=e[s];(c===void 0||!n(t[s],c))&&i++}for(let s in e)!(s in t)&&i++;return{distance:i}},Xn=(t,e,n)=>{t||(t={}),e||(e={});let i=0,s=[],c=[],r=[];for(let o in t){let a=e[o];a===void 0?(c.push(o),i++):n(t[o],a)||(r.push(o,a),i++)}for(let o in e)o in t||(s.push(o),i++);return{distance:i,adds:s,dels:c,edits:r}},Xe=Array.isArray,Zn=Math.max,pr=Object.getPrototypeOf({}),Qe="function",Ze="string",gr=(()=>{let t=new Array(2048);for(let e=2,n=t.length;e<n;e++)t[e]=e-2;return t})(),ei=t=>{if(t<=gr.length)return gr.slice(0,t);let e=new Array(t);for(;--t>=2;)e[t]=t-2;return e},yr=(t,e,n,i,s,c=0)=>{let r=s[1];if(r.__skip)return;if(r.__diff===!1){De(i),e.replaceChild(t,n,c,s);return}let o=i[1];if(o&&o.__skip){e.replaceChild(t,n,c,s,!1);return}let a=r.__impl;if(a&&a!==e)return a.diffTree(t,a,n,i,s,c);let u=Kn(i,s,"only-distance-linear",Fe);if(u.distance===0)return;let f=u.linear,h=e.getChild(n,c),d,g,E;if(f[0]!==0||i[1].key!==r.key){De(i),e.replaceChild(t,n,c,s);return}if((E=i.__release)&&E!==s.__release&&De(i),f[3]!==0&&(ni(e,h,i[1],s[1]),u.distance===2))return;let M=f.length,I=i.length-1,v=ii(f),_=ei(I+1);for(d=6;d<M;d+=3)g=f[d],!!g&&(g===-1?ti(t,e,h,i,s,f,d,v,_,I):ri(t,e,h,f,d,v,_,I));(E=s.__init)&&E!=i.__init&&E.apply(s,[h,...s.__args])},ti=(t,e,n,i,s,c,r,o,a,u)=>{let f=c[r+2];if(Xe(f)){let h=f[1].key;if(h!==void 0&&o[h][2]!==void 0){let d=o[h];h=d[0],yr(t,e,n,i[h],s[d[2]],a[h])}else{let d=c[r+1];De(f),e.removeChild(n,a[d]),oi(a,u,d)}}else typeof f===Ze&&e.setContent(n,"")},ri=(t,e,n,i,s,c,r,o)=>{let a=i[s+2];if(typeof a===Ze)e.setContent(n,a);else if(Xe(a)){let u=a[1].key;if(u===void 0||c[u][0]===void 0){let f=i[s+1];e.createTree(t,n,a,r[f]),si(r,o,f)}}},oi=(t,e,n)=>{for(;e>n;e--)t[e]=Zn(t[e]-1,0)},si=(t,e,n)=>{for(;e>=n;e--)t[e]++},ni=(t,e,n,i)=>{let s=Qn(n,i,"full",K);t.removeAttribs(e,s.dels,n);let c=pe,r,o,a;for(a=s.edits,r=a.length;(r-=2)>=0;)o=a[r],o[0]==="o"&&o[1]==="n"&&t.removeAttribs(e,[o],n),o!=="value"?t.setAttrib(e,o,a[r+1],i):c=a[r+1];for(a=s.adds,r=a.length;--r>=0;)o=a[r],o!=="value"?t.setAttrib(e,o,i[o],i):c=i[o];c!==pe&&t.setAttrib(e,"value",c,i)},De=t=>{if(Xe(t)){let e;if((e=t[1])&&e.__release===!1)return;for(t.__release&&(t.__release.apply(t.__this,t.__args),delete t.__release),e=t.length;--e>=2;)De(t[e])}},ii=t=>{let e,n,i,s={};for(let c=t.length;(c-=3)>=0;)n=t[c+2],Xe(n)&&(e=n[1].key)!==void 0&&(i=s[e],!i&&(s[e]=i=[,,]),i[t[c]+1]=t[c+1]);return s},Fe=(t,e)=>{let n;if(t===e)return!0;if(t!=null){if(typeof t.equiv===Qe)return t.equiv(e)}else return t==e;if(e!=null){if(typeof e.equiv===Qe)return e.equiv(t)}else return t==e;return typeof t===Ze||typeof e===Ze?!1:(n=Object.getPrototypeOf(t),(n==null||n===pr)&&(n=Object.getPrototypeOf(e),n==null||n===pr)?!(t.__diff===!1||e.__diff===!1)&&jt(t,e,Fe):typeof t!==Qe&&t.length!==void 0&&typeof e!==Qe&&e.length!==void 0?Nt(t,e,Fe):t instanceof Set&&e instanceof Set?Dt(t,e,Fe):t instanceof Map&&e instanceof Map?Ft(t,e,Fe):t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():t instanceof RegExp&&e instanceof RegExp?t.toString()===e.toString():t!==t&&e!==e)},ai={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},ci=/^([^\s\.#]+)(?:#([^\s\.#]+))?(?:\.([^\s#]+))?$/,Ia=new RegExp(`[${Object.keys(ai).join("")}]`,"g"),ui={button:1,option:1,script:1,style:1,text:1,textarea:1,title:1},Pt=t=>t.split(" ").reduce((e,n)=>(e[n]=!0,e),{}),fi=Pt("animate animateColor animateMotion animateTransform circle clipPath color-profile defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font foreignObject g image line linearGradient marker mask metadata mpath path pattern polygon polyline radialGradient rect set stop style svg switch symbol text textPath title tref tspan use view"),Sa=Pt("area base br col command embed hr img input keygen link meta param source stop track use wbr ?xml"),wa=Pt("animate circle ellipse line path polygon polyline rect"),br=(t,e)=>{if(e=Ye(e),e==null)return t;if(re(e))return t+" "+e;let n=new Set(t.split(" "));for(let i in e)Ye(e[i])?n.add(i):n.delete(i);return[...n].join(" ")},li=(t,e,n)=>{e&&(t.id=e);let i=Ye(t.class);return n?(n=n.replace(/\./g," "),t.class=i?br(n,i):n):i&&(t.class=re(i)?i:br("",i)),t},hi=t=>{let e="",n;for(let i in t)n=Ye(t[i]),Ne(n)&&(n=n(t)),n!=null&&(e+=`${i}:${n};`);return e},di=(t,e)=>{if(t==null||!e||!e.length)return t;let n=Object.assign({},t);for(let i of e){let s=n[i];se(s,"deref")&&(n[i]=s.deref())}return n},mi=t=>Object.keys(t).reduce((e,n)=>(e.push(`${n}: ${t[n]}`),e),[]).join(" "),pi="http://www.w3.org/2000/svg",et=H,_r=hr,vr=re,Er=(t,e)=>e.__init&&e.__init.apply(e.__this,[t,...e.__args]),tt=(t,e,n,i,s,c=!0)=>{if(et(i)){let r=i[0];if(typeof r=="function")return tt(t,e,n,r.apply(null,[t.ctx,...i.slice(1)]),s);let o=i[1];if(o.__impl)return o.__impl.createTree(t,n,i,s,c);let a=e.createElement(n,r,o,s);if(i.length>2){let u=i.length;for(let f=2;f<u;f++)tt(t,e,a,i[f],void 0,c)}return c&&Er(a,i),a}if(_r(i)){let r=[];for(let o of i)r.push(tt(t,e,n,o,s,c));return r}return i==null?n:e.createTextElement(n,i)},rt=(t,e,n,i,s=0)=>{if(et(i)){let c=e.getChild(n,s);typeof i[0]=="function"&&rt(t,e,n,i[0].apply(null,[t.ctx,...i.slice(1)]),s);let r=i[1];if(r.__impl)return r.__impl.hydrateTree(t,n,i,s);Er(c,i);for(let o in r)o[0]==="o"&&o[1]==="n"&&e.setAttrib(c,o,r[o]);for(let o=i.length,a=2;a<o;a++)rt(t,e,c,i[a],a-2)}else if(_r(i))for(let c of i)rt(t,e,n,c,s),s++},yi=(t,e,n,i)=>{let s=fi[e]?document.createElementNS(pi,e):document.createElement(e);return n&&gi(s,n),Ir(t,s,i)},bi=(t,e,n)=>Ir(t,document.createTextNode(e),n),Ir=(t,e,n)=>t?n===void 0?t.appendChild(e):t.insertBefore(e,t.children[n]):e,_i=(t,e)=>t.children[e],vi=(t,e,n,i,s,c=!0)=>(e.removeChild(n,i),e.createTree(t,n,s,i,c)),Ei=(t,e)=>t.textContent=e,gi=(t,e)=>{for(let n in e)Sr(t,n,e[n],e);return t},Sr=(t,e,n,i)=>{if(e.startsWith("__"))return;let s=e[0]==="o"&&e[1]==="n";if(!s&&typeof n=="function"&&(n=n(i)),n!==void 0&&n!==!1)switch(e){case"style":Si(t,n);break;case"value":Ii(t,n);break;case"prefix":t.setAttribute(e,vr(n)?n:mi(n));break;case"accesskey":t.accessKey=n;break;case"contenteditable":t.contentEditable=n;break;case"tabindex":t.tabIndex=n;break;case"align":case"autocapitalize":case"checked":case"dir":case"draggable":case"hidden":case"id":case"lang":case"namespaceURI":case"scrollTop":case"scrollLeft":case"title":t[e]=n;break;default:s?wi(t,e.substr(2),n):t.setAttribute(e,n===!0?"":n)}else t[e]!=null?t[e]=null:t.removeAttribute(e);return t},Ii=(t,e)=>{let n;switch(t.type){case"text":case"textarea":case"password":case"search":case"number":case"email":case"url":case"tel":case"date":case"datetime-local":case"time":case"week":case"month":if((n=t.value)!==void 0&&typeof e=="string"){let i=e.length-(n.length-(t.selectionStart||0));t.value=e,t.selectionStart=t.selectionEnd=i;break}default:t.value=e}},Ti=(t,e,n)=>{for(let i=e.length;--i>=0;){let s=e[i];s[0]==="o"&&s[1]==="n"?Mi(t,s.substr(2),n[s]):t.hasAttribute(s)?t.removeAttribute(s):t[s]=null}},Si=(t,e)=>(t.setAttribute("style",hi(e)),t),wi=(t,e,n)=>vr(n)?t.setAttribute("on"+e,n):et(n)?t.addEventListener(e,...n):t.addEventListener(e,n),Mi=(t,e,n)=>et(n)?t.removeEventListener(e,...n):t.removeEventListener(e,n),Ai=(t,e)=>{let n=t.children[e];n!==void 0&&t.removeChild(n)},nt=H,ki=hr,xi=Ln,Ci=(t,e)=>{let n=t[0],i=xi(t[1]),s,c,r;return(typeof n!="string"||!(s=ci.exec(n)))&&ce(`${n} is not a valid tag name`),c=s[1],n===c&&i&&(!e||t[1].key)?t:(r=li(i?Object.assign({},t[1]):{},s[2],s[3]),r.__skip&&t.length<3?[c,r]:[c,r,...t.slice(i?2:1)])},Oi=(t,e)=>ue(e,t,t.ctx,[0],t.keys!==!1,t.span!==!1),ue=(t,e,n,i,s,c)=>{if(t!=null){if(nt(t)){if(t.length===0)return;let r,o=t[1],a;if(o&&(a=o.__impl)&&(a=a.normalizeTree))return a(e,t);let u=t[0];if(typeof u=="function")return ue(u.apply(null,[n,...t.slice(1)]),e,n,i,s,c);if(typeof u.render=="function"){let f=[n,...t.slice(1)];return r=ue(u.render.apply(u,f),e,n,i,s,c),nt(r)&&(r.__this=u,r.__init=u.init,r.__release=u.release,r.__args=f),r}return r=Ci(t,s),o=r[1],o.__normalize===!1?r:(s&&o.key===void 0&&(o.key=i.join("-")),r.length>2?Ni(r,o,e,n,i,s,c):r)}return typeof t=="function"?ue(t(n),e,n,i,s,c):typeof t.toHiccup=="function"?ue(t.toHiccup(e.ctx),e,n,i,s,c):typeof t.deref=="function"?ue(t.deref(),e,n,i,s,c):c?["span",s?{key:i.join("-")}:{},t.toString()]:t.toString()}},Ni=(t,e,n,i,s,c,r)=>{let o=t[0],a=[o,e];r=r&&!ui[o];for(let u=2,f=2,h=0,d=t.length;u<d;u++){let g=t[u];if(g!=null){let E=nt(g);if(E&&nt(g[0])||!E&&ki(g))for(let M of g)M=ue(M,n,i,s.concat(h),c,r),M!==void 0&&(a[f++]=M),h++;else g=ue(g,n,i,s.concat(h),c,r),g!==void 0&&(a[f++]=g),h++}}return a},Di={createTree(t,e,n,i,s){return tt(t,this,e,n,i,s)},hydrateTree(t,e,n,i){return rt(t,this,e,n,i)},diffTree(t,e,n,i,s){yr(t,this,e,n,i,s)},normalizeTree:Oi,getElementById(t){return document.getElementById(t)},getChild:_i,createElement:yi,createTextElement:bi,replaceChild(t,e,n,i,s){vi(t,this,e,n,i,s)},removeChild:Ai,setContent:Ei,removeAttribs:Ti,setAttrib:Sr},Fi=(t,e)=>re(t)?e.getElementById(t):t,wr=(t,e={},n=Di)=>{let i=Object.assign({root:"app"},e),s=[],c=!0,r=Fi(i.root,n),o=()=>{if(c){i.ctx=di(e.ctx,i.autoDerefKeys);let a=n.normalizeTree(i,t);a!=null&&(i.hydrate?(n.hydrateTree(i,r,a),i.hydrate=!1):n.diffTree(i,r,s,a),s=a),c&&requestAnimationFrame(o)}};return requestAnimationFrame(o),()=>c=!1};var Gt;(function(t){t[t.FINE=0]="FINE",t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.SEVERE=4]="SEVERE",t[t.NONE=5]="NONE"})(Gt||(Gt={}));var ji=Object.freeze({level:Gt.NONE,fine(){},debug(){},info(){},warn(){},severe(){}}),Ri=t=>t instanceof Promise,Gi=(t,e)=>Pi(t,e);function Pi(t,e){let n=qe(t),i=xe(t);return(s,...c)=>i(s,e.apply(null,(c.unshift(n(s)),c)))}var fe="--set-value",Ui="--update-value",je="--toggle-value",Ut="--cancel",Hi="--dispatch",Ht="--dispatch-async",$="--dispatch-now",Bt="--delay",Bi="--fetch",X="--state",Li="--redo",Vi="--undo",Ee=ji,Mr=class{constructor(e,n){this.handlers={},this.effects={},this.eventQueue=[],this.priorities=[],this.addBuiltIns(),e&&this.addHandlers(e),n&&this.addEffects(n)}addBuiltIns(){this.addEffects({[Hi]:[e=>this.dispatch(e),-999],[Ht]:[([e,n,i,s],c,r)=>{let o=this.effects[e];if(o){let a=o(n,c,r);Ri(a)?a.then(u=>this.dispatch([i,u])).catch(u=>this.dispatch([s,u])):Ee.warn("async effect did not return Promise")}else Ee.warn(`skipping invalid async effect: ${e}`)},-999],[Bt]:[([e,n])=>new Promise(i=>setTimeout(()=>i(n),e)),1e3],[Bi]:[e=>fetch(e).then(n=>{if(!n.ok)throw new Error(n.statusText);return n}),1e3]})}addHandler(e,n){let i=this.interceptorsFromSpec(n);i.length>0?(this.handlers[e]&&(this.removeHandler(e),Ee.warn(`overriding handler for ID: ${e}`)),this.handlers[e]=i):ce(`no handlers in spec for ID: ${e}`)}addHandlers(e){for(let n in e)this.addHandler(n,e[n])}addEffect(e,n,i=1){this.effects[e]&&(this.removeEffect(e),Ee.warn(`overriding effect for ID: ${e}`)),this.effects[e]=n;let s=[e,i],c=this.priorities;for(let r=0;r<c.length;r++)if(s[1]<c[r][1]){c.splice(r,0,s);return}c.push(s)}addEffects(e){for(let n in e){let i=e[n];H(i)?this.addEffect(n,i[0],i[1]):this.addEffect(n,i)}}instrumentWith(e,n){let i=e.map(Tr),s=this.handlers;for(let c of n||Object.keys(s)){let r=s[c];r&&(s[c]=i.concat(r))}}removeHandler(e){delete this.handlers[e]}removeHandlers(e){for(let n of e)this.removeHandler(n)}removeEffect(e){delete this.effects[e];let n=this.priorities;for(let i=n.length-1;i>=0;i--)if(e===n[i][0]){n.splice(i,1);return}}removeEffects(e){for(let n of e)this.removeEffect(n)}context(){return this.currCtx}dispatch(...e){this.eventQueue.push(...e)}dispatchNow(...e){(this.currQueue||this.eventQueue).push(...e)}dispatchLater(e,n=17){setTimeout(()=>this.dispatch(e),n)}processQueue(e){if(this.eventQueue.length>0){this.currQueue=[...this.eventQueue],this.eventQueue.length=0,e=this.currCtx=e||{};for(let n of this.currQueue)this.processEvent(e,n);return this.currQueue=this.currCtx=void 0,this.processEffects(e),!0}return!1}processEvent(e,n){let i=this.handlers[n[0]];if(!i){Ee.warn(`missing handler for event type: ${n[0].toString()}`);return}!this.processForward(e,i,n)||this.processReverse(e,i,n)}processForward(e,n,i){let s=!1;for(let c=0,r=n.length;c<r&&!e[Ut];c++){let o=n[c];o.pre&&this.mergeEffects(e,o.pre(e[X],i,this,e)),s=s||!!o.post}return s}processReverse(e,n,i){for(let s=n.length;--s>=0&&!e[Ut];){let c=n[s];c.post&&this.mergeEffects(e,c.post(e[X],i,this,e))}}processEffects(e){let n=this.effects;for(let i of this.priorities){let s=i[0],c=e[s];c!==void 0&&this.processEffect(e,n,s,c)}}processEffect(e,n,i,s){let c=n[i];if(i!==X)for(let r of s)c(r,this,e);else c(s,this,e)}mergeEffects(e,n){if(!!n)for(let i in n){let s=n[i];if(s!=null)if(i===X||i===Ut)e[i]=s;else if(i===$)if(H(s[0]))for(let c of s)c&&this.dispatchNow(c);else this.dispatchNow(s);else if(e[i]||(e[i]=[]),H(s[0]))for(let c of s)c!==void 0&&e[i].push(c);else e[i].push(s)}}interceptorsFromSpec(e){return H(e)?e.map(Tr):Ne(e)?[{pre:e}]:[e]}},Lt=class extends Mr{constructor(e,n,i){super(n,i);this.state=e||new me({})}deref(){return this.state.deref()}addBuiltIns(){super.addBuiltIns(),this.addHandlers({[fe]:(e,[n,[i,s]])=>({[X]:$e(e,i,s)}),[Ui]:(e,[n,[i,s,...c]])=>({[X]:Ce(e,i,s,...c)}),[je]:(e,[n,i])=>({[X]:Ce(e,i,s=>!s)}),[Vi]:Ar("undo"),[Li]:Ar("redo")}),this.addEffects({[X]:[e=>this.state.reset(e),-1e3]})}processQueue(e){if(this.eventQueue.length>0){let n=this.state.deref();this.currQueue=[...this.eventQueue],this.eventQueue.length=0,e=this.currCtx=Object.assign(Object.assign({},e),{[X]:n});for(let i of this.currQueue)this.processEvent(e,i);return this.currQueue=this.currCtx=void 0,this.processEffects(e),this.state.deref()!==n}return!1}},Tr=t=>Ne(t)?{pre:t}:t,Ar=t=>(e,[n,i],s,c)=>{let r=i?i[0]:"history";if(se(c[r],t)){let o=c[r][t]();return{[X]:s.state.deref(),[$]:i?o!==void 0?i[1]:i[2]:void 0}}else Ee.warn("no history in context")},kr=(t,e)=>console.log("event:",e),xr=(t,e)=>{let n=ar(t);return(i,[s,c])=>({[X]:n(i,e?e(c):c)})},Cr=(t,e)=>{let n=Gi(t,e);return(i,[s,...c])=>({[X]:n(i,...c)})};var zi={},Ie=(()=>{try{return zi.env.UMBRELLA_ASSERTS==="1"}catch(t){}return!1})()?(t,e="assertion failed")=>{if(typeof t=="function"&&!t()||!t)throw new Error(typeof e=="function"?e():e)}:Oe,qi=ve(()=>"illegal arity"),ge=t=>{throw new qi(t)};var Or=(t,e)=>{if(!!t){for(let n=0,i=t.length,s;n<i;n++)if(s=t[n],s[0].call(s[1],e),e.canceled)return}},$i=Ve({addListener(t,e,n){let i=(this._listeners=this._listeners||{})[t];return!i&&(i=this._listeners[t]=[]),this.__listener(i,e,n)===-1?(i.push([e,n]),!0):!1},removeListener(t,e,n){let i;if(!(i=this._listeners))return!1;let s=i[t];if(s){let c=this.__listener(s,e,n);if(c!==-1)return s.splice(c,1),!s.length&&delete i[t],!0}return!1},notify(t){let e;if(!(e=this._listeners))return!1;t.target===void 0&&(t.target=this),Or(e[t.id],t),Or(e[lr],t)},__listener(t,e,n){let i=t.length;for(;--i>=0;){let s=t[i];if(s[0]===e&&s[1]===n)break}return i}}),Se="route-changed",Vt=class{constructor(e){if(e.authenticator=e.authenticator||((n,i,s)=>({id:n.id,title:n.title,params:s})),e.prefix=e.prefix===void 0?"/":e.prefix,e.separator=e.separator||"/",this.config=e,Ie(this.routeForID(this.config.defaultRouteID)!==void 0,`missing config for default route: '${this.config.defaultRouteID}'`),e.initialRouteID){let n=this.routeForID(e.initialRouteID);Ie(n!==void 0,`missing config for initial route: ${this.config.initialRouteID}`),Ie(!Wi(n),"initial route MUST not be parametric")}}addListener(e,n,i){}removeListener(e,n,i){}notify(e){}start(){if(this.config.initialRouteID){let e=this.routeForID(this.config.initialRouteID);this.current={id:e.id,title:e.title,params:{}},this.notify({id:Se,value:this.current})}}route(e){e.charAt(0)==="#"&&(e=e.substr(1)),e=e.substr(this.config.prefix.length);let n=this.matchRoutes(e);if(!n){if(!this.handleRouteFailure())return;let i=this.routeForID(this.config.defaultRouteID);n={id:i.id,title:i.title,params:{}}}return K(n,this.current)||(this.current=n,this.notify({id:Se,value:n})),n}format(...e){let[n,i,s]=e,c;switch(e.length){case 3:c={id:n,params:i};break;case 2:re(n)?c={id:n,params:i}:(s=i,c=n);break;case 1:c=re(n)?{id:n}:n;break;default:ge(e.length)}let r=this.routeForID(c.id);if(r){let o=c.params||{};return(s?"#":"")+this.config.prefix+r.match.map(a=>a.charAt(0)==="?"?(a=o[a.substr(1)])!=null?a:"NULL":a).join(this.config.separator)}else ce(`invalid route ID: ${c.id}`)}routeForID(e){return this.config.routes.find(n=>n.id===e)}matchRoutes(e){let n=this.config.routes,i=e.split(this.config.separator);for(let s=0,c=n.length;s<c;s++){let r=this.matchRoute(i,n[s]);if(r)return r}}matchRoute(e,n){let i=n.match,s=i.length;if(e.length===s){let c={};for(let r=0;r<s;r++){let o=i[r];if(o.charAt(0)==="?")c[o.substr(1)]=e[r];else if(e[r]!==o)return}return n.validate&&!this.validateRouteParams(c,n.validate)?void 0:n.auth?this.config.authenticator(n,e,c):{id:n.id,title:n.title,params:c}}}validateRouteParams(e,n){for(let i in n)if(e[i]!==void 0){let s=n[i];if(s.coerce&&(e[i]=s.coerce(e[i])),s.check&&!s.check(e[i]))return!1}return!0}handleRouteFailure(){return!0}};Vt=Le([$i],Vt);var Wi=t=>t.match.some(e=>e.charAt(0)==="?"),zt=class extends Vt{constructor(e){super(e);this.useFragment=e.useFragment!==!1,this.ignoreHashChange=!1}start(){if(window.addEventListener("popstate",this.handlePopChange()),this.useFragment&&window.addEventListener("hashchange",this.handleHashChange()),this.config.initialRouteID){let e=this.routeForID(this.config.initialRouteID);this.route(this.format({id:e.id,title:e.title}))}else this.route(this.useFragment?location.hash:location.pathname)}release(){window.removeEventListener("popstate",this.popHandler),this.useFragment&&window.removeEventListener("hashchange",this.hashHandler)}route(e,n=!0){let i=this.current,s=super.route(e);return s&&!K(s,i)&&(this.currentPath=this.format(s),n&&history.pushState(this.currentPath,s.title||window.document.title||"",this.currentPath)),s}routeTo(e){this.useFragment&&(location.hash=e),this.route(e)}format(...e){let n;switch(e.length){case 2:n={id:e[0],params:e[1]};break;case 1:n=re(e[0])?{id:e[0]}:e[0];break;default:ge(e.length)}return super.format(n,this.useFragment)}handlePopChange(){return this.popHandler=this.popHandler||(e=>{this.route(e.state||(this.useFragment?location.hash:location.pathname),!1)}).bind(this)}handleHashChange(){return this.hashHandler=this.hashHandler||(e=>{if(!this.ignoreHashChange){let n=e.newURL.substr(e.newURL.indexOf("#"));n!==this.currentPath&&this.route(n,!1)}}).bind(this)}handleRouteFailure(){return this.ignoreHashChange=!0,location.hash=this.format({id:this.routeForID(this.config.defaultRouteID).id}),this.ignoreHashChange=!1,!0}};var Yi=([t,e,n],i)=>["option",{value:t,disabled:!!n,selected:t===i},e],Nr=(t,e,n,i)=>["select",e,...n.map(s=>Yi(s,i))],Dr=t=>{let e=Object.assign({element:"h1",attribs:{},subElement:"small",subAttribs:{}},t);return(n,i,s)=>[e.element,e.attribs,i,s?[e.subElement,e.subAttribs,s]:void 0]},Ki={anim:100,pad:1,margin:0,vertical:!1,bgOn:{fill:"#000"},bgOff:{fill:"#999"},fgOn:{fill:"#fff"},fgOff:{fill:"#fff"}},Fr=(t={})=>{let e=Object.assign(Object.assign({w:10,h:10},Ki),t),{w:n,h:i,pad:s,margin:c,vertical:r}=e,o=c*2,a=s+c,u=r?n+s*2:(n+s)*2,f=r?(i+s)*2:i+s*2,h={width:u+o,height:f+o},d={transition:`all ${e.anim}ms ease-out`},g=Object.assign(Object.assign({},e.bgOn),{width:u,height:f,x:c,y:c}),E=Object.assign(Object.assign({},g),e.bgOff),M=Object.assign(Object.assign(Object.assign({},r?{x:a,y:a}:{x:u+c-s-n,y:a}),e.fgOn),{style:d,width:n,height:i}),I=Object.assign(Object.assign(Object.assign({},M),r?{y:f+c-s-i}:{x:a}),e.fgOff);return(v,_,T)=>["svg",Object.assign(Object.assign({},h),_),["rect",T?g:E],["rect",T?M:I]]};var Ji=t=>t!=null&&typeof t!="function"&&t.length!==void 0,it=t=>t!=null&&typeof t[Symbol.iterator]=="function",Xi=t=>((t==null||!t[Symbol.iterator])&&ce(`value is not iterable: ${t}`),t),Qi=t=>H(t)?t:[...Xi(t)],jr=1/4294967295,Rr=class{float(e=1){return this.int()*jr*e}norm(e=1){return(this.int()*jr-.5)*2*e}minmax(e,n){return this.float()*(n-e)+e}},qt=Math.random,Pr=class extends Rr{int(){return qt()*4294967296>>>0}float(e=1){return qt()*e}norm(e=1){return(qt()-.5)*2*e}},Gr=new Pr,Zi=(t,e,n=Gr)=>{let i=t.length;Ie(i>0,"no choices given");let s=e?t.map((r,o)=>[e[o]||0,r]).sort((r,o)=>o[0]-r[0]):t.map(r=>[1,r]),c=s.reduce((r,o)=>r+o[0],0);return c<=0&&console.warn("total weights <= 0"),()=>{let r=n.float(c),o=c;for(let a=0;a<i;a++)if(o-=s[a][0],o<=r)return s[a][1]}},Re=t=>se(t,"xform")?t.xform():t,we=class{constructor(e){this.value=e}deref(){return this.value}},eo=t=>new we(t),ye=t=>t instanceof we,to=t=>t instanceof we?t:new we(t),ot=t=>t instanceof we?t.deref():t,ro=t=>t.length===2?[void 0,t[1]]:t.length===3?[t[1],t[2]]:ge(t.length);function oo(...t){let e=t[0],n=e[0],i=e[1],s=e[2];t=ro(t);let c=t[0]==null?n():t[0],r=t[1];return ot(i(se(r,"$reduce")?r.$reduce(s,c):Ji(r)?no(s,c,r):io(s,c,r)))}var no=(t,e,n)=>{for(let i=0,s=n.length;i<s;i++)if(e=t(e,n[i]),ye(e)){e=e.deref();break}return e},io=(t,e,n)=>{for(let i of n)if(e=t(e,i),ye(e)){e=e.deref();break}return e},so=(t,e)=>[t,n=>n,e];function L(t){return t?[...t]:so(()=>[],(e,n)=>(e.push(n),e))}function*ao(t,e){let n=Re(t)(L()),i=n[1],s=n[2];for(let c of e){let r=s([],c);if(ye(r)){yield*ot(i(r.deref()));return}r.length&&(yield*r)}yield*ot(i([]))}function*$t(t,e){let n=Re(t)([Oe,Oe,(i,s)=>s])[2];for(let i of e){let s=n(pe,i);if(ye(s)){s=ot(s.deref()),s!==pe&&(yield s);return}s!==pe&&(yield s)}}var Ur=(t,e,n=$t)=>{let i=e.length-1;return it(e[i])?e.length>1?n(t.apply(null,e.slice(0,i)),e[i]):n(t(),e[0]):void 0},Wt=(t,e)=>[t[0],t[1],e];function D(t,e){return it(e)?$t(D(t),e):n=>{let i=n[2];return Wt(n,(s,c)=>i(s,t(c)))}}function V(...t){return co(V,oo,t)}var co=(t,e,n)=>{let i,s;switch(n.length){case 4:s=n[3],i=n[2];break;case 3:s=n[2];break;case 2:return D(c=>t(n[0],n[1],c));default:ge(n.length)}return e(Re(n[0])(n[1]),i,s)},uo=t=>{let{1:e,2:n}=Re(t)(L()),i=!1;return s=>{if(!i){let c=n([],s);return i=ye(c),i&&(c=e(c.deref())),c.length===1?c[0]:c.length>0?c:void 0}}};function Hr(...t){let[e,n,i,s,c,r,o,a,u,f]=t;switch(t.length){case 0:ge(0);case 1:return e;case 2:return(...d)=>e(n(...d));case 3:return(...d)=>e(n(i(...d)));case 4:return(...d)=>e(n(i(s(...d))));case 5:return(...d)=>e(n(i(s(c(...d)))));case 6:return(...d)=>e(n(i(s(c(r(...d))))));case 7:return(...d)=>e(n(i(s(c(r(o(...d)))))));case 8:return(...d)=>e(n(i(s(c(r(o(a(...d))))))));case 9:return(...d)=>e(n(i(s(c(r(o(a(u(...d)))))))));case 10:default:let h=(...d)=>e(n(i(s(c(r(o(a(u(f(...d))))))))));return t.length===10?h:Hr(h,...t.slice(10))}}function fo(...t){let[e,n,i,s,c,r,o,a]=t;switch(t.length){case 1:return u=>[e(u)];case 2:return u=>[e(u),n(u)];case 3:return u=>[e(u),n(u),i(u)];case 4:return u=>[e(u),n(u),i(u),s(u)];case 5:return u=>[e(u),n(u),i(u),s(u),c(u)];case 6:return u=>[e(u),n(u),i(u),s(u),c(u),r(u)];case 7:return u=>[e(u),n(u),i(u),s(u),c(u),r(u),o(u)];case 8:return u=>[e(u),n(u),i(u),s(u),c(u),r(u),o(u),a(u)];default:return u=>{let f=new Array(t.length);for(let h=t.length;--h>=0;)f[h]=t[h](u);return f}}}function Yt(t,e,n){return new Br(t,e,n)}var Br=class{constructor(e,n,i){e===void 0?(e=0,n=Infinity):n===void 0&&(n=e,e=0),i=i===void 0?e<n?1:-1:i,this.from=e,this.to=n,this.step=i}*[Symbol.iterator](){let{from:e,to:n,step:i}=this;if(i>0)for(;e<n;)yield e,e+=i;else if(i<0)for(;e>n;)yield e,e+=i}$reduce(e,n){let i=this.step;if(i>0)for(let s=this.from,c=this.to;s<c&&!ye(n);s+=i)n=e(n,s);else for(let s=this.from,c=this.to;s>c&&!ye(n);s+=i)n=e(n,s);return n}};function*Lr(...t){let e=t.map(n=>n[Symbol.iterator]());for(;;){let n=[];for(let i of e){let s=i.next();if(s.done)return;n.push(s.value)}yield n}}function st(t,e){return it(e)?$t(st(t),e):n=>{let i=n[2];return Wt(n,(s,c)=>t(c)?i(s,c):s)}}function Pe(...t){return t=t.map(Re),Hr.apply(null,t)}function Me(t,e){return it(e)?ao(Me(t),e):n=>{let i=n[2],s=t;return Wt(n,(c,r)=>--s>0?i(c,r):s===0?to(i(c,r)):eo(c))}}function lo(...t){return D(fo.apply(null,t.map(uo)))}var ho=t=>{let e=Object.keys(t),[n,i,s]=e,[c,r,o]=e.map(a=>t[a]);switch(e.length){case 3:return a=>{let u={},f;return f=a[o],f!==void 0&&(u[s]=f),f=a[r],f!==void 0&&(u[i]=f),f=a[c],f!==void 0&&(u[n]=f),u};case 2:return a=>{let u={},f;return f=a[r],f!==void 0&&(u[i]=f),f=a[c],f!==void 0&&(u[n]=f),u};case 1:return a=>{let u={},f=a[c];return f!==void 0&&(u[n]=f),u};default:return a=>{let u,f,h={};for(let d=e.length-1;d>=0;d--)u=e[d],f=a[t[u]],f!==void 0&&(h[u]=f);return h}}};function Vr(...t){let e=t.length>2&&Ur(Vr,t);if(e)return e;let n=t[0];if(H(n)&&(n=n.reduce((i,s,c)=>(i[s]=c,i),{})),t[1]){let i=Object.keys(n);return D(s=>V(Pe(D(c=>[c,s[n[c]]]),st(c=>c[1]!==void 0)),t[1],i))}else return D(ho(n))}function at(...t){let e=Ur(at,t);if(e)return e;let[n,i]=t,s=Object.keys(n);return Pe(lo.apply(null,s.map(c=>n[c])),Vr(s,i))}function*mo(t,e=Infinity){for(let n=0;n<e;n++)yield t(n)}var ct=(t,e,n=Gr)=>mo(e?Zi(Qi(t),e,n):()=>t[n.float(t.length)|0]);function*zr(t,e=Infinity){for(;e-- >0;)yield t}var J=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function z(t,e,n){return n={path:e,exports:{},require:function(i,s){return po(i,s??n.path)}},t(n,n.exports),n.exports}function po(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var go=z(function(t){(function(e){function n(){if(n.prototype._singleton)throw new Error("WebMidi is a singleton, it cannot be instantiated directly.");(n.prototype._singleton=this)._inputs=[],this._outputs=[],this._userHandlers={},this._stateChangeQueue=[],this._processingStateChange=!1,this._midiInterfaceEvents=["connected","disconnected"],this._nrpnBuffer=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],this._nrpnEventsEnabled=!0,this._nrpnTypes=["entry","increment","decrement"],this._notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this._semitones={C:0,D:2,E:4,F:5,G:7,A:9,B:11},Object.defineProperties(this,{MIDI_SYSTEM_MESSAGES:{value:{sysex:240,timecode:241,songposition:242,songselect:243,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MESSAGES:{value:{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,channelmode:11,nrpn:11,programchange:12,channelaftertouch:13,pitchbend:14},writable:!1,enumerable:!0,configurable:!1},MIDI_REGISTERED_PARAMETER:{value:{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]},writable:!1,enumerable:!0,configurable:!1},MIDI_CONTROL_CHANGE_MESSAGES:{value:{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101},writable:!1,enumerable:!0,configurable:!1},MIDI_NRPN_MESSAGES:{value:{entrymsb:6,entrylsb:38,increment:96,decrement:97,paramlsb:98,parammsb:99,nullactiveparameter:127},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MODE_MESSAGES:{value:{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127},writable:!1,enumerable:!0,configurable:!1},octaveOffset:{value:0,writable:!0,enumerable:!0,configurable:!1}}),Object.defineProperties(this,{supported:{enumerable:!0,get:function(){return"requestMIDIAccess"in navigator}},enabled:{enumerable:!0,get:function(){return this.interface!==void 0}.bind(this)},inputs:{enumerable:!0,get:function(){return this._inputs}.bind(this)},outputs:{enumerable:!0,get:function(){return this._outputs}.bind(this)},sysexEnabled:{enumerable:!0,get:function(){return!(!this.interface||!this.interface.sysexEnabled)}.bind(this)},nrpnEventsEnabled:{enumerable:!0,get:function(){return!!this._nrpnEventsEnabled}.bind(this),set:function(r){return this._nrpnEventsEnabled=r,this._nrpnEventsEnabled}},nrpnTypes:{enumerable:!0,get:function(){return this._nrpnTypes}.bind(this)},time:{enumerable:!0,get:function(){return performance.now()}}})}var i=new n;function s(r){var o=this;this._userHandlers={channel:{},system:{}},this._midiInput=r,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return o._midiInput.connection}},id:{enumerable:!0,get:function(){return o._midiInput.id}},manufacturer:{enumerable:!0,get:function(){return o._midiInput.manufacturer}},name:{enumerable:!0,get:function(){return o._midiInput.name}},state:{enumerable:!0,get:function(){return o._midiInput.state}},type:{enumerable:!0,get:function(){return o._midiInput.type}}}),this._initializeUserHandlers(),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}function c(r){var o=this;this._midiOutput=r,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return o._midiOutput.connection}},id:{enumerable:!0,get:function(){return o._midiOutput.id}},manufacturer:{enumerable:!0,get:function(){return o._midiOutput.manufacturer}},name:{enumerable:!0,get:function(){return o._midiOutput.name}},state:{enumerable:!0,get:function(){return o._midiOutput.state}},type:{enumerable:!0,get:function(){return o._midiOutput.type}}})}n.prototype.enable=function(r,o){this.enabled||(this.supported?navigator.requestMIDIAccess({sysex:o}).then(function(a){var u,f=[],h=[];this.interface=a,this._resetInterfaceUserHandlers(),this.interface.onstatechange=function(v){f.push(v)};for(var d=a.inputs.values(),g=d.next();g&&!g.done;g=d.next())h.push(g.value.open());for(var E=a.outputs.values(),M=E.next();M&&!M.done;M=E.next())h.push(M.value.open());function I(){clearTimeout(u),this._updateInputsAndOutputs(),this.interface.onstatechange=this._onInterfaceStateChange.bind(this),typeof r=="function"&&r.call(this),f.forEach(function(v){this._onInterfaceStateChange(v)}.bind(this))}u=setTimeout(I.bind(this),200),Promise&&Promise.all(h).catch(function(v){}).then(I.bind(this))}.bind(this),function(a){typeof r=="function"&&r.call(this,a)}.bind(this)):typeof r=="function"&&r(new Error("The Web MIDI API is not supported by your browser.")))},n.prototype.disable=function(){if(!this.supported)throw new Error("The Web MIDI API is not supported by your browser.");this.enabled&&(this.removeListener(),this.inputs.forEach(function(r){r.removeListener()})),this.interface&&(this.interface.onstatechange=void 0),this.interface=void 0,this._inputs=[],this._outputs=[],this._nrpnEventsEnabled=!0,this._resetInterfaceUserHandlers()},n.prototype.addListener=function(r,o){if(!this.enabled)throw new Error("WebMidi must be enabled before adding event listeners.");if(typeof o!="function")throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(r)))throw new TypeError("The specified event type is not supported.");return this._userHandlers[r].push(o),this},n.prototype.hasListener=function(r,o){if(!this.enabled)throw new Error("WebMidi must be enabled before checking event listeners.");if(typeof o!="function")throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(r)))throw new TypeError("The specified event type is not supported.");for(var a=0;a<this._userHandlers[r].length;a++)if(this._userHandlers[r][a]===o)return!0;return!1},n.prototype.removeListener=function(r,o){if(!this.enabled)throw new Error("WebMidi must be enabled before removing event listeners.");if(o!==void 0&&typeof o!="function")throw new TypeError("The 'listener' parameter must be a function.");if(0<=this._midiInterfaceEvents.indexOf(r))if(o)for(var a=0;a<this._userHandlers[r].length;a++)this._userHandlers[r][a]===o&&this._userHandlers[r].splice(a,1);else this._userHandlers[r]=[];else{if(r!==void 0)throw new TypeError("The specified event type is not supported.");this._resetInterfaceUserHandlers()}return this},n.prototype.toMIDIChannels=function(r){var o;if(r==="all"||r===void 0)o=["all"];else{if(r==="none")return o=[];o=Array.isArray(r)?r:[r]}return-1<o.indexOf("all")&&(o=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),o.map(function(a){return parseInt(a)}).filter(function(a){return 1<=a&&a<=16})},n.prototype.getInputById=function(r){if(!this.enabled)throw new Error("WebMidi is not enabled.");r=String(r);for(var o=0;o<this.inputs.length;o++)if(this.inputs[o].id===r)return this.inputs[o];return!1},n.prototype.getOutputById=function(r){if(!this.enabled)throw new Error("WebMidi is not enabled.");r=String(r);for(var o=0;o<this.outputs.length;o++)if(this.outputs[o].id===r)return this.outputs[o];return!1},n.prototype.getInputByName=function(r){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var o=0;o<this.inputs.length;o++)if(~this.inputs[o].name.indexOf(r))return this.inputs[o];return!1},n.prototype.getOctave=function(r){if(r!=null&&0<=r&&r<=127)return Math.floor(Math.floor(r)/12-1)+Math.floor(i.octaveOffset)},n.prototype.getOutputByName=function(r){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var o=0;o<this.outputs.length;o++)if(~this.outputs[o].name.indexOf(r))return this.outputs[o];return!1},n.prototype.guessNoteNumber=function(r){var o=!1;if(r&&r.toFixed&&0<=r&&r<=127?o=Math.round(r):0<=parseInt(r)&&parseInt(r)<=127?o=parseInt(r):(typeof r=="string"||r instanceof String)&&(o=this.noteNameToNumber(r)),o===!1)throw new Error("Invalid input value ("+r+").");return o},n.prototype.noteNameToNumber=function(r){typeof r!="string"&&(r="");var o=r.match(/([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)/i);if(!o)throw new RangeError("Invalid note name.");var a=i._semitones[o[1].toUpperCase()],u=12*(parseInt(o[3])+1-Math.floor(i.octaveOffset))+a;if(-1<o[2].toLowerCase().indexOf("b")?u-=o[2].length:-1<o[2].toLowerCase().indexOf("#")&&(u+=o[2].length),u<0||127<u)throw new RangeError("Invalid note name or note outside valid range.");return u},n.prototype._updateInputsAndOutputs=function(){this._updateInputs(),this._updateOutputs()},n.prototype._updateInputs=function(){for(var r=0;r<this._inputs.length;r++){for(var o=!0,a=this.interface.inputs.values(),u=a.next();u&&!u.done;u=a.next())if(this._inputs[r]._midiInput===u.value){o=!1;break}o&&this._inputs.splice(r,1)}this.interface&&this.interface.inputs.forEach(function(f){for(var h=!0,d=0;d<this._inputs.length;d++)this._inputs[d]._midiInput===f&&(h=!1);h&&this._inputs.push(new s(f))}.bind(this))},n.prototype._updateOutputs=function(){for(var r=0;r<this._outputs.length;r++){for(var o=!0,a=this.interface.outputs.values(),u=a.next();u&&!u.done;u=a.next())if(this._outputs[r]._midiOutput===u.value){o=!1;break}o&&this._outputs.splice(r,1)}this.interface&&this.interface.outputs.forEach(function(f){for(var h=!0,d=0;d<this._outputs.length;d++)this._outputs[d]._midiOutput===f&&(h=!1);h&&this._outputs.push(new c(f))}.bind(this))},n.prototype._onInterfaceStateChange=function(r){this._updateInputsAndOutputs();var o={timestamp:r.timeStamp,type:r.port.state};this.interface&&r.port.state==="connected"?r.port.type==="output"?o.port=this.getOutputById(r.port.id):r.port.type==="input"&&(o.port=this.getInputById(r.port.id)):o.port={connection:"closed",id:r.port.id,manufacturer:r.port.manufacturer,name:r.port.name,state:r.port.state,type:r.port.type},this._userHandlers[r.port.state].forEach(function(a){a(o)})},n.prototype._resetInterfaceUserHandlers=function(){for(var r=0;r<this._midiInterfaceEvents.length;r++)this._userHandlers[this._midiInterfaceEvents[r]]=[]},s.prototype.on=s.prototype.addListener=function(r,o,a){var u=this;if(o===void 0&&(o="all"),Array.isArray(o)||(o=[o]),o.forEach(function(h){if(h!=="all"&&!(1<=h&&h<=16))throw new RangeError("The 'channel' parameter is invalid.")}),typeof a!="function")throw new TypeError("The 'listener' parameter must be a function.");if(i.MIDI_SYSTEM_MESSAGES[r]!==void 0)this._userHandlers.system[r]||(this._userHandlers.system[r]=[]),this._userHandlers.system[r].push(a);else{if(i.MIDI_CHANNEL_MESSAGES[r]===void 0)throw new TypeError("The specified event type is not supported.");if(-1<o.indexOf("all")){o=[];for(var f=1;f<=16;f++)o.push(f)}this._userHandlers.channel[r]||(this._userHandlers.channel[r]=[]),o.forEach(function(h){u._userHandlers.channel[r][h]||(u._userHandlers.channel[r][h]=[]),u._userHandlers.channel[r][h].push(a)})}return this},s.prototype.hasListener=function(r,o,a){var u=this;if(typeof a!="function")throw new TypeError("The 'listener' parameter must be a function.");if(o===void 0&&(o="all"),o.constructor!==Array&&(o=[o]),i.MIDI_SYSTEM_MESSAGES[r]!==void 0){for(var f=0;f<this._userHandlers.system[r].length;f++)if(this._userHandlers.system[r][f]===a)return!0}else if(i.MIDI_CHANNEL_MESSAGES[r]!==void 0){if(-1<o.indexOf("all")){o=[];for(var h=1;h<=16;h++)o.push(h)}return!!this._userHandlers.channel[r]&&o.every(function(d){var g=u._userHandlers.channel[r][d];return g&&-1<g.indexOf(a)})}return!1},s.prototype.removeListener=function(r,o,a){var u=this;if(a!==void 0&&typeof a!="function")throw new TypeError("The 'listener' parameter must be a function.");if(o===void 0&&(o="all"),o.constructor!==Array&&(o=[o]),i.MIDI_SYSTEM_MESSAGES[r]!==void 0)if(a===void 0)this._userHandlers.system[r]=[];else for(var f=0;f<this._userHandlers.system[r].length;f++)this._userHandlers.system[r][f]===a&&this._userHandlers.system[r].splice(f,1);else if(i.MIDI_CHANNEL_MESSAGES[r]!==void 0){if(-1<o.indexOf("all")){o=[];for(var h=1;h<=16;h++)o.push(h)}if(!this._userHandlers.channel[r])return this;o.forEach(function(d){var g=u._userHandlers.channel[r][d];if(g)if(a===void 0)u._userHandlers.channel[r][d]=[];else for(var E=0;E<g.length;E++)g[E]===a&&g.splice(E,1)})}else{if(r!==void 0)throw new TypeError("The specified event type is not supported.");this._initializeUserHandlers()}return this},s.prototype._initializeUserHandlers=function(){for(var r in i.MIDI_CHANNEL_MESSAGES)Object.prototype.hasOwnProperty.call(i.MIDI_CHANNEL_MESSAGES,r)&&(this._userHandlers.channel[r]={});for(var o in i.MIDI_SYSTEM_MESSAGES)Object.prototype.hasOwnProperty.call(i.MIDI_SYSTEM_MESSAGES,o)&&(this._userHandlers.system[o]=[])},s.prototype._onMidiMessage=function(r){if(0<this._userHandlers.system.midimessage.length){var o={target:this,data:r.data,timestamp:r.timeStamp,type:"midimessage"};this._userHandlers.system.midimessage.forEach(function(a){a(o)})}r.data[0]<240?(this._parseChannelEvent(r),this._parseNrpnEvent(r)):r.data[0]<=255&&this._parseSystemEvent(r)},s.prototype._parseNrpnEvent=function(r){var o,a,u=r.data[0]>>4,f=15&r.data[0],h=1+f;if(1<r.data.length&&(o=r.data[1],a=2<r.data.length?r.data[2]:void 0),i.nrpnEventsEnabled&&u===i.MIDI_CHANNEL_MESSAGES.controlchange&&(o>=i.MIDI_NRPN_MESSAGES.increment&&o<=i.MIDI_NRPN_MESSAGES.parammsb||o===i.MIDI_NRPN_MESSAGES.entrymsb||o===i.MIDI_NRPN_MESSAGES.entrylsb)){var d={target:this,type:"controlchange",data:r.data,timestamp:r.timeStamp,channel:h,controller:{number:o,name:this.getCcNameByNumber(o)},value:a};if(d.controller.number===i.MIDI_NRPN_MESSAGES.parammsb&&d.value!=i.MIDI_NRPN_MESSAGES.nullactiveparameter)i._nrpnBuffer[f]=[],i._nrpnBuffer[f][0]=d;else if(i._nrpnBuffer[f].length===1&&d.controller.number===i.MIDI_NRPN_MESSAGES.paramlsb)i._nrpnBuffer[f].push(d);else if(i._nrpnBuffer[f].length!==2||d.controller.number!==i.MIDI_NRPN_MESSAGES.increment&&d.controller.number!==i.MIDI_NRPN_MESSAGES.decrement&&d.controller.number!==i.MIDI_NRPN_MESSAGES.entrymsb)if(i._nrpnBuffer[f].length===3&&i._nrpnBuffer[f][2].number===i.MIDI_NRPN_MESSAGES.entrymsb&&d.controller.number===i.MIDI_NRPN_MESSAGES.entrylsb)i._nrpnBuffer[f].push(d);else if(3<=i._nrpnBuffer[f].length&&i._nrpnBuffer[f].length<=4&&d.controller.number===i.MIDI_NRPN_MESSAGES.parammsb&&d.value===i.MIDI_NRPN_MESSAGES.nullactiveparameter)i._nrpnBuffer[f].push(d);else if(4<=i._nrpnBuffer[f].length&&i._nrpnBuffer[f].length<=5&&d.controller.number===i.MIDI_NRPN_MESSAGES.paramlsb&&d.value===i.MIDI_NRPN_MESSAGES.nullactiveparameter){i._nrpnBuffer[f].push(d);var g=[];i._nrpnBuffer[f].forEach(function(_){g.push(_.data)});var E=i._nrpnBuffer[f][0].value<<7|i._nrpnBuffer[f][1].value,M=i._nrpnBuffer[f][2].value;i._nrpnBuffer[f].length===6&&(M=i._nrpnBuffer[f][2].value<<7|i._nrpnBuffer[f][3].value);var I="";switch(i._nrpnBuffer[f][2].controller.number){case i.MIDI_NRPN_MESSAGES.entrymsb:I=i._nrpnTypes[0];break;case i.MIDI_NRPN_MESSAGES.increment:I=i._nrpnTypes[1];break;case i.MIDI_NRPN_MESSAGES.decrement:I=i._nrpnTypes[2];break;default:throw new Error("The NPRN type was unidentifiable.")}var v={timestamp:d.timestamp,channel:d.channel,type:"nrpn",data:g,controller:{number:E,type:I,name:"Non-Registered Parameter "+E},value:M};i._nrpnBuffer[f]=[],this._userHandlers.channel[v.type]&&this._userHandlers.channel[v.type][v.channel]&&this._userHandlers.channel[v.type][v.channel].forEach(function(_){_(v)})}else i._nrpnBuffer[f]=[];else i._nrpnBuffer[f].push(d)}},s.prototype._parseChannelEvent=function(r){var o,a,u=r.data[0]>>4,f=1+(15&r.data[0]);1<r.data.length&&(o=r.data[1],a=2<r.data.length?r.data[2]:void 0);var h={target:this,data:r.data,timestamp:r.timeStamp,channel:f};u===i.MIDI_CHANNEL_MESSAGES.noteoff||u===i.MIDI_CHANNEL_MESSAGES.noteon&&a===0?(h.type="noteoff",h.note={number:o,name:i._notes[o%12],octave:i.getOctave(o)},h.velocity=a/127,h.rawVelocity=a):u===i.MIDI_CHANNEL_MESSAGES.noteon?(h.type="noteon",h.note={number:o,name:i._notes[o%12],octave:i.getOctave(o)},h.velocity=a/127,h.rawVelocity=a):u===i.MIDI_CHANNEL_MESSAGES.keyaftertouch?(h.type="keyaftertouch",h.note={number:o,name:i._notes[o%12],octave:i.getOctave(o)},h.value=a/127):u===i.MIDI_CHANNEL_MESSAGES.controlchange&&0<=o&&o<=119?(h.type="controlchange",h.controller={number:o,name:this.getCcNameByNumber(o)},h.value=a):u===i.MIDI_CHANNEL_MESSAGES.channelmode&&120<=o&&o<=127?(h.type="channelmode",h.controller={number:o,name:this.getChannelModeByNumber(o)},h.value=a):u===i.MIDI_CHANNEL_MESSAGES.programchange?(h.type="programchange",h.value=o):u===i.MIDI_CHANNEL_MESSAGES.channelaftertouch?(h.type="channelaftertouch",h.value=o/127):u===i.MIDI_CHANNEL_MESSAGES.pitchbend?(h.type="pitchbend",h.value=((a<<7)+o-8192)/8192):h.type="unknownchannelmessage",this._userHandlers.channel[h.type]&&this._userHandlers.channel[h.type][f]&&this._userHandlers.channel[h.type][f].forEach(function(d){d(h)})},s.prototype.getCcNameByNumber=function(r){if(!(0<=(r=Math.floor(r))&&r<=119))throw new RangeError("The control change number must be between 0 and 119.");for(var o in i.MIDI_CONTROL_CHANGE_MESSAGES)if(Object.prototype.hasOwnProperty.call(i.MIDI_CONTROL_CHANGE_MESSAGES,o)&&r===i.MIDI_CONTROL_CHANGE_MESSAGES[o])return o},s.prototype.getChannelModeByNumber=function(r){if(!(120<=(r=Math.floor(r))&&status<=127))throw new RangeError("The control change number must be between 120 and 127.");for(var o in i.MIDI_CHANNEL_MODE_MESSAGES)if(Object.prototype.hasOwnProperty.call(i.MIDI_CHANNEL_MODE_MESSAGES,o)&&r===i.MIDI_CHANNEL_MODE_MESSAGES[o])return o},s.prototype._parseSystemEvent=function(r){var o=r.data[0],a={target:this,data:r.data,timestamp:r.timeStamp};o===i.MIDI_SYSTEM_MESSAGES.sysex?a.type="sysex":o===i.MIDI_SYSTEM_MESSAGES.timecode?a.type="timecode":o===i.MIDI_SYSTEM_MESSAGES.songposition?a.type="songposition":o===i.MIDI_SYSTEM_MESSAGES.songselect?(a.type="songselect",a.song=r.data[1]):o===i.MIDI_SYSTEM_MESSAGES.tuningrequest?a.type="tuningrequest":o===i.MIDI_SYSTEM_MESSAGES.clock?a.type="clock":o===i.MIDI_SYSTEM_MESSAGES.start?a.type="start":o===i.MIDI_SYSTEM_MESSAGES.continue?a.type="continue":o===i.MIDI_SYSTEM_MESSAGES.stop?a.type="stop":o===i.MIDI_SYSTEM_MESSAGES.activesensing?a.type="activesensing":o===i.MIDI_SYSTEM_MESSAGES.reset?a.type="reset":a.type="unknownsystemmessage",this._userHandlers.system[a.type]&&this._userHandlers.system[a.type].forEach(function(u){u(a)})},c.prototype.send=function(r,o,a){if(!(128<=r&&r<=255))throw new RangeError("The status byte must be an integer between 128 (0x80) and 255 (0xFF).");o===void 0&&(o=[]),Array.isArray(o)||(o=[o]);var u=[];return o.forEach(function(f){var h=Math.floor(f);if(!(0<=h&&h<=255))throw new RangeError("Data bytes must be integers between 0 (0x00) and 255 (0xFF).");u.push(h)}),this._midiOutput.send([r].concat(u),parseFloat(a)||0),this},c.prototype.sendSysex=function(r,o,a){if(!i.sysexEnabled)throw new Error("Sysex message support must first be activated.");return a=a||{},r=[].concat(r),o.forEach(function(u){if(u<0||127<u)throw new RangeError("The data bytes of a sysex message must be integers between 0 (0x00) and 127 (0x7F).")}),o=r.concat(o,i.MIDI_SYSTEM_MESSAGES.sysexend),this.send(i.MIDI_SYSTEM_MESSAGES.sysex,o,this._parseTimeParameter(a.time)),this},c.prototype.sendTimecodeQuarterFrame=function(r,o){return o=o||{},this.send(i.MIDI_SYSTEM_MESSAGES.timecode,r,this._parseTimeParameter(o.time)),this},c.prototype.sendSongPosition=function(r,o){o=o||{};var a=(r=Math.floor(r)||0)>>7&127,u=127&r;return this.send(i.MIDI_SYSTEM_MESSAGES.songposition,[a,u],this._parseTimeParameter(o.time)),this},c.prototype.sendSongSelect=function(r,o){if(o=o||{},!(0<=(r=Math.floor(r))&&r<=127))throw new RangeError("The song number must be between 0 and 127.");return this.send(i.MIDI_SYSTEM_MESSAGES.songselect,[r],this._parseTimeParameter(o.time)),this},c.prototype.sendTuningRequest=function(r){return r=r||{},this.send(i.MIDI_SYSTEM_MESSAGES.tuningrequest,void 0,this._parseTimeParameter(r.time)),this},c.prototype.sendClock=function(r){return r=r||{},this.send(i.MIDI_SYSTEM_MESSAGES.clock,void 0,this._parseTimeParameter(r.time)),this},c.prototype.sendStart=function(r){return r=r||{},this.send(i.MIDI_SYSTEM_MESSAGES.start,void 0,this._parseTimeParameter(r.time)),this},c.prototype.sendContinue=function(r){return r=r||{},this.send(i.MIDI_SYSTEM_MESSAGES.continue,void 0,this._parseTimeParameter(r.time)),this},c.prototype.sendStop=function(r){return r=r||{},this.send(i.MIDI_SYSTEM_MESSAGES.stop,void 0,this._parseTimeParameter(r.time)),this},c.prototype.sendActiveSensing=function(r){return r=r||{},this.send(i.MIDI_SYSTEM_MESSAGES.activesensing,[],this._parseTimeParameter(r.time)),this},c.prototype.sendReset=function(r){return r=r||{},this.send(i.MIDI_SYSTEM_MESSAGES.reset,void 0,this._parseTimeParameter(r.time)),this},c.prototype.stopNote=function(r,o,a){if(r==="all")return this.sendChannelMode("allnotesoff",0,o,a);var u=64;return(a=a||{}).rawVelocity?!isNaN(a.velocity)&&0<=a.velocity&&a.velocity<=127&&(u=a.velocity):!isNaN(a.velocity)&&0<=a.velocity&&a.velocity<=1&&(u=127*a.velocity),this._convertNoteToArray(r).forEach(function(f){i.toMIDIChannels(o).forEach(function(h){this.send((i.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(h-1),[f,Math.round(u)],this._parseTimeParameter(a.time))}.bind(this))}.bind(this)),this},c.prototype.playNote=function(r,o,a){var u,f=64;if((a=a||{}).rawVelocity?!isNaN(a.velocity)&&0<=a.velocity&&a.velocity<=127&&(f=a.velocity):!isNaN(a.velocity)&&0<=a.velocity&&a.velocity<=1&&(f=127*a.velocity),u=this._parseTimeParameter(a.time),this._convertNoteToArray(r).forEach(function(d){i.toMIDIChannels(o).forEach(function(g){this.send((i.MIDI_CHANNEL_MESSAGES.noteon<<4)+(g-1),[d,Math.round(f)],u)}.bind(this))}.bind(this)),!isNaN(a.duration)){a.duration<=0&&(a.duration=0);var h=64;a.rawVelocity?!isNaN(a.release)&&0<=a.release&&a.release<=127&&(h=a.release):!isNaN(a.release)&&0<=a.release&&a.release<=1&&(h=127*a.release),this._convertNoteToArray(r).forEach(function(d){i.toMIDIChannels(o).forEach(function(g){this.send((i.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(g-1),[d,Math.round(h)],(u||i.time)+a.duration)}.bind(this))}.bind(this))}return this},c.prototype.sendKeyAftertouch=function(r,o,a,u){var f=this;if(u=u||{},o<1||16<o)throw new RangeError("The channel must be between 1 and 16.");(isNaN(a)||a<0||1<a)&&(a=.5);var h=Math.round(127*a);return this._convertNoteToArray(r).forEach(function(d){i.toMIDIChannels(o).forEach(function(g){f.send((i.MIDI_CHANNEL_MESSAGES.keyaftertouch<<4)+(g-1),[d,h],f._parseTimeParameter(u.time))})}),this},c.prototype.sendControlChange=function(r,o,a,u){if(u=u||{},typeof r=="string"){if((r=i.MIDI_CONTROL_CHANGE_MESSAGES[r])===void 0)throw new TypeError("Invalid controller name.")}else if(!(0<=(r=Math.floor(r))&&r<=119))throw new RangeError("Controller numbers must be between 0 and 119.");if(!(0<=(o=Math.floor(o)||0)&&o<=127))throw new RangeError("Controller value must be between 0 and 127.");return i.toMIDIChannels(a).forEach(function(f){this.send((i.MIDI_CHANNEL_MESSAGES.controlchange<<4)+(f-1),[r,o],this._parseTimeParameter(u.time))}.bind(this)),this},c.prototype._selectRegisteredParameter=function(r,o,a){var u=this;if(r[0]=Math.floor(r[0]),!(0<=r[0]&&r[0]<=127))throw new RangeError("The control65 value must be between 0 and 127");if(r[1]=Math.floor(r[1]),!(0<=r[1]&&r[1]<=127))throw new RangeError("The control64 value must be between 0 and 127");return i.toMIDIChannels(o).forEach(function(){u.sendControlChange(101,r[0],o,{time:a}),u.sendControlChange(100,r[1],o,{time:a})}),this},c.prototype._selectNonRegisteredParameter=function(r,o,a){var u=this;if(r[0]=Math.floor(r[0]),!(0<=r[0]&&r[0]<=127))throw new RangeError("The control63 value must be between 0 and 127");if(r[1]=Math.floor(r[1]),!(0<=r[1]&&r[1]<=127))throw new RangeError("The control62 value must be between 0 and 127");return i.toMIDIChannels(o).forEach(function(){u.sendControlChange(99,r[0],o,{time:a}),u.sendControlChange(98,r[1],o,{time:a})}),this},c.prototype._setCurrentRegisteredParameter=function(r,o,a){var u=this;if((r=[].concat(r))[0]=Math.floor(r[0]),!(0<=r[0]&&r[0]<=127))throw new RangeError("The msb value must be between 0 and 127");return i.toMIDIChannels(o).forEach(function(){u.sendControlChange(6,r[0],o,{time:a})}),r[1]=Math.floor(r[1]),0<=r[1]&&r[1]<=127&&i.toMIDIChannels(o).forEach(function(){u.sendControlChange(38,r[1],o,{time:a})}),this},c.prototype._deselectRegisteredParameter=function(r,o){var a=this;return i.toMIDIChannels(r).forEach(function(){a.sendControlChange(101,127,r,{time:o}),a.sendControlChange(100,127,r,{time:o})}),this},c.prototype.setRegisteredParameter=function(r,o,a,u){var f=this;if(u=u||{},!Array.isArray(r)){if(!i.MIDI_REGISTERED_PARAMETER[r])throw new Error("The specified parameter is not available.");r=i.MIDI_REGISTERED_PARAMETER[r]}return i.toMIDIChannels(a).forEach(function(){f._selectRegisteredParameter(r,a,u.time),f._setCurrentRegisteredParameter(o,a,u.time),f._deselectRegisteredParameter(a,u.time)}),this},c.prototype.setNonRegisteredParameter=function(r,o,a,u){var f=this;if(u=u||{},!(0<=r[0]&&r[0]<=127&&0<=r[1]&&r[1]<=127))throw new Error("Position 0 and 1 of the 2-position parameter array must both be between 0 and 127.");return o=[].concat(o),i.toMIDIChannels(a).forEach(function(){f._selectNonRegisteredParameter(r,a,u.time),f._setCurrentRegisteredParameter(o,a,u.time),f._deselectRegisteredParameter(a,u.time)}),this},c.prototype.incrementRegisteredParameter=function(r,o,a){var u=this;if(a=a||{},!Array.isArray(r)){if(!i.MIDI_REGISTERED_PARAMETER[r])throw new Error("The specified parameter is not available.");r=i.MIDI_REGISTERED_PARAMETER[r]}return i.toMIDIChannels(o).forEach(function(){u._selectRegisteredParameter(r,o,a.time),u.sendControlChange(96,0,o,{time:a.time}),u._deselectRegisteredParameter(o,a.time)}),this},c.prototype.decrementRegisteredParameter=function(r,o,a){if(a=a||{},!Array.isArray(r)){if(!i.MIDI_REGISTERED_PARAMETER[r])throw new TypeError("The specified parameter is not available.");r=i.MIDI_REGISTERED_PARAMETER[r]}return i.toMIDIChannels(o).forEach(function(){this._selectRegisteredParameter(r,o,a.time),this.sendControlChange(97,0,o,{time:a.time}),this._deselectRegisteredParameter(o,a.time)}.bind(this)),this},c.prototype.setPitchBendRange=function(r,o,a,u){var f=this;if(u=u||{},!(0<=(r=Math.floor(r)||0)&&r<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(o=Math.floor(o)||0)&&o<=127))throw new RangeError("The cents value must be between 0 and 127");return i.toMIDIChannels(a).forEach(function(){f.setRegisteredParameter("pitchbendrange",[r,o],a,{time:u.time})}),this},c.prototype.setModulationRange=function(r,o,a,u){var f=this;if(u=u||{},!(0<=(r=Math.floor(r)||0)&&r<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(o=Math.floor(o)||0)&&o<=127))throw new RangeError("The cents value must be between 0 and 127");return i.toMIDIChannels(a).forEach(function(){f.setRegisteredParameter("modulationrange",[r,o],a,{time:u.time})}),this},c.prototype.setMasterTuning=function(r,o,a){var u=this;if(a=a||{},(r=parseFloat(r)||0)<=-65||64<=r)throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");var f=Math.floor(r)+64,h=r-Math.floor(r),d=(h=Math.round((h+1)/2*16383))>>7&127,g=127&h;return i.toMIDIChannels(o).forEach(function(){u.setRegisteredParameter("channelcoarsetuning",f,o,{time:a.time}),u.setRegisteredParameter("channelfinetuning",[d,g],o,{time:a.time})}),this},c.prototype.setTuningProgram=function(r,o,a){var u=this;if(a=a||{},!(0<=(r=Math.floor(r))&&r<=127))throw new RangeError("The program value must be between 0 and 127");return i.toMIDIChannels(o).forEach(function(){u.setRegisteredParameter("tuningprogram",r,o,{time:a.time})}),this},c.prototype.setTuningBank=function(r,o,a){var u=this;if(a=a||{},!(0<=(r=Math.floor(r)||0)&&r<=127))throw new RangeError("The bank value must be between 0 and 127");return i.toMIDIChannels(o).forEach(function(){u.setRegisteredParameter("tuningbank",r,o,{time:a.time})}),this},c.prototype.sendChannelMode=function(r,o,a,u){if(u=u||{},typeof r=="string"){if(!(r=i.MIDI_CHANNEL_MODE_MESSAGES[r]))throw new TypeError("Invalid channel mode message name.")}else if(!(120<=(r=Math.floor(r))&&r<=127))throw new RangeError("Channel mode numerical identifiers must be between 120 and 127.");if((o=Math.floor(o)||0)<0||127<o)throw new RangeError("Value must be an integer between 0 and 127.");return i.toMIDIChannels(a).forEach(function(f){this.send((i.MIDI_CHANNEL_MESSAGES.channelmode<<4)+(f-1),[r,o],this._parseTimeParameter(u.time))}.bind(this)),this},c.prototype.sendProgramChange=function(r,o,a){var u=this;if(a=a||{},r=Math.floor(r),isNaN(r)||r<0||127<r)throw new RangeError("Program numbers must be between 0 and 127.");return i.toMIDIChannels(o).forEach(function(f){u.send((i.MIDI_CHANNEL_MESSAGES.programchange<<4)+(f-1),[r],u._parseTimeParameter(a.time))}),this},c.prototype.sendChannelAftertouch=function(r,o,a){var u=this;a=a||{},r=parseFloat(r),(isNaN(r)||r<0||1<r)&&(r=.5);var f=Math.round(127*r);return i.toMIDIChannels(o).forEach(function(h){u.send((i.MIDI_CHANNEL_MESSAGES.channelaftertouch<<4)+(h-1),[f],u._parseTimeParameter(a.time))}),this},c.prototype.sendPitchBend=function(r,o,a){var u=this;if(a=a||{},isNaN(r)||r<-1||1<r)throw new RangeError("Pitch bend value must be between -1 and 1.");var f=Math.round((r+1)/2*16383),h=f>>7&127,d=127&f;return i.toMIDIChannels(o).forEach(function(g){u.send((i.MIDI_CHANNEL_MESSAGES.pitchbend<<4)+(g-1),[d,h],u._parseTimeParameter(a.time))}),this},c.prototype._parseTimeParameter=function(r){var o,a=parseFloat(r);return typeof r=="string"&&r.substring(0,1)==="+"?a&&0<a&&(o=i.time+a):a>i.time&&(o=a),o},c.prototype._convertNoteToArray=function(r){var o=[];return Array.isArray(r)||(r=[r]),r.forEach(function(a){o.push(i.guessNoteNumber(a))}),o},t.exports?t.exports=i:e.WebMidi||(e.WebMidi=i)})(J)}),Te=go;var qr="route-to",ut="toggle-debug",be="toggle-key-state",_e="set-key-state",ft="reset-key-state",lt="set-random-key-state",Ge="set-highlights",ht="reset-highlights",dt="set-size",mt="toggle-view-config",pt="set-midi-devices";var le="set-midi-file",gt="set-midi-file-error",$r="set-comparison";var Wr=t=>{Te.inputs.forEach(e=>e.addListener("noteon","all",n=>{t.dispatch([be,n.note.number%12]),console.log(`Received 'noteon' message (${n.note.name+n.note.octave}) from ${e.name}`)}))},Yr=t=>{Te.enable(e=>{if(e){console.log("WebMidi could not be enabled.",e);return}else console.log("WebMidi enabled!"),t.dispatch([pt,Te.inputs.map(n=>n.name)]);Wr(t)})},yo=(t,e)=>{if(Te.inputs.forEach(n=>n.removeListener()),e==="All Devices"){Wr(t);return}else{let n=Te.getInputByName(e);n&&n.addListener("noteon","all",i=>{t.dispatch([be,i.note.number%12]),console.log(`Received 'noteon' message (${i.note.name+i.note.octave}) from ${e}`)})}},Kr=t=>{let e=t.views,n=t.ui.midiDevicesStatus,i=t.bus;return()=>{let s=e.enabledMidi.deref(),c=e.midiDevices.deref();return["div",["span",n.content[Number(s)],""],["span",n.dropdown.root,c.length>=1?[Nr,{...n.dropdown.selection,onchange:r=>yo(i,r.target.value)},V(D(r=>[r,r]),L(),["All Devices",...c])]:"Web MIDI unavailable"]]}};function Jr(t,e,n,i){return["a",{...n,onclick:s=>{s.preventDefault(),t.bus.dispatch(e)}},i]}function Xr(t,e,n){return["div#debug",t.ui.column.debug[e],[Jr,[ut],t.ui.debugToggle,e?"close":"open"],["pre",t.ui.code,n]]}var Kt="route-to";var yt=or,Jt=class{constructor(e){this.config=e,this.state=new me(e.initialState||{}),this.ctx={bus:new Lt(this.state,e.events,e.effects),views:{},ui:e.ui},this.addViews(this.config.views),this.router=new zt(e.router),this.router.addListener(Se,n=>this.ctx.bus.dispatch([Se,n.value])),this.ctx.bus.addHandlers({[Se]:xr("route"),[qr]:(n,[i,s])=>({[Kt]:s})}),this.ctx.bus.addEffect(Kt,([n,i])=>this.router.routeTo(this.router.format(n,i))),yt&&yt==="development"&&this.ctx.bus.instrumentWith([kr]),this.addViews({route:"route",routeComponent:["route.id",n=>(this.config.components[n]||(()=>["div",`missing component for route: ${n}`]))(this.ctx)]})}addViews(e){let n=this.ctx.views;for(let i in e){let s=e[i];n[i]=H(s)?Rt(this.state,s[0],s[1]):Rt(this.state,s)}}start(){Yr(this.ctx.bus),window.addEventListener("resize",()=>{this.ctx.bus.dispatch([dt])}),this.router.start(),wr(()=>{if(this.ctx.bus.processQueue())return this.rootComponent()},{root:this.config.domRoot,ctx:this.ctx})}rootComponent(){let e=this.ctx.views.debug.deref(),n=this.ctx.ui;return["div",n.root,yt&&yt==="development"?[["div",n.column.content[e],this.ctx.views.routeComponent],[Xr,e,this.ctx.views.json]]:["div",this.ctx.views.routeComponent]]}};var Xt=(t,e,n={})=>(i,s)=>["a",{...n,onclick:t,disabled:s},e];var Qr=t=>{let e=t.ui,n=Xt(s=>{s.preventDefault(),t.bus.dispatch([ft])},"CLEAR",e.toolbar.button),i=Xt(s=>{s.preventDefault(),t.bus.dispatch([lt])},"RANDOM",e.toolbar.button);return()=>["div",e.toolbar.root,[n],[i]]};var bo={anim:100,pad:1,margin:0,hlOn:{fill:"#E83015"},bgOn:{fill:"#CCCCCC"},bgOff:{fill:"#CCCCCC"},fgOn:{fill:"#E83015"},fgOff:{fill:"#fff"},floor:1},_o=["filter",{id:"blur"},["feGaussianBlur",{in:"SourceGraphic",stdDeviation:".25"}]],bt=(t={})=>{let e={r:5,...bo,...t},{r:n,pad:i,margin:s,glyph:c,floor:r}=e,o=.5,a=n*o**2,u=s*2,f=n+i,h=f+s,g=f*2+u,E={width:g,height:g*r},M={transition:`all ${e.anim}ms ease-out`},I={cx:h,cy:h},v={...e.hlOn,...I,r:f},_={...e.bgOn,...I,style:M,r:n},T={..._,...e.bgOff},A={...e.fgOn,...I,style:M,r:a},R={...A,...e.fgOff},U={...e.fgOn,x:"50%",y:"50%","text-anchor":"middle","alignment-baseline":"central",font:"bold font-sans","font-size":g*o,style:M},Z={...U,...e.fgOff};return(oe,B,ee,m)=>["svg",{...E,...B},_o,["g",["circle",m?v:{}],["circle",ee?_:T],c?["text",ee?U:Z,c]:["circle",ee?A:R]]]};var Qt={anim:0,r:16,pad:2},vo={...Qt,glyph:"C"},Eo={...Qt,bgOn:{fill:"#000"},bgOff:{fill:"#000"}},Io=(t,e)=>[1,3,6,8,10].includes(t)?e.minor:t===4?e.e:e.major,Zr=t=>{let e=t.views,n=t.ui,i=e.size.deref(),s=Math.min(18*2,i[0]*.9/13),c={r:s/2*(8/9),pad:s/2*(1/9)},r=e.highlights.deref();return["div.mb-4",...e.keyState.deref().map((o,a)=>["div",Io(a,n.toggleGroup.key),[a===0?bt({...vo,...c}):[2,4,5,7,9,11].includes(a)?bt({...Qt,...c}):bt({...Eo,...c}),{onclick:u=>{u.preventDefault(),t.bus.dispatch([be,a])}},o,r.includes(a)]])]};var So=t=>t[Symbol.iterator]();function*Zt(t,e){let n={},i=So(t),s;for(;s=i.next(),!s.done;){let c=e?e(s.value):s.value,r=JSON.stringify(c),o=n[r];o?o[1]++:n[r]=[c,1]}yield*Object.keys(n).map(c=>n[c])}var wo=t=>t instanceof Map;function Mo(t,e){if(wo(t))for(let n of e)t.set(n[0],n[1]);else for(let n of e)t.add(n);return t}var To=(t,e)=>se(t,"empty")?t.empty():new(t[Symbol.species]||e),er=(t,e,n)=>{if(n=n||To(t,Set),t===e)return Mo(n,t);if(e.size<t.size)return er(e,t,n);for(let i of e)t.has(i)&&n.add(i);return n};var _t=(t,e)=>Array(Math.abs(e)+1).join(t);function vt(t){return t!==null&&typeof t=="object"&&typeof t.name=="string"}function Et(t){return t!==null&&typeof t=="object"&&typeof t.step=="number"&&typeof t.alt=="number"}var en=[0,2,4,-1,1,3,5],tn=en.map(t=>Math.floor(t*7/12));function rn(t){let{step:e,alt:n,oct:i,dir:s=1}=t,c=en[e]+7*n;if(i===void 0)return[s*c];let r=i-tn[e]-4*n;return[s*c,s*r]}var Ao=[3,0,4,1,5,2,6];function xo(t){let[e,n,i]=t,s=Ao[ko(e)],c=Math.floor((e+1)/7);if(n===void 0)return{step:s,alt:c,dir:i};let r=n+4*c+tn[s];return{step:s,alt:c,oct:r,dir:i}}function ko(t){let e=(t+1)%7;return e<0?7+e:e}var nn={empty:!0,name:"",pc:"",acc:""},on=new Map,Co=t=>"CDEFGAB".charAt(t),It=t=>t<0?_t("b",-t):_t("#",t),tr=t=>t[0]==="b"?-t.length:t.length;function Q(t){let e=on.get(t);if(e)return e;let n=typeof t=="string"?Oo(t):Et(t)?Q(No(t)):vt(t)?Q(t.name):nn;return on.set(t,n),n}var Do=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Fo(t){let e=Do.exec(t);return[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]}function jo(t){return Q(xo(t))}var Ro=(t,e)=>(t%e+e)%e,rr=[0,2,4,5,7,9,11];function Oo(t){let e=Fo(t);if(e[0]===""||e[3]!=="")return nn;let n=e[0],i=e[1],s=e[2],c=(n.charCodeAt(0)+3)%7,r=tr(i),o=s.length?+s:void 0,a=rn({step:c,alt:r,oct:o}),u=n+i+s,f=n+i,h=(rr[c]+r+120)%12,d=o===void 0?Ro(rr[c]+r,12)-12*99:rr[c]+r+12*(o+1),g=d>=0&&d<=127?d:null,E=o===void 0?null:Math.pow(2,(d-69)/12)*440;return{empty:!1,acc:i,alt:r,chroma:h,coord:a,freq:E,height:d,letter:n,midi:g,name:u,oct:o,pc:f,step:c}}function No(t){let{step:e,alt:n,oct:i}=t,s=Co(e);if(!s)return"";let c=s+It(n);return i||i===0?c+i:c}var nr={empty:!0,name:"",acc:""},Po="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",Go="(AA|A|P|M|m|d|dd)([-+]?\\d+)",Uo=new RegExp("^"+Po+"|"+Go+"$");function Ho(t){let e=Uo.exec(`${t}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var sn={};function Ue(t){return typeof t=="string"?sn[t]||(sn[t]=Bo(t)):Et(t)?Ue(Lo(t)):vt(t)?Ue(t.name):nr}var an=[0,2,4,5,7,9,11],cn="PMMPPMM";function Bo(t){let e=Ho(t);if(e[0]==="")return nr;let n=+e[0],i=e[1],s=(Math.abs(n)-1)%7,c=cn[s];if(c==="M"&&i==="P")return nr;let r=c==="M"?"majorable":"perfectable",o=""+n+i,a=n<0?-1:1,u=n===8||n===-8?n:a*(s+1),f=Vo(r,i),h=Math.floor((Math.abs(n)-1)/7),d=a*(an[s]+f+12*h),g=(a*(an[s]+f)%12+12)%12,E=rn({step:s,alt:f,oct:h,dir:a});return{empty:!1,name:o,num:n,q:i,step:s,alt:f,dir:a,type:r,simple:u,semitones:d,chroma:g,coord:E,oct:h}}function Vo(t,e){return e==="M"&&t==="majorable"||e==="P"&&t==="perfectable"?0:e==="m"&&t==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(t==="perfectable"?e.length:e.length+1):0}function Lo(t){let{step:e,alt:n,oct:i=0,dir:s}=t;if(!s)return"";let c=e+1+7*i,r=c===0?e+1:c,o=s<0?"-":"",a=cn[e]==="M"?"majorable":"perfectable";return o+r+zo(a,n)}function zo(t,e){return e===0?t==="majorable"?"M":"P":e===-1&&t==="majorable"?"m":e>0?_t("A",e):_t("d",t==="perfectable"?e:e+1)}function St(t,e){let n=Q(t),i=Ue(e);if(n.empty||i.empty)return"";let s=n.coord,c=i.coord,r=s.length===1?[s[0]+c[0]]:[s[0]+c[0],s[1]+c[1]];return jo(r).name}var un={empty:!0,name:"",chordType:""},fn={};function He(t){return typeof t=="string"?fn[t]||(fn[t]=$o(t)):typeof t=="number"?He(ir[t]||""):Et(t)?qo(t):vt(t)?He(t.name):un}function qo(t){return He(It(t.alt)+ir[t.step])}var Wo=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function Yo(t){return Wo.exec(t)||["","","",""]}var Ko="I II III IV V VI VII",ir=Ko.split(" ");function $o(t){let[e,n,i,s]=Yo(t);if(!i)return un;let c=i.toUpperCase(),r=ir.indexOf(c),o=tr(n),a=1;return{empty:!1,name:e,roman:i,interval:Ue({step:r,alt:o,dir:a}).name,acc:n,chordType:s,alt:o,step:r,major:i===c,oct:0,dir:a}}var ie=Object.freeze([]),Jo={type:"major",tonic:"",alteration:0,keySignature:""},Xo={tonic:"",grades:ie,intervals:ie,scale:ie,chords:ie,chordsHarmonicFunction:ie,chordScales:ie},Qo={...Jo,...Xo,type:"major",minorRelative:"",scale:ie,secondaryDominants:ie,secondaryDominantsMinorRelative:ie,substituteDominants:ie,substituteDominantsMinorRelative:ie},ln=(t,e,n="")=>e.map((i,s)=>`${t[s]}${n}${i}`);function Zo(t,e,n,i){return s=>{let c=t.map(o=>He(o).interval||""),r=c.map(o=>St(s,o));return{tonic:s,grades:t,intervals:c,scale:r,chords:ln(r,e),chordsHarmonicFunction:n.slice(),chordScales:ln(r,i," ")}}}var es=(t,e)=>{let n=Q(t),i=Q(e);return n.empty||i.empty?0:i.coord[0]-n.coord[0]},ts=Zo("I II III IV V VI VII".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(","));function hn(t){let e=Q(t).pc;if(!e)return Qo;let n=ts(e),i=es("C",e),s=c=>{let r=He(c);return r.empty?"":St(t,r.interval)+r.chordType};return{...n,type:"major",minorRelative:St(e,"-3m"),alteration:i,keySignature:It(i),secondaryDominants:"- VI7 VII7 I7 II7 III7 -".split(" ").map(s),secondaryDominantsMinorRelative:"- IIIm7b5 IV#m7 Vm7 VIm7 VIIm7b5 -".split(" ").map(s),substituteDominants:"- bIII7 IV7 bV7 bVI7 bVII7 -".split(" ").map(s),substituteDominantsMinorRelative:"- IIIm7 Im7 IIbm7 VIm7 IVm7 -".split(" ").map(s)}}function rs(t){return+t>=0&&+t<=127}function wt(t){if(rs(t))return+t;let e=Q(t);return e.empty?null:e.midi}var ns="C C# D D# E F F# G G# A A# B".split(" "),is="C Db D Eb E F Gb G Ab A Bb B".split(" ");function dn(t,e={}){if(isNaN(t)||t===-Infinity||t===Infinity)return"";t=Math.round(t);let i=(e.sharps===!0?ns:is)[t%12];if(e.pitchClass)return i;let s=Math.floor(t/12)-1;return i+s}var os=Q,mn=t=>{let e=os(t);return e.empty?"":dn(e.midi||e.chroma,{sharps:e.alt>0,pitchClass:e.midi===null})};function cs(t){var e=new W(t),n=e.readChunk();if(n.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+n.id+"'";for(var i=ss(n.data),s=[],c=0;!e.eof()&&c<i.numTracks;c++){var r=e.readChunk();if(r.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+r.id+"'";var o=as(r.data);s.push(o)}return{header:i,tracks:s}}function ss(t){var e=new W(t),n=e.readUInt16(),i=e.readUInt16(),s={format:n,numTracks:i},c=e.readUInt16();return c&32768?(s.framesPerSecond=256-(c>>8),s.ticksPerFrame=c&255):s.ticksPerBeat=c,s}function as(t){for(var e=new W(t),n=[];!e.eof();){var i=c();n.push(i)}return n;var s;function c(){var r={};r.deltaTime=e.readVarInt();var o=e.readUInt8();if((o&240)==240)if(o===255){r.meta=!0;var a=e.readUInt8(),u=e.readVarInt();switch(a){case 0:if(r.type="sequenceNumber",u!==2)throw"Expected length for sequenceNumber event is 2, got "+u;return r.number=e.readUInt16(),r;case 1:return r.type="text",r.text=e.readString(u),r;case 2:return r.type="copyrightNotice",r.text=e.readString(u),r;case 3:return r.type="trackName",r.text=e.readString(u),r;case 4:return r.type="instrumentName",r.text=e.readString(u),r;case 5:return r.type="lyrics",r.text=e.readString(u),r;case 6:return r.type="marker",r.text=e.readString(u),r;case 7:return r.type="cuePoint",r.text=e.readString(u),r;case 32:if(r.type="channelPrefix",u!=1)throw"Expected length for channelPrefix event is 1, got "+u;return r.channel=e.readUInt8(),r;case 33:if(r.type="portPrefix",u!=1)throw"Expected length for portPrefix event is 1, got "+u;return r.port=e.readUInt8(),r;case 47:if(r.type="endOfTrack",u!=0)throw"Expected length for endOfTrack event is 0, got "+u;return r;case 81:if(r.type="setTempo",u!=3)throw"Expected length for setTempo event is 3, got "+u;return r.microsecondsPerBeat=e.readUInt24(),r;case 84:if(r.type="smpteOffset",u!=5)throw"Expected length for smpteOffset event is 5, got "+u;var f=e.readUInt8(),h={0:24,32:25,64:29,96:30};return r.frameRate=h[f&96],r.hour=f&31,r.min=e.readUInt8(),r.sec=e.readUInt8(),r.frame=e.readUInt8(),r.subFrame=e.readUInt8(),r;case 88:if(r.type="timeSignature",u!=4)throw"Expected length for timeSignature event is 4, got "+u;return r.numerator=e.readUInt8(),r.denominator=1<<e.readUInt8(),r.metronome=e.readUInt8(),r.thirtyseconds=e.readUInt8(),r;case 89:if(r.type="keySignature",u!=2)throw"Expected length for keySignature event is 2, got "+u;return r.key=e.readInt8(),r.scale=e.readUInt8(),r;case 127:return r.type="sequencerSpecific",r.data=e.readBytes(u),r;default:return r.type="unknownMeta",r.data=e.readBytes(u),r.metatypeByte=a,r}}else if(o==240){r.type="sysEx";var u=e.readVarInt();return r.data=e.readBytes(u),r}else if(o==247){r.type="endSysEx";var u=e.readVarInt();return r.data=e.readBytes(u),r}else throw"Unrecognised MIDI event type byte: "+o;else{var d;if((o&128)==0){if(s===null)throw"Running status byte encountered before status byte";d=o,o=s,r.running=!0}else d=e.readUInt8(),s=o;var g=o>>4;switch(r.channel=o&15,g){case 8:return r.type="noteOff",r.noteNumber=d,r.velocity=e.readUInt8(),r;case 9:var E=e.readUInt8();return r.type=E===0?"noteOff":"noteOn",r.noteNumber=d,r.velocity=E,E===0&&(r.byte9=!0),r;case 10:return r.type="noteAftertouch",r.noteNumber=d,r.amount=e.readUInt8(),r;case 11:return r.type="controller",r.controllerType=d,r.value=e.readUInt8(),r;case 12:return r.type="programChange",r.programNumber=d,r;case 13:return r.type="channelAftertouch",r.amount=d,r;case 14:return r.type="pitchBend",r.value=d+(e.readUInt8()<<7)-8192,r;default:throw"Unrecognised MIDI event type: "+g}}}}function W(t){this.buffer=t,this.bufferLen=this.buffer.length,this.pos=0}W.prototype.eof=function(){return this.pos>=this.bufferLen};W.prototype.readUInt8=function(){var t=this.buffer[this.pos];return this.pos+=1,t};W.prototype.readInt8=function(){var t=this.readUInt8();return t&128?t-256:t};W.prototype.readUInt16=function(){var t=this.readUInt8(),e=this.readUInt8();return(t<<8)+e};W.prototype.readInt16=function(){var t=this.readUInt16();return t&32768?t-65536:t};W.prototype.readUInt24=function(){var t=this.readUInt8(),e=this.readUInt8(),n=this.readUInt8();return(t<<16)+(e<<8)+n};W.prototype.readInt24=function(){var t=this.readUInt24();return t&8388608?t-16777216:t};W.prototype.readUInt32=function(){var t=this.readUInt8(),e=this.readUInt8(),n=this.readUInt8(),i=this.readUInt8();return(t<<24)+(e<<16)+(n<<8)+i};W.prototype.readBytes=function(t){var e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e};W.prototype.readString=function(t){var e=this.readBytes(t);return String.fromCharCode.apply(null,e)};W.prototype.readVarInt=function(){for(var t=0;!this.eof();){var e=this.readUInt8();if(e&128)t+=e&127,t<<=7;else return t+e}return t};W.prototype.readChunk=function(){var t=this.readString(4),e=this.readUInt32(),n=this.readBytes(e);return{id:t,length:e,data:n}};var us=cs;function hs(t,e){if(typeof t!="object")throw"Invalid MIDI data";e=e||{};var n=t.header||{},i=t.tracks||[],s,c=i.length,r=new G;for(fs(r,n,c),s=0;s<c;s++)ls(r,i[s],e);return r.buffer}function fs(t,e,n){var i=e.format==null?1:e.format,s=128;e.timeDivision?s=e.timeDivision:e.ticksPerFrame&&e.framesPerSecond?s=-(e.framesPerSecond&255)<<8|e.ticksPerFrame&255:e.ticksPerBeat&&(s=e.ticksPerBeat&32767);var c=new G;c.writeUInt16(i),c.writeUInt16(n),c.writeUInt16(s),t.writeChunk("MThd",c.buffer)}function ls(t,e,n){var i=new G,s,c=e.length,r=null;for(s=0;s<c;s++)(n.running===!1||!n.running&&!e[s].running)&&(r=null),r=ds(i,e[s],r,n.useByte9ForNoteOff);t.writeChunk("MTrk",i.buffer)}function ds(t,e,n,i){var s=e.type,c=e.deltaTime,r=e.text||"",o=e.data||[],a=null;switch(t.writeVarInt(c),s){case"sequenceNumber":t.writeUInt8(255),t.writeUInt8(0),t.writeVarInt(2),t.writeUInt16(e.number);break;case"text":t.writeUInt8(255),t.writeUInt8(1),t.writeVarInt(r.length),t.writeString(r);break;case"copyrightNotice":t.writeUInt8(255),t.writeUInt8(2),t.writeVarInt(r.length),t.writeString(r);break;case"trackName":t.writeUInt8(255),t.writeUInt8(3),t.writeVarInt(r.length),t.writeString(r);break;case"instrumentName":t.writeUInt8(255),t.writeUInt8(4),t.writeVarInt(r.length),t.writeString(r);break;case"lyrics":t.writeUInt8(255),t.writeUInt8(5),t.writeVarInt(r.length),t.writeString(r);break;case"marker":t.writeUInt8(255),t.writeUInt8(6),t.writeVarInt(r.length),t.writeString(r);break;case"cuePoint":t.writeUInt8(255),t.writeUInt8(7),t.writeVarInt(r.length),t.writeString(r);break;case"channelPrefix":t.writeUInt8(255),t.writeUInt8(32),t.writeVarInt(1),t.writeUInt8(e.channel);break;case"portPrefix":t.writeUInt8(255),t.writeUInt8(33),t.writeVarInt(1),t.writeUInt8(e.port);break;case"endOfTrack":t.writeUInt8(255),t.writeUInt8(47),t.writeVarInt(0);break;case"setTempo":t.writeUInt8(255),t.writeUInt8(81),t.writeVarInt(3),t.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":t.writeUInt8(255),t.writeUInt8(84),t.writeVarInt(5);var u={24:0,25:32,29:64,30:96},f=e.hour&31|u[e.frameRate];t.writeUInt8(f),t.writeUInt8(e.min),t.writeUInt8(e.sec),t.writeUInt8(e.frame),t.writeUInt8(e.subFrame);break;case"timeSignature":t.writeUInt8(255),t.writeUInt8(88),t.writeVarInt(4),t.writeUInt8(e.numerator);var h=Math.floor(Math.log(e.denominator)/Math.LN2)&255;t.writeUInt8(h),t.writeUInt8(e.metronome),t.writeUInt8(e.thirtyseconds||8);break;case"keySignature":t.writeUInt8(255),t.writeUInt8(89),t.writeVarInt(2),t.writeInt8(e.key),t.writeUInt8(e.scale);break;case"sequencerSpecific":t.writeUInt8(255),t.writeUInt8(127),t.writeVarInt(o.length),t.writeBytes(o);break;case"unknownMeta":e.metatypeByte!=null&&(t.writeUInt8(255),t.writeUInt8(e.metatypeByte),t.writeVarInt(o.length),t.writeBytes(o));break;case"sysEx":t.writeUInt8(240),t.writeVarInt(o.length),t.writeBytes(o);break;case"endSysEx":t.writeUInt8(247),t.writeVarInt(o.length),t.writeBytes(o);break;case"noteOff":var d=i!==!1&&e.byte9||i&&e.velocity==0?144:128;a=d|e.channel,a!==n&&t.writeUInt8(a),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteOn":a=144|e.channel,a!==n&&t.writeUInt8(a),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteAftertouch":a=160|e.channel,a!==n&&t.writeUInt8(a),t.writeUInt8(e.noteNumber),t.writeUInt8(e.amount);break;case"controller":a=176|e.channel,a!==n&&t.writeUInt8(a),t.writeUInt8(e.controllerType),t.writeUInt8(e.value);break;case"programChange":a=192|e.channel,a!==n&&t.writeUInt8(a),t.writeUInt8(e.programNumber);break;case"channelAftertouch":a=208|e.channel,a!==n&&t.writeUInt8(a),t.writeUInt8(e.amount);break;case"pitchBend":a=224|e.channel,a!==n&&t.writeUInt8(a);var g=8192+e.value,E=g&127,M=g>>7&127;t.writeUInt8(E),t.writeUInt8(M);break;default:throw"Unrecognized event type: "+s}return a}function G(){this.buffer=[]}G.prototype.writeUInt8=function(t){this.buffer.push(t&255)};G.prototype.writeInt8=G.prototype.writeUInt8;G.prototype.writeUInt16=function(t){var e=t>>8&255,n=t&255;this.writeUInt8(e),this.writeUInt8(n)};G.prototype.writeInt16=G.prototype.writeUInt16;G.prototype.writeUInt24=function(t){var e=t>>16&255,n=t>>8&255,i=t&255;this.writeUInt8(e),this.writeUInt8(n),this.writeUInt8(i)};G.prototype.writeInt24=G.prototype.writeUInt24;G.prototype.writeUInt32=function(t){var e=t>>24&255,n=t>>16&255,i=t>>8&255,s=t&255;this.writeUInt8(e),this.writeUInt8(n),this.writeUInt8(i),this.writeUInt8(s)};G.prototype.writeInt32=G.prototype.writeUInt32;G.prototype.writeBytes=function(t){this.buffer=this.buffer.concat(Array.prototype.slice.call(t,0))};G.prototype.writeString=function(t){var e,n=t.length,i=[];for(e=0;e<n;e++)i.push(t.codePointAt(e));this.writeBytes(i)};G.prototype.writeVarInt=function(t){if(t<0)throw"Cannot write negative variable-length integer";if(t<=127)this.writeUInt8(t);else{var e=t,n=[];for(n.push(e&127),e>>=7;e;){var i=e&127|128;n.push(i),e>>=7}this.writeBytes(n.reverse())}};G.prototype.writeChunk=function(t,e){this.writeString(t),this.writeUInt32(e.length),this.writeBytes(e)};var ms=hs,ps=us,gs=ms,pn={parseMidi:ps,writeMidi:gs},Ae=z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});function n(s,c,r){r===void 0&&(r="ticks");var o=0,a=s.length,u=a;if(a>0&&s[a-1][r]<=c)return a-1;for(;o<u;){var f=Math.floor(o+(u-o)/2),h=s[f],d=s[f+1];if(h[r]===c){for(var g=f;g<s.length;g++){var E=s[g];E[r]===c&&(f=g)}return f}else{if(h[r]<c&&d[r]>c)return f;h[r]>c?u=f:h[r]<c&&(o=f+1)}}return-1}e.search=n;function i(s,c,r){if(r===void 0&&(r="ticks"),s.length){var o=n(s,c[r],r);s.splice(o+1,0,c)}else s.push(c)}e.insert=i}),Mt=z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=new WeakMap;e.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var i=function(){function s(c){var r=this;this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",n.set(this,480),c&&(n.set(this,c.header.ticksPerBeat),c.tracks.forEach(function(o){return o.forEach(function(a){a.meta&&(a.type==="timeSignature"?r.timeSignatures.push({ticks:a.absoluteTime,timeSignature:[a.numerator,a.denominator]}):a.type==="setTempo"?r.tempos.push({bpm:6e7/a.microsecondsPerBeat,ticks:a.absoluteTime}):a.type==="keySignature"&&r.keySignatures.push({key:e.keySignatureKeys[a.key+7],scale:a.scale===0?"major":"minor",ticks:a.absoluteTime}))})}),c.tracks[0].forEach(function(o){o.meta&&(o.type==="trackName"?r.name=o.text:(o.type==="text"||o.type==="cuePoint"||o.type==="marker"||o.type==="lyrics")&&r.meta.push({text:o.text,ticks:o.absoluteTime,type:o.type}))}),this.update())}return s.prototype.update=function(){var c=this,r=0,o=0;this.tempos.sort(function(a,u){return a.ticks-u.ticks}),this.tempos.forEach(function(a,u){var f=u>0?c.tempos[u-1].bpm:c.tempos[0].bpm,h=a.ticks/c.ppq-o,d=60/f*h;a.time=d+r,r=a.time,o+=h}),this.timeSignatures.sort(function(a,u){return a.ticks-u.ticks}),this.timeSignatures.forEach(function(a,u){var f=u>0?c.timeSignatures[u-1]:c.timeSignatures[0],h=(a.ticks-f.ticks)/c.ppq,d=h/f.timeSignature[0]/(f.timeSignature[1]/4);f.measures=f.measures||0,a.measures=d+f.measures})},s.prototype.ticksToSeconds=function(c){var r=Ae.search(this.tempos,c);if(r!==-1){var o=this.tempos[r],a=o.time,u=(c-o.ticks)/this.ppq;return a+60/o.bpm*u}else{var f=c/this.ppq;return 60/120*f}},s.prototype.ticksToMeasures=function(c){var r=Ae.search(this.timeSignatures,c);if(r!==-1){var o=this.timeSignatures[r],a=(c-o.ticks)/this.ppq;return o.measures+a/(o.timeSignature[0]/o.timeSignature[1])/4}else return c/this.ppq/4},Object.defineProperty(s.prototype,"ppq",{get:function(){return n.get(this)},enumerable:!0,configurable:!0}),s.prototype.secondsToTicks=function(c){var r=Ae.search(this.tempos,c,"time");if(r!==-1){var o=this.tempos[r],a=o.time,u=c-a,f=u/(60/o.bpm);return Math.round(o.ticks+f*this.ppq)}else{var h=c/(60/120);return Math.round(h*this.ppq)}},s.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(c){return{bpm:c.bpm,ticks:c.ticks}}),timeSignatures:this.timeSignatures}},s.prototype.fromJSON=function(c){this.name=c.name,this.tempos=c.tempos.map(function(r){return Object.assign({},r)}),this.timeSignatures=c.timeSignatures.map(function(r){return Object.assign({},r)}),this.keySignatures=c.keySignatures.map(function(r){return Object.assign({},r)}),this.meta=c.meta.map(function(r){return Object.assign({},r)}),n.set(this,c.ppq),this.update()},s.prototype.setTempo=function(c){this.tempos=[{bpm:c,ticks:0}],this.update()},s}();e.Header=i}),Tt=ys,bs=gn,vs=_s,Es=yn;function ys(t){if(!Array.isArray(t))throw new TypeError("Expected value to be an array");return gn(t)}function gn(t){return bn(t,[])}function _s(t,e){if(!Array.isArray(t))throw new TypeError("Expected value to be an array");return yn(t,e)}function yn(t,e){if(typeof e!="number")throw new TypeError("Expected the depth to be a number");return _n(t,[],e)}function bn(t,e){for(var n=0;n<t.length;n++){var i=t[n];Array.isArray(i)?bn(i,e):e.push(i)}return e}function _n(t,e,n){n--;for(var i=0;i<t.length;i++){var s=t[i];n>-1&&Array.isArray(s)?_n(s,e,n):e.push(s)}return e}Tt.from=bs;Tt.depth=vs;Tt.fromDepth=Es;var Is=z(function(t,e){var n=J&&J.__spreadArrays||function(){for(var _=0,T=0,A=arguments.length;T<A;T++)_+=arguments[T].length;for(var R=Array(_),U=0,T=0;T<A;T++)for(var Z=arguments[T],oe=0,B=Z.length;oe<B;oe++,U++)R[U]=Z[oe];return R},i=J&&J.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(e,"__esModule",{value:!0});var s=i(Tt);function c(_,T){return[{absoluteTime:_.ticks,channel:T,deltaTime:0,noteNumber:_.midi,type:"noteOn",velocity:Math.floor(_.velocity*127)},{absoluteTime:_.ticks+_.durationTicks,channel:T,deltaTime:0,noteNumber:_.midi,type:"noteOff",velocity:Math.floor(_.noteOffVelocity*127)}]}function r(_){return s.default(_.notes.map(function(T){return c(T,_.channel)}))}function o(_,T){return{absoluteTime:_.ticks,channel:T,controllerType:_.number,deltaTime:0,type:"controller",value:Math.floor(_.value*127)}}function a(_){for(var T=[],A=0;A<127;A++)_.controlChanges.hasOwnProperty(A)&&_.controlChanges[A].forEach(function(R){T.push(o(R,_.channel))});return T}function u(_,T){return{absoluteTime:_.ticks,channel:T,deltaTime:0,type:"pitchBend",value:_.value}}function f(_){var T=[];return _.pitchBends.forEach(function(A){T.push(u(A,_.channel))}),T}function h(_){return{absoluteTime:0,channel:_.channel,deltaTime:0,programNumber:_.instrument.number,type:"programChange"}}function d(_){return{absoluteTime:0,deltaTime:0,meta:!0,text:_,type:"trackName"}}function g(_){return{absoluteTime:_.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/_.bpm),type:"setTempo"}}function E(_){return{absoluteTime:_.ticks,deltaTime:0,denominator:_.timeSignature[1],meta:!0,metronome:24,numerator:_.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function M(_){var T=Mt.keySignatureKeys.indexOf(_.key);return{absoluteTime:_.ticks,deltaTime:0,key:T+7,meta:!0,scale:_.scale==="major"?0:1,type:"keySignature"}}function I(_){return{absoluteTime:_.ticks,deltaTime:0,meta:!0,text:_.text,type:_.type}}function v(_){var T={header:{format:1,numTracks:_.tracks.length+1,ticksPerBeat:_.header.ppq},tracks:n([n([{absoluteTime:0,deltaTime:0,meta:!0,text:_.header.name,type:"trackName"}],_.header.keySignatures.map(function(A){return M(A)}),_.header.meta.map(function(A){return I(A)}),_.header.tempos.map(function(A){return g(A)}),_.header.timeSignatures.map(function(A){return E(A)}))],_.tracks.map(function(A){return n([d(A.name),h(A)],r(A),a(A),f(A))}))};return T.tracks=T.tracks.map(function(A){A=A.sort(function(U,Z){return U.absoluteTime-Z.absoluteTime});var R=0;return A.forEach(function(U){U.deltaTime=U.absoluteTime-R,R=U.absoluteTime,delete U.absoluteTime}),A.push({deltaTime:0,meta:!0,type:"endOfTrack"}),A}),new Uint8Array(pn.writeMidi(T))}e.encode=v}),Be=z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},e.controlChangeIds=Object.keys(e.controlChangeNames).reduce(function(c,r){return c[e.controlChangeNames[r]]=r,c},{});var n=new WeakMap,i=new WeakMap,s=function(){function c(r,o){n.set(this,o),i.set(this,r.controllerType),this.ticks=r.absoluteTime,this.value=r.value}return Object.defineProperty(c.prototype,"number",{get:function(){return i.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"name",{get:function(){return e.controlChangeNames[this.number]?e.controlChangeNames[this.number]:null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"time",{get:function(){var r=n.get(this);return r.ticksToSeconds(this.ticks)},set:function(r){var o=n.get(this);this.ticks=o.secondsToTicks(r)},enumerable:!0,configurable:!0}),c.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},c}();e.ControlChange=s}),Ss=z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});function n(){return new Proxy({},{get:function(i,s){if(i[s])return i[s];if(Be.controlChangeIds.hasOwnProperty(s))return i[Be.controlChangeIds[s]]},set:function(i,s,c){return Be.controlChangeIds.hasOwnProperty(s)?i[Be.controlChangeIds[s]]=c:i[s]=c,!0}})}e.createControlChanges=n}),ws=z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=new WeakMap,i=function(){function s(c,r){n.set(this,r),this.ticks=c.absoluteTime,this.value=c.value}return Object.defineProperty(s.prototype,"time",{get:function(){var c=n.get(this);return c.ticksToSeconds(this.ticks)},set:function(c){var r=n.get(this);this.ticks=r.secondsToTicks(c)},enumerable:!0,configurable:!0}),s.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},s}();e.PitchBend=i}),At=z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],e.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],e.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}}),vn=z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=new WeakMap,i=function(){function s(c,r){if(this.number=0,n.set(this,r),this.number=0,c){var o=c.find(function(a){return a.type==="programChange"});o&&(this.number=o.programNumber)}}return Object.defineProperty(s.prototype,"name",{get:function(){return this.percussion?At.DrumKitByPatchID[this.number]:At.instrumentByPatchID[this.number]},set:function(c){var r=At.instrumentByPatchID.indexOf(c);r!==-1&&(this.number=r)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"family",{get:function(){return this.percussion?"drums":At.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"percussion",{get:function(){var c=n.get(this);return c.channel===9},enumerable:!0,configurable:!0}),s.prototype.toJSON=function(){return{family:this.family,name:this.name,number:this.number}},s.prototype.fromJSON=function(c){this.number=c.number},s}();e.Instrument=i}),Ms=z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});function n(a){var u=Math.floor(a/12)-1;return i(a)+u.toString()}function i(a){var u=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],f=a%12;return u[f]}function s(a){var u=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return u.indexOf(a)}var c=function(){var a=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,u={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(f){var h=a.exec(f),d=h[1],g=h[2],E=u[d.toLowerCase()];return E+(parseInt(g,10)+1)*12}}(),r=new WeakMap,o=function(){function a(u,f,h){r.set(this,h),this.midi=u.midi,this.velocity=u.velocity,this.noteOffVelocity=f.velocity,this.ticks=u.ticks,this.durationTicks=f.ticks-u.ticks}return Object.defineProperty(a.prototype,"name",{get:function(){return n(this.midi)},set:function(u){this.midi=c(u)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(u){var f=u-this.octave;this.midi+=f*12},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"pitch",{get:function(){return i(this.midi)},set:function(u){this.midi=12*(this.octave+1)+s(u)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"duration",{get:function(){var u=r.get(this);return u.ticksToSeconds(this.ticks+this.durationTicks)-u.ticksToSeconds(this.ticks)},set:function(u){var f=r.get(this),h=f.secondsToTicks(this.time+u);this.durationTicks=h-this.ticks},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"time",{get:function(){var u=r.get(this);return u.ticksToSeconds(this.ticks)},set:function(u){var f=r.get(this);this.ticks=f.secondsToTicks(u)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bars",{get:function(){var u=r.get(this);return u.ticksToMeasures(this.ticks)},enumerable:!0,configurable:!0}),a.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},a}();e.Note=o}),kt=z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=new WeakMap,i=function(){function s(c,r){var o=this;if(this.name="",this.notes=[],this.controlChanges=Ss.createControlChanges(),this.pitchBends=[],n.set(this,r),c){var a=c.find(function(I){return I.type==="trackName"});this.name=a?a.text:""}if(this.instrument=new vn.Instrument(c,this),this.channel=0,c){for(var u=c.filter(function(I){return I.type==="noteOn"}),f=c.filter(function(I){return I.type==="noteOff"}),h=function(){var I=u.shift();d.channel=I.channel;var v=f.findIndex(function(T){return T.noteNumber===I.noteNumber&&T.absoluteTime>=I.absoluteTime});if(v!==-1){var _=f.splice(v,1)[0];d.addNote({durationTicks:_.absoluteTime-I.absoluteTime,midi:I.noteNumber,noteOffVelocity:_.velocity/127,ticks:I.absoluteTime,velocity:I.velocity/127})}},d=this;u.length;)h();var g=c.filter(function(I){return I.type==="controller"});g.forEach(function(I){o.addCC({number:I.controllerType,ticks:I.absoluteTime,value:I.value/127})});var E=c.filter(function(I){return I.type==="pitchBend"});E.forEach(function(I){o.addPitchBend({ticks:I.absoluteTime,value:I.value/Math.pow(2,13)})});var M=c.find(function(I){return I.type==="endOfTrack"});this.endOfTrackTicks=M!==void 0?M.absoluteTime:void 0}}return s.prototype.addNote=function(c){var r=n.get(this),o=new Ms.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},r);return Object.assign(o,c),Ae.insert(this.notes,o,"ticks"),this},s.prototype.addCC=function(c){var r=n.get(this),o=new Be.ControlChange({controllerType:c.number},r);return delete c.number,Object.assign(o,c),Array.isArray(this.controlChanges[o.number])||(this.controlChanges[o.number]=[]),Ae.insert(this.controlChanges[o.number],o,"ticks"),this},s.prototype.addPitchBend=function(c){var r=n.get(this),o=new ws.PitchBend({},r);return Object.assign(o,c),Ae.insert(this.pitchBends,o,"ticks"),this},Object.defineProperty(s.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var c=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,r=0;r<this.notes.length-1;r++){var o=this.notes[r].time+this.notes[r].duration;c<o&&(c=o)}return c},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var c=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,r=0;r<this.notes.length-1;r++){var o=this.notes[r].ticks+this.notes[r].durationTicks;c<o&&(c=o)}return c},enumerable:!0,configurable:!0}),s.prototype.fromJSON=function(c){var r=this;this.name=c.name,this.channel=c.channel,this.instrument=new vn.Instrument(void 0,this),this.instrument.fromJSON(c.instrument),c.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=c.endOfTrackTicks);for(var o in c.controlChanges)c.controlChanges[o]&&c.controlChanges[o].forEach(function(a){r.addCC({number:a.number,ticks:a.ticks,value:a.value})});c.notes.forEach(function(a){r.addNote({durationTicks:a.durationTicks,midi:a.midi,ticks:a.ticks,velocity:a.velocity})})},s.prototype.toJSON=function(){for(var c={},r=0;r<127;r++)this.controlChanges.hasOwnProperty(r)&&(c[r]=this.controlChanges[r].map(function(a){return a.toJSON()}));var o={channel:this.channel,controlChanges:c,pitchBends:this.pitchBends.map(function(a){return a.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(a){return a.toJSON()})};return this.endOfTrackTicks!==void 0&&(o.endOfTrackTicks=this.endOfTrackTicks),o},s}();e.Track=i}),Ts=z(function(t,e){var n=J&&J.__awaiter||function(a,u,f,h){function d(g){return g instanceof f?g:new f(function(E){E(g)})}return new(f||(f=Promise))(function(g,E){function M(_){try{v(h.next(_))}catch(T){E(T)}}function I(_){try{v(h.throw(_))}catch(T){E(T)}}function v(_){_.done?g(_.value):d(_.value).then(M,I)}v((h=h.apply(a,u||[])).next())})},i=J&&J.__generator||function(a,u){var f={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},h,d,g,E;return E={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function M(v){return function(_){return I([v,_])}}function I(v){if(h)throw new TypeError("Generator is already executing.");for(;f;)try{if(h=1,d&&(g=v[0]&2?d.return:v[0]?d.throw||((g=d.return)&&g.call(d),0):d.next)&&!(g=g.call(d,v[1])).done)return g;switch(d=0,g&&(v=[v[0]&2,g.value]),v[0]){case 0:case 1:g=v;break;case 4:return f.label++,{value:v[1],done:!1};case 5:f.label++,d=v[1],v=[0];continue;case 7:v=f.ops.pop(),f.trys.pop();continue;default:if(g=f.trys,!(g=g.length>0&&g[g.length-1])&&(v[0]===6||v[0]===2)){f=0;continue}if(v[0]===3&&(!g||v[1]>g[0]&&v[1]<g[3])){f.label=v[1];break}if(v[0]===6&&f.label<g[1]){f.label=g[1],g=v;break}if(g&&f.label<g[2]){f.label=g[2],f.ops.push(v);break}g[2]&&f.ops.pop(),f.trys.pop();continue}v=u.call(a,f)}catch(_){v=[6,_],d=0}finally{h=g=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function a(u){var f=this,h=null;u&&(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),h=pn.parseMidi(u),h.tracks.forEach(function(d){var g=0;d.forEach(function(E){g+=E.deltaTime,E.absoluteTime=g})}),h.tracks=o(h.tracks)),this.header=new Mt.Header(h),this.tracks=[],u&&(this.tracks=h.tracks.map(function(d){return new kt.Track(d,f.header)}),h.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return a.fromUrl=function(u){return n(this,void 0,void 0,function(){var f,h;return i(this,function(d){switch(d.label){case 0:return[4,fetch(u)];case 1:return f=d.sent(),f.ok?[4,f.arrayBuffer()]:[3,3];case 2:return h=d.sent(),[2,new a(h)];case 3:throw new Error("could not load "+u)}})})},Object.defineProperty(a.prototype,"name",{get:function(){return this.header.name},set:function(u){this.header.name=u},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"duration",{get:function(){var u=this.tracks.map(function(f){return f.duration});return Math.max.apply(Math,u)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"durationTicks",{get:function(){var u=this.tracks.map(function(f){return f.durationTicks});return Math.max.apply(Math,u)},enumerable:!0,configurable:!0}),a.prototype.addTrack=function(){var u=new kt.Track(void 0,this.header);return this.tracks.push(u),u},a.prototype.toArray=function(){return Is.encode(this)},a.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(u){return u.toJSON()})}},a.prototype.fromJSON=function(u){var f=this;this.header=new Mt.Header,this.header.fromJSON(u.header),this.tracks=u.tracks.map(function(h){var d=new kt.Track(void 0,f.header);return d.fromJSON(h),d})},a.prototype.clone=function(){var u=new a;return u.fromJSON(this.toJSON()),u},a}();e.Midi=s;var c=kt;e.Track=c.Track;var r=Mt;e.Header=r.Header;function o(a){for(var u=[],f=0;f<a.length;f++)for(var h=u.length,d=new Map,g=Array(16).fill(0),E=0,M=a[f];E<M.length;E++){var I=M[E],v=h,_=I.channel;if(_!==void 0){I.type==="programChange"&&(g[_]=I.programNumber);var T=g[_],A=T+" "+_;d.has(A)?v=d.get(A):(v=h+d.size,d.set(A,v))}u[v]||u.push([]),u[v].push(I)}return u}}),En=Ts.Midi;var As=z(function(t,e){(function(n,i){t.exports=i()})(J,function(){function n(m,l,y){if(y||arguments.length===2)for(var p,b=0,S=l.length;b<S;b++)!p&&b in l||(p||(p=Array.prototype.slice.call(l,0,b)),p[b]=l[b]);return m.concat(p||l)}var i=Object.freeze({__proto__:null,blackman:function(m){for(var l=new Float32Array(m),y=2*Math.PI/(m-1),p=2*y,b=0;b<m/2;b++)l[b]=.42-.5*Math.cos(b*y)+.08*Math.cos(b*p);for(b=Math.ceil(m/2);b>0;b--)l[m-b]=l[b-1];return l},sine:function(m){for(var l=Math.PI/(m-1),y=new Float32Array(m),p=0;p<m;p++)y[p]=Math.sin(l*p);return y},hanning:function(m){for(var l=new Float32Array(m),y=0;y<m;y++)l[y]=.5-.5*Math.cos(2*Math.PI*y/(m-1));return l},hamming:function(m){for(var l=new Float32Array(m),y=0;y<m;y++)l[y]=.54-.46*Math.cos(2*Math.PI*(y/m-1));return l}}),s={};function c(m){for(;m%2==0&&m>1;)m/=2;return m===1}function r(m,l){if(l!=="rect"){if(l!==""&&l||(l="hanning"),s[l]||(s[l]={}),!s[l][m.length])try{s[l][m.length]=i[l](m.length)}catch(y){throw new Error("Invalid windowing function")}m=function(y,p){for(var b=[],S=0;S<Math.min(y.length,p.length);S++)b[S]=y[S]*p[S];return b}(m,s[l][m.length])}return m}function o(m,l,y){for(var p=new Float32Array(m),b=0;b<p.length;b++)p[b]=b*l/y,p[b]=13*Math.atan(p[b]/1315.8)+3.5*Math.atan(Math.pow(p[b]/7518,2));return p}function a(m){return Float32Array.from(m)}function u(m){return 1125*Math.log(1+m/700)}function f(m,l,y){for(var p,b=new Float32Array(m+2),S=new Float32Array(m+2),C=l/2,O=u(0),N=(u(C)-O)/(m+1),k=new Array(m+2),w=0;w<b.length;w++)b[w]=w*N,S[w]=(p=b[w],700*(Math.exp(p/1125)-1)),k[w]=Math.floor((y+1)*S[w]/l);for(var j=new Array(m),F=0;F<j.length;F++){for(j[F]=new Array(y/2+1).fill(0),w=k[F];w<k[F+1];w++)j[F][w]=(w-k[F])/(k[F+1]-k[F]);for(w=k[F+1];w<k[F+2];w++)j[F][w]=(k[F+2]-w)/(k[F+2]-k[F+1])}return j}function h(m,l,y,p,b,S,C){p===void 0&&(p=5),b===void 0&&(b=2),S===void 0&&(S=!0),C===void 0&&(C=440);var O=Math.floor(y/2)+1,N=new Array(y).fill(0).map(function(P,q){return m*function(Y,ae){return Math.log2(16*Y/ae)}(l*q/y,C)});N[0]=N[1]-1.5*m;var k,w,j,F=N.slice(1).map(function(P,q){return Math.max(P-N[q])},1).concat([1]),he=Math.round(m/2),de=new Array(m).fill(0).map(function(P,q){return N.map(function(Y){return(10*m+he+Y-q)%m-he})}),te=de.map(function(P,q){return P.map(function(Y,ae){return Math.exp(-.5*Math.pow(2*de[q][ae]/F[ae],2))})});if(w=(k=te)[0].map(function(){return 0}),j=k.reduce(function(P,q){return q.forEach(function(Y,ae){P[ae]+=Math.pow(Y,2)}),P},w).map(Math.sqrt),te=k.map(function(P,q){return P.map(function(Y,ae){return Y/(j[ae]||1)})}),b){var Ot=N.map(function(P){return Math.exp(-.5*Math.pow((P/m-p)/b,2))});te=te.map(function(P){return P.map(function(q,Y){return q*Ot[Y]})})}return S&&(te=n(n([],te.slice(3)),te.slice(0,3))),te.map(function(P){return P.slice(0,O)})}function d(m,l){for(var y=0,p=0,b=0;b<l.length;b++)y+=Math.pow(b,m)*Math.abs(l[b]),p+=l[b];return y/p}function g(m){var l=m.ampSpectrum,y=m.barkScale;if(typeof l!="object"||typeof y!="object")throw new TypeError;var p=24,b=new Float32Array(p),S=0,C=l,O=new Int32Array(25);O[0]=0;for(var N=y[C.length-1]/p,k=1,w=0;w<C.length;w++)for(;y[w]>N;)O[k++]=w,N=k*y[C.length-1]/p;for(O[24]=C.length-1,w=0;w<p;w++){for(var j=0,F=O[w];F<O[w+1];F++)j+=C[F];b[w]=Math.pow(j,.23)}for(w=0;w<b.length;w++)S+=b[w];return{specific:b,total:S}}function E(m){var l=m.ampSpectrum;if(typeof l!="object")throw new TypeError;for(var y=new Float32Array(l.length),p=0;p<y.length;p++)y[p]=Math.pow(l[p],2);return y}var M=null,I=function(m,l){var y=m.length;return l=l||2,M&&M[y]||function(p){(M=M||{})[p]=new Array(p*p);for(var b=Math.PI/p,S=0;S<p;S++)for(var C=0;C<p;C++)M[p][C+S*p]=Math.cos(b*(C+.5)*S)}(y),m.map(function(){return 0}).map(function(p,b){return l*m.reduce(function(S,C,O,N){return S+C*M[y][O+b*y]},0)})},v=Object.freeze({__proto__:null,buffer:function(m){return m.signal},rms:function(m){var l=m.signal;if(typeof l!="object")throw new TypeError;for(var y=0,p=0;p<l.length;p++)y+=Math.pow(l[p],2);return y/=l.length,y=Math.sqrt(y)},energy:function(m){var l=m.signal;if(typeof l!="object")throw new TypeError;for(var y=0,p=0;p<l.length;p++)y+=Math.pow(Math.abs(l[p]),2);return y},complexSpectrum:function(m){return m.complexSpectrum},spectralSlope:function(m){var l=m.ampSpectrum,y=m.sampleRate,p=m.bufferSize;if(typeof l!="object")throw new TypeError;for(var b=0,S=0,C=new Float32Array(l.length),O=0,N=0,k=0;k<l.length;k++){b+=l[k];var w=k*y/p;C[k]=w,O+=w*w,S+=w,N+=w*l[k]}return(l.length*N-S*b)/(b*(O-Math.pow(S,2)))},spectralCentroid:function(m){var l=m.ampSpectrum;if(typeof l!="object")throw new TypeError;return d(1,l)},spectralRolloff:function(m){var l=m.ampSpectrum,y=m.sampleRate;if(typeof l!="object")throw new TypeError;for(var p=l,b=y/(2*(p.length-1)),S=0,C=0;C<p.length;C++)S+=p[C];for(var O=.99*S,N=p.length-1;S>O&&N>=0;)S-=p[N],--N;return(N+1)*b},spectralFlatness:function(m){var l=m.ampSpectrum;if(typeof l!="object")throw new TypeError;for(var y=0,p=0,b=0;b<l.length;b++)y+=Math.log(l[b]),p+=l[b];return Math.exp(y/l.length)*l.length/p},spectralSpread:function(m){var l=m.ampSpectrum;if(typeof l!="object")throw new TypeError;return Math.sqrt(d(2,l)-Math.pow(d(1,l),2))},spectralSkewness:function(m){var l=m.ampSpectrum;if(typeof l!="object")throw new TypeError;var y=d(1,l),p=d(2,l),b=d(3,l);return(2*Math.pow(y,3)-3*y*p+b)/Math.pow(Math.sqrt(p-Math.pow(y,2)),3)},spectralKurtosis:function(m){var l=m.ampSpectrum;if(typeof l!="object")throw new TypeError;var y=l,p=d(1,y),b=d(2,y),S=d(3,y),C=d(4,y);return(-3*Math.pow(p,4)+6*p*b-4*p*S+C)/Math.pow(Math.sqrt(b-Math.pow(p,2)),4)},amplitudeSpectrum:function(m){return m.ampSpectrum},zcr:function(m){var l=m.signal;if(typeof l!="object")throw new TypeError;for(var y=0,p=1;p<l.length;p++)(l[p-1]>=0&&l[p]<0||l[p-1]<0&&l[p]>=0)&&y++;return y},loudness:g,perceptualSpread:function(m){for(var l=g({ampSpectrum:m.ampSpectrum,barkScale:m.barkScale}),y=0,p=0;p<l.specific.length;p++)l.specific[p]>y&&(y=l.specific[p]);return Math.pow((l.total-y)/l.total,2)},perceptualSharpness:function(m){for(var l=g({ampSpectrum:m.ampSpectrum,barkScale:m.barkScale}),y=l.specific,p=0,b=0;b<y.length;b++)p+=b<15?(b+1)*y[b+1]:.066*Math.exp(.171*(b+1));return p*=.11/l.total},powerSpectrum:E,mfcc:function(m){var l=m.ampSpectrum,y=m.melFilterBank,p=m.numberOfMFCCCoefficients,b=m.bufferSize;if(typeof l!="object")throw new TypeError("Valid ampSpectrum is required to generate MFCC");if(typeof y!="object")throw new TypeError("Valid melFilterBank is required to generate MFCC");var S=Math.min(40,Math.max(1,p||13)),C=E({ampSpectrum:l}),O=y.length,N=Array(O);if(O<S)throw new Error("Insufficient filter bank for requested number of coefficients");for(var k=new Float32Array(O),w=0;w<k.length;w++){N[w]=new Float32Array(b/2),k[w]=0;for(var j=0;j<b/2;j++)N[w][j]=y[w][j]*C[j],k[w]+=N[w][j];k[w]=Math.log(k[w]+1)}var F=Array.prototype.slice.call(k);return I(F).slice(0,S)},chroma:function(m){var l=m.ampSpectrum,y=m.chromaFilterBank;if(typeof l!="object")throw new TypeError("Valid ampSpectrum is required to generate chroma");if(typeof y!="object")throw new TypeError("Valid chromaFilterBank is required to generate chroma");var p=y.map(function(S,C){return l.reduce(function(O,N,k){return O+N*S[k]},0)}),b=Math.max.apply(Math,p);return b?p.map(function(S){return S/b}):p},spectralFlux:function(m){var l=m.signal,y=m.previousSignal,p=m.bufferSize;if(typeof l!="object"||typeof y!="object")throw new TypeError;for(var b=0,S=-p/2;S<l.length/2-1;S++)x=Math.abs(l[S])-Math.abs(y[S]),b+=(x+Math.abs(x))/2;return b}});function _(m){if(Array.isArray(m)){for(var l=0,y=Array(m.length);l<m.length;l++)y[l]=m[l];return y}return Array.from(m)}var T={},A={},R={bitReverseArray:function(m){if(T[m]===void 0){for(var l=(m-1).toString(2).length,y="0".repeat(l),p={},b=0;b<m;b++){var S=b.toString(2);S=y.substr(S.length)+S,S=[].concat(_(S)).reverse().join(""),p[b]=parseInt(S,2)}T[m]=p}return T[m]},multiply:function(m,l){return{real:m.real*l.real-m.imag*l.imag,imag:m.real*l.imag+m.imag*l.real}},add:function(m,l){return{real:m.real+l.real,imag:m.imag+l.imag}},subtract:function(m,l){return{real:m.real-l.real,imag:m.imag-l.imag}},euler:function(m,l){var y=-2*Math.PI*m/l;return{real:Math.cos(y),imag:Math.sin(y)}},conj:function(m){return m.imag*=-1,m},constructComplexArray:function(m){var l={};l.real=m.real===void 0?m.slice():m.real.slice();var y=l.real.length;return A[y]===void 0&&(A[y]=Array.apply(null,Array(y)).map(Number.prototype.valueOf,0)),l.imag=A[y].slice(),l}},U=function(m){var l={};m.real===void 0||m.imag===void 0?l=R.constructComplexArray(m):(l.real=m.real.slice(),l.imag=m.imag.slice());var y=l.real.length,p=Math.log2(y);if(Math.round(p)!=p)throw new Error("Input size must be a power of 2.");if(l.real.length!=l.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var b=R.bitReverseArray(y),S={real:[],imag:[]},C=0;C<y;C++)S.real[b[C]]=l.real[C],S.imag[b[C]]=l.imag[C];for(var O=0;O<y;O++)l.real[O]=S.real[O],l.imag[O]=S.imag[O];for(var N=1;N<=p;N++)for(var k=Math.pow(2,N),w=0;w<k/2;w++)for(var j=R.euler(w,k),F=0;F<y/k;F++){var he=k*F+w,de=k*F+w+k/2,te={real:l.real[he],imag:l.imag[he]},Ot={real:l.real[de],imag:l.imag[de]},P=R.multiply(j,Ot),q=R.subtract(te,P);l.real[de]=q.real,l.imag[de]=q.imag;var Y=R.add(P,te);l.real[he]=Y.real,l.imag[he]=Y.imag}return l},Z=U,oe=function(){function m(l,y){var p=this;if(this._m=y,!l.audioContext)throw this._m.errors.noAC;if(l.bufferSize&&!c(l.bufferSize))throw this._m._errors.notPow2;if(!l.source)throw this._m._errors.noSource;this._m.audioContext=l.audioContext,this._m.bufferSize=l.bufferSize||this._m.bufferSize||256,this._m.hopSize=l.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=l.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=l.callback,this._m.windowingFunction=l.windowingFunction||"hanning",this._m.featureExtractors=v,this._m.EXTRACTION_STARTED=l.startImmediately||!1,this._m.channel=typeof l.channel=="number"?l.channel:0,this._m.inputs=l.inputs||1,this._m.outputs=l.outputs||1,this._m.numberOfMFCCCoefficients=l.numberOfMFCCCoefficients||this._m.numberOfMFCCCoefficients||13,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,this._m.inputs,this._m.outputs),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=l.featureExtractors||[],this._m.barkScale=o(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=f(Math.max(this._m.melBands,this._m.numberOfMFCCCoefficients),this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(l.source),this._m.spn.onaudioprocess=function(b){var S;p._m.inputData!==null&&(p._m.previousInputData=p._m.inputData),p._m.inputData=b.inputBuffer.getChannelData(p._m.channel),p._m.previousInputData?((S=new Float32Array(p._m.previousInputData.length+p._m.inputData.length-p._m.hopSize)).set(p._m.previousInputData.slice(p._m.hopSize)),S.set(p._m.inputData,p._m.previousInputData.length-p._m.hopSize)):S=p._m.inputData,function(C,O,N){if(C.length<O)throw new Error("Buffer is too short for frame length");if(N<1)throw new Error("Hop length cannot be less that 1");if(O<1)throw new Error("Frame length cannot be less that 1");var k=1+Math.floor((C.length-O)/N);return new Array(k).fill(0).map(function(w,j){return C.slice(j*N,j*N+O)})}(S,p._m.bufferSize,p._m.hopSize).forEach(function(C){p._m.frame=C;var O=p._m.extract(p._m._featuresToExtract,p._m.frame,p._m.previousFrame);typeof p._m.callback=="function"&&p._m.EXTRACTION_STARTED&&p._m.callback(O),p._m.previousFrame=p._m.frame})}}return m.prototype.start=function(l){this._m._featuresToExtract=l||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0},m.prototype.stop=function(){this._m.EXTRACTION_STARTED=!1},m.prototype.setSource=function(l){this._m.source&&this._m.source.disconnect(this._m.spn),this._m.source=l,this._m.source.connect(this._m.spn)},m.prototype.setChannel=function(l){l<=this._m.inputs?this._m.channel=l:console.error("Channel "+l+" does not exist. Make sure you've provided a value for 'inputs' that is greater than "+l+" when instantiating the MeydaAnalyzer")},m.prototype.get=function(l){return this._m.inputData?this._m.extract(l||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null},m}(),B={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:v,EXTRACTION_STARTED:!1,numberOfMFCCCoefficients:13,_featuresToExtract:[],windowing:r,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(m){return new oe(m,Object.assign({},B))},listAvailableFeatureExtractors:function(){return Object.keys(this.featureExtractors)},extract:function(m,l,y){var p=this;if(!l)throw this._errors.invalidInput;if(typeof l!="object")throw this._errors.invalidInput;if(!m)throw this._errors.featureUndef;if(!c(l.length))throw this._errors.notPow2;this.barkScale!==void 0&&this.barkScale.length==this.bufferSize||(this.barkScale=o(this.bufferSize,this.sampleRate,this.bufferSize)),this.melFilterBank!==void 0&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=f(Math.max(this.melBands,this.numberOfMFCCCoefficients),this.sampleRate,this.bufferSize)),this.chromaFilterBank!==void 0&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=h(this.chromaBands,this.sampleRate,this.bufferSize)),l.buffer===void 0?this.signal=a(l):this.signal=l;var b=ee(l,this.windowingFunction,this.bufferSize);if(this.signal=b.windowedSignal,this.complexSpectrum=b.complexSpectrum,this.ampSpectrum=b.ampSpectrum,y){var S=ee(y,this.windowingFunction,this.bufferSize);this.previousSignal=S.windowedSignal,this.previousComplexSpectrum=S.complexSpectrum,this.previousAmpSpectrum=S.ampSpectrum}var C=function(O){return p.featureExtractors[O]({ampSpectrum:p.ampSpectrum,chromaFilterBank:p.chromaFilterBank,complexSpectrum:p.complexSpectrum,signal:p.signal,bufferSize:p.bufferSize,sampleRate:p.sampleRate,barkScale:p.barkScale,melFilterBank:p.melFilterBank,previousSignal:p.previousSignal,previousAmpSpectrum:p.previousAmpSpectrum,previousComplexSpectrum:p.previousComplexSpectrum,numberOfMFCCCoefficients:p.numberOfMFCCCoefficients})};if(typeof m=="object")return m.reduce(function(O,N){var k;return Object.assign({},O,((k={})[N]=C(N),k))},{});if(typeof m=="string")return C(m);throw this._errors.invalidFeatureFmt}},ee=function(m,l,y){var p={};m.buffer===void 0?p.signal=a(m):p.signal=m,p.windowedSignal=r(p.signal,l),p.complexSpectrum=Z(p.windowedSignal),p.ampSpectrum=new Float32Array(y/2);for(var b=0;b<y/2;b++)p.ampSpectrum[b]=Math.sqrt(Math.pow(p.complexSpectrum.real[b],2)+Math.pow(p.complexSpectrum.imag[b],2));return p};return typeof window!="undefined"&&(window.Meyda=B),B})}),In=As;var ks=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],xs=V(D(t=>hn(t)),L(),ks),Sn=V(at({raw:D(t=>t),tonicMidi:D(t=>wt(t.tonic+"2")%12),majorKey:D(t=>t.tonic),minorKey:D(t=>mn(t.minorRelative).toLowerCase()),normalizedMidis:D(t=>V(D(e=>wt(e+"2")%12),L(),t.scale))}),L(),xs),wn=t=>{let e=V(Pe(D(s=>t[s]?s:null),st(s=>s!==null)),L(),Yt(12)),n=V(Pe(D(s=>er(new Set(s.normalizedMidis),new Set(e))),D(s=>Array.from(s))),L(),Sn),i=V(at({majorKey:D(s=>s[0].majorKey),minorKey:D(s=>s[0].minorKey),normalizedMidis:D(s=>s[0].normalizedMidis),common:D(s=>s[1]),similarity:D(s=>s[1].length/e.length+(e.includes(s[0].tonicMidi)?.1:0))}),L(),Lr(Sn,n));return i=i.sort((s,c)=>c.similarity-s.similarity),i},ke=[...zr(!1,12)],su=[...Me(12,ct([!0,!1],[.5,.5]))],Mn=t=>{let n=new En(t).tracks;n.sort((c,r)=>r.notes.length-c.notes.length);let i=n[0],s=V(D(c=>c[0]%12),L(),Me(7,Zt(i.notes.map(c=>c.midi))));return Array.from(new Set(s))},Cs=()=>{try{return new AudioContext}catch{return new window.webkitAudioContext}},Os=async(t,e)=>{try{return await t.decodeAudioData(e)}catch{return new Promise((n,i)=>{t.decodeAudioData(e,n,i)})}},Ns=t=>Math.pow(2,Math.round(Math.log(t)/Math.log(2))),Tn=async t=>{let e=1,n=Cs(),i=await Os(n,t),s=i.getChannelData(0),c=Ns(i.sampleRate/e),r=Math.floor(s.length/c),o=V(D(u=>In.extract("chroma",s.slice(u*c,(u+1)*c))),L(),Yt(r)),a=V(D(u=>u.indexOf(1)),L(),o);return V(D(u=>u[0]),L(),V(D(u=>u),L(),Zt(a)).sort((u,f)=>f[1]-u[1])).slice(0,7)};var Ds=(t,e)=>{let i=t.views.viewConfig.deref();return["div.flex",["div",e.majorKey,i.showSmall?["small"," maj"]:[]],i.showMinor?["div",["span.text-red-600","  "],e.minorKey,i.showSmall?["small"," min"]:[]]:[]]},Fs=(t,e)=>{let i=t.views.size.deref(),s=Math.min(400*1.1,i[0]*.9),c=.1,r=35,o={width:s,height:s/r,rx:5,fill:"#e2e2e2"};return["div",["svg",{width:s*(1+c),height:s/r},["g",["rect",o],e.common.length>0?["rect",{...o,width:(e.similarity-c)*s,fill:"#000"}]:[]]]]},An=t=>{let e=t.views,n=t.ui,i=wn(e.keyState.deref());return["div",n.keyGroup.root,...i.map((s,c)=>["div",{...n.keyGroup.block,onmouseover:r=>{r.preventDefault(),t.bus.dispatch([Ge,s.normalizedMidis])},onmouseleave:r=>{r.preventDefault(),t.bus.dispatch([ht])}},[Ds,s],[Fs,s]])]};var xt=t=>{t.preventDefault()},js=(t,e)=>{xt(e);let n=e.dataTransfer.files;if(n&&n.length>0){let i=new FileReader,s=n[0];i.onload=async c=>{if(s.type==="audio/midi"){t.dispatch([le,s.name]);let r=Mn(c.target.result);t.dispatch([_e,ke.map((o,a)=>!!r.includes(a))])}else if(s.type==="audio/aac"||s.type==="audio/mpeg"||s.type==="audio/wav"){t.dispatch([le,s.name]);let r=await Tn(c.target.result);t.dispatch([_e,ke.map((o,a)=>!!r.includes(a))])}else t.dispatch([gt])},i.readAsArrayBuffer(s)}},kn=t=>{let e=t.bus,n=t.views,i=t.ui.fileDropZone,s=n.midiFile.deref(),c=n.size.deref(),r=Math.min(400*1.1,c[0]*.9);return["div",{...i.root,ondrop:o=>{o.target.classList.remove("nm-inset-gray-200-sm"),js(e,o)},ondragenter:o=>{o.target.classList.add("nm-inset-gray-200-sm"),xt(o)},ondragleave:o=>{o.target.classList.remove("nm-inset-gray-200-sm"),xt(o)},ondragover:o=>xt(o),style:{width:`${r}px`}},s]};var Rs={w:16,h:8,pad:2,margin:0},Ps=Fr({...Rs,vertical:!1}),xn=t=>{let e=t.views,n=t.ui.viewConfigToggleGroup,i=e.viewConfig.deref();return["div",Object.entries(i).map(([s,c])=>["div",n.block,[Ps,{onclick:()=>t.bus.dispatch([mt,s])},c],["span",n.caption,s]])]};var Gs=Dr({element:"h2",attribs:{class:"text-2xl font-extrabold mb-4"}}),Cn=t=>()=>["div",[Gs,"OP-Z KEY FINDER"],["div.pb-4",Kr],["div.pb-4",Qr],["div.mb-4",[Zr],[An]],[kn],["div.block",["details",["summary","View Config"],[xn]]]];var Ct={id:"home",match:["home"]};var On={router:{useFragment:!0,defaultRouteID:Ct.id,routes:[Ct]},events:{[ut]:Cr("debug",t=>t^1),[be]:[(t,[e,n])=>({[$]:[je,["keyState",n]]})],[_e]:[(t,[e,n])=>({[$]:[fe,["keyState",n]]})],[ft]:[()=>({[$]:[_e,ke]})],[lt]:[()=>({[$]:[_e,[...Me(12,ct([!0,!1],[.5,.5]))]]})],[Ge]:[(t,[e,n])=>({[$]:[fe,["highlights",n]]})],[ht]:[()=>({[$]:[Ge,[]]})],[dt]:[()=>({[$]:[fe,["size",[window.innerWidth,window.innerHeight]]]})],[mt]:[(t,[e,n])=>({[$]:[je,["viewConfig",n]]})],[pt]:[(t,[e,n])=>({[$]:[[je,"enabledMidi"],[fe,["midiDevices",n]]]})],[le]:[(t,[e,n])=>({[$]:[[fe,["midiFile",n]]]})],[gt]:[()=>({[$]:[le,"INVALID MIDI FILE..."],[Ht]:[Bt,[500,"DROP MIDI/AUDIO FILE HERE..."],le,le]})],[$r]:[(t,[e,n])=>({[$]:[[fe,["comparison",n]]]})]},effects:{},components:{[Ct.id]:Cn},domRoot:"app",initialState:{enabledMidi:!1,midiDevices:[],midiFile:"DROP MIDI/AUDIO FILE HERE...",keyState:ke,highlights:[],size:[window.innerWidth,window.innerHeight],viewConfig:{showMinor:!0,showSmall:!0},route:{},debug:1},views:{enabledMidi:"enabledMidi",midiDevices:"midiDevices",midiFile:"midiFile",keyState:"keyState",highlights:"highlights",size:"size",viewConfig:"viewConfig",json:["",t=>JSON.stringify(t,null,2)],debug:"debug"},ui:{root:{class:"clearfix flex flex-row font-sans m-0"},midiDevicesStatus:{content:[{class:"gray-500 p-1 bg-red-200 rounded-full"},{class:"gray-500 p-1 bg-green-200 rounded-full"}],dropdown:{root:{class:"ml-2 rounded-full nm-flat-gray-200 p-2 font-medium uppercase"},selection:{class:"bg-transparent font-medium uppercase"}}},toolbar:{root:{class:"my-4"},button:{class:"cursor-pointer mr-3 px-8 py-2 text-md font-medium nm-flat-gray-200 hover:nm-flat-gray-200-lg active:nm-inset-gray-200-sm rounded-full uppercase transition duration-200 ease-in-out transform"}},toggleGroup:{root:{class:""},key:{major:{class:"inline-block cursor-pointer nm-flat-gray-200 hover:nm-flat-gray-200-lg active:nm-inset-gray-200-lg rounded-full"},e:{class:"inline-block cursor-pointer nm-flat-gray-200 hover:nm-flat-gray-200-lg active:nm-inset-gray-200-lg rounded-full mr-8"},minor:{class:"inline-block cursor-pointer nm-flat-gray-200 hover:nm-flat-gray-200-lg active:nm-inset-gray-200-lg rounded-full mb-8"}}},keyGroup:{root:{class:"inline-block"},block:{class:"my-2 mr-2"}},fileDropZone:{root:{class:"mt-2 mb-8 border-dotted border-2 inline-block p-8 text-center font-medium nm-flat-gray-200-lg"}},code:{class:"m-0 ml-8 p-2 text-xs bg-gray-100 font-mono overflow-x-hidden"},column:{content:[{class:"float-left w-full m-4"},{class:"float-left w-5/6 m-4"}],debug:[{class:"float-right m-4 close"},{class:"float-right m-4 open"}]},debugToggle:{class:"toggle cursor-pointer tracking-wider"},viewConfigToggleGroup:{block:{class:"cursor-pointer my-2 flex justify-start items-center"},caption:{class:"ml-2"}}}};new Jt(On).start();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
//# sourceMappingURL=index.js.map
