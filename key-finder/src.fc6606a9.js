parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function J(a){return a&&a.__esModule?{d:a.default}:{d:a}}var rb={};const l=Symbol();const R=()=>{};const pa=void 0===rb?(r,$="assertion failed")=>{if("function"==typeof r&&!r()||!r)throw new Error("function"==typeof $?$():$)}:R;let O,B;const Na=Object.getPrototypeOf({}),k=(e,t)=>{let $;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=($=Object.getPrototypeOf(e))&&$!==Na||null!=($=Object.getPrototypeOf(t))&&$!==Na?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?Ra(e,t):e instanceof Set&&t instanceof Set?Sa(e,t):e instanceof Map&&t instanceof Map?_(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:aa(e,t)))};const Ra=(e,t,$=k)=>{let o=e.length;if(o===t.length)for(;--o>=0&&$(e[o],t[o]););return o<0};const Sa=(e,t,$=k)=>e.size===t.size&&$([...e.keys()].sort(),[...t.keys()].sort());const _=(e,t,$=k)=>e.size===t.size&&$([...e].sort(),[...t].sort());const aa=(e,t,$=k)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let o in e)if(!t.hasOwnProperty(o)||!$(e[o],t[o]))return!1;return!0};let sb=[],Pb=[];const Sb=r=>O&&O.length>=r?O:O=new Int32Array(r),Wb=r=>B&&B.length>=r?B:B=new Int32Array(r),oa=(r,$,e,a,t)=>{const c=$.length,l=r.linear;if(r.distance=c,0!==t){for(let r=0,e=0;r<c;r++,e+=3)l[e]=a,l[e+1]=r,l[e+2]=$[r];if(3===t){const a=r[e];for(let r=0;r<c;r++)a[r]=$[r]}}return r},_c=(r,$,e=3,a=k)=>{const t={distance:0,adds:{},dels:{},const:{},linear:[]};if(r===$||null==r&&null==$)return t;if(null==r||0===r.length)return oa(t,$,"adds",1,e);if(null==$||0===$.length)return oa(t,r,"dels",-1,e);const c=r.length>=$.length;let l,n,h,s;c?(l=$,n=r):(l=r,n=$),h=l.length,s=n.length;const d=h+1,o=s-h,i=o+d,z=h+s+3,J=Wb(z).fill(-1,0,z),f=Sb(z).fill(-1,0,z),v=sb,u=Pb;v.length=0,u.length=0;const P=(r,$,e)=>{const t=r+d;let c,o;$>e?(c=J[t-1],o=$):(c=J[t+1],o=e);let i=o-r;for(;i<h&&o<s&&a(l[i],n[o]);)i++,o++;return J[t]=u.length/3,u.push(i,o,c),o};let g,p,_=-1;do{for(p=(g=-++_)+d;g<o;g++,p++)f[p]=P(g,f[p-1]+1,f[p+1]);for(p=(g=o+_)+d;g>o;g--,p--)f[p]=P(g,f[p-1]+1,f[p+1]);f[i]=P(o,f[i-1]+1,f[i+1])}while(f[i]!==s);if(t.distance=o+2*_,0!==e){for(_=3*J[i];_>=0;)v.push(_),_=3*u[_+2];3===e?dd(v,u,t,l,n,c):id(v,u,t,l,n,c,1===e)}return t};const dd=(r,$,e,a,t,c)=>{const l=e.linear,n=e.const;let h,s,d,o,i=r.length,z=0,J=0;for(c?(h=e.dels,s=e.adds,d=-1,o=1):(h=e.adds,s=e.dels,d=1,o=-1);--i>=0;){const e=r[i],c=$[e],f=$[e+1],v=f-c;for(;z<c||J<f;){const r=J-z;v>r?(l.push(d,J,h[J]=t[J]),J++):v<r?(l.push(o,z,s[z]=a[z]),z++):(l.push(0,z,n[z]=a[z]),z++,J++)}}},id=(r,$,e,a,t,c,l)=>{const n=e.linear,h=c?-1:1,s=c?1:-1;let d=r.length,o=0,i=0;for(;--d>=0;){const e=r[d],c=$[e],z=$[e+1],J=z-c;for(;o<c||i<z;){const r=i-o;J>r?(n.push(h,i,t[i]),i++):J<r?(n.push(s,o,a[o]),o++):(l&&n.push(0,o,a[o]),o++,i++)}}};const xd=(t,e,$=3,i=k)=>t===e?{distance:0}:0===$?bb(t,e,i):ob(t,e,i);const bb=(t,e,$)=>{t||(t={}),e||(e={});let i=0;for(let r in t){const f=e[r];(void 0===f||!$(t[r],f))&&i++}for(let r in e)!(r in t)&&i++;return{distance:i}},ob=(t,e,$)=>{t||(t={}),e||(e={});let i=0;const r=[],f=[],s=[];for(let n in t){const r=e[n];void 0===r?(f.push(n),i++):$(t[n],r)||(s.push(n,r),i++)}for(let n in e)n in t||(r.push(n),i++);return{distance:i,adds:r,dels:f,edits:s}};const x=Array.isArray,Gb=Math.max,za=Object.getPrototypeOf({}),Ba=(()=>{const e=new Array(2048);for(let t=2,r=e.length;t<r;t++)e[t]=t-2;return e})(),Ub=e=>{if(e<=Ba.length)return Ba.slice(0,e);const t=new Array(e);for(;--e>=2;)t[e]=e-2;return t},Da=(e,t,r,$,i,o=0)=>{const n=i[1];if(n.__skip)return;if(!1===n.__diff)return m($),void t.replaceChild(e,r,o,i);const f=$[1];if(f&&f.__skip)return void t.replaceChild(e,r,o,i,!1);let s=n.__impl;if(s&&s!==t)return s.diffTree(e,s,r,$,i,o);const a=_c($,i,1,q);if(0===a.distance)return;const h=a.linear,T=t.getChild(r,o);let l,p,v,K;if(0!==h[0]||$[1].key!==n.key)return m($),void t.replaceChild(e,r,o,i);if((K=$.__release)&&K!==i.__release&&m($),0!==h[3]&&(mc(t,T,$[1],i[1]),2===a.distance))return;const Q=h.length,d=$.length-1,u=Lc(h),c=Ub(d+1);for(l=2,p=6;p<Q;l++,p+=3)(v=h[p])&&(-1===v?Xb(e,t,T,$,i,h,p,u,c,d):$b(e,t,T,h,p,u,c,d));(K=i.__init)&&K!=$.__init&&K.apply(i,[T,...i.__args])};const Xb=(e,t,r,$,i,o,n,f,s,a)=>{const h=o[n+2];if(x(h)){let T=h[1].key;if(void 0!==T&&void 0!==f[T][2]){const o=f[T];T=o[0],Da(e,t,r,$[T],i[o[2]],s[T])}else{const e=o[n+1];m(h),t.removeChild(r,s[e]),ac(s,a,e)}}else"string"==typeof h&&t.setContent(r,"")},$b=(e,t,r,$,i,o,n,f)=>{const s=$[i+2];if("string"==typeof s)t.setContent(r,s);else if(x(s)){const a=s[1].key;if(void 0===a||void 0===o[a][0]){const o=$[i+1];t.createTree(e,r,s,n[o]),ec(n,f,o)}}},ac=(e,t,r)=>{for(;t>r;t--)e[t]=Gb(e[t]-1,0)},ec=(e,t,r)=>{for(;t>=r;t--)e[t]++},mc=(e,t,r,$)=>{const i=xd(r,$,3,k);e.removeAttribs(t,i.dels,r);let o,n,f,s=l;for(o=(f=i.edits).length;(o-=2)>=0;)0===(n=f[o]).indexOf("on")&&e.removeAttribs(t,[n],r),"value"!==n?e.setAttrib(t,n,f[o+1],$):s=f[o+1];for(o=(f=i.adds).length;--o>=0;)"value"!==(n=f[o])?e.setAttrib(t,n,$[n],$):s=$[n];s!==l&&e.setAttrib(t,"value",s,$)};const m=e=>{if(x(e)){let t;if((t=e[1])&&!1===t.__release)return;for(e.__release&&(e.__release.apply(e.__this,e.__args),delete e.__release),t=e.length;--t>=2;)m(e[t])}};const Lc=e=>{let t,r,$;const i={};for(let o=e.length;(o-=3)>=0;)r=e[o+2],x(r)&&void 0!==(t=r[1].key)&&(!($=i[t])&&(i[t]=$=[,,]),$[e[o]+1]=e[o+1]);return i},q=(e,t)=>{let r;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=(r=Object.getPrototypeOf(e))&&r!==za||null!=(r=Object.getPrototypeOf(t))&&r!==za?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?Ra(e,t,q):e instanceof Set&&t instanceof Set?Sa(e,t,q):e instanceof Map&&t instanceof Map?_(e,t,q):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:!(!1===e.__diff||!1===t.__diff)&&aa(e,t,q)))};const cd=o=>"function"==typeof o;const A=(n,t)=>null!=n&&"function"==typeof n[t];const t=Array.isArray;const ld=t=>null!=t&&"function"!=typeof t&&void 0!==t.length;const od=t=>"string"==typeof t;const td=e=>null!=e&&"function"==typeof e[Symbol.iterator];const wd=$=>$ instanceof Map;const Ua=t=>null!=t&&"string"!=typeof t&&"function"==typeof t[Symbol.iterator];const Va=Object.getPrototypeOf,cb=$=>{let r;return null!=$&&"object"==typeof $&&(null===(r=Va($))||null===Va(r))};const db=t=>t instanceof Set;const fb="http://www.w3.org/2000/svg";const gb={"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&apos;"};const lb=/^([^\s\.#]+)(?:#([^\s\.#]+))?(?:\.([^\s#]+))?$/;const Hd=new RegExp(`[${Object.keys(gb).join("")}]`,"g");const qb={button:1,option:1,text:1,textarea:1};const _a=e=>e.split(" ").reduce((e,t)=>(e[t]=!0,e),{}),ub=_a("animate animateColor animateMotion animateTransform circle clipPath color-profile defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font foreignObject g image line linearGradient marker mask metadata mpath path pattern polygon polyline radialGradient rect set stop style svg switch symbol text textPath title tref tspan use view");const Gd=_a("area base br circle col command ellipse embed hr img input keygen line link meta param path polygon polyline rect source stop track use wbr ?xml");const xb=t=>{let $,r="";for(let e in t)$=t[e],cd($)&&($=$(t)),null!=$&&(r+=`${e}:${$};`);return r};const yb=(e,t)=>{if(null==e||!t||!t.length)return e;const r=Object.assign({},e);for(let n of t){const e=r[n];A(e,"deref")&&(r[n]=e.deref())}return r};const W=(r,o=r=>void 0!==r?": "+r:"")=>class extends Error{constructor(s){super(r(s)+o(s))}};const Mb=W(()=>"illegal argument(s)");const X=r=>{throw new Mb(r)};const Rb=W(()=>"illegal arity");const E=r=>{throw new Rb(r)};const w=t,da=Ua,ja=(e,t)=>t.__init&&t.__init.apply(t.__this,[e,...t.__args]),v=(e,t,r,s,$,n=!0)=>{if(w(s)){const o=s[0];if("function"==typeof o)return v(e,t,r,o.apply(null,[e.ctx,...s.slice(1)]),$);const a=s[1];if(a.__impl)return a.__impl.createTree(e,r,s,$,n);const i=t.createElement(r,o,a,$);if(s.length>2){const r=s.length;for(let $=2;$<r;$++)v(e,t,i,s[$],void 0,n)}return n&&ja(i,s),i}if(da(s)){const o=[];for(let a of s)o.push(v(e,t,r,a,$,n));return o}return null==s?r:t.createTextElement(r,s)};const u=(e,t,r,s,$=0)=>{if(w(s)){const n=t.getChild(r,$);"function"==typeof s[0]&&u(e,t,r,s[0].apply(null,[e.ctx,...s.slice(1)]),$);const o=s[1];if(o.__impl)return o.__impl.hydrateTree(e,r,s,$);ja(n,s);for(let e in o)0===e.indexOf("on")&&t.setAttrib(n,e,o[e]);for(let r=s.length,$=2;$<r;$++)u(e,t,n,s[$],$-2)}else if(da(s))for(let n of s)u(e,t,r,n,$),$++};const cc=(e,t,r,s)=>{const $=ub[t]?document.createElementNS(fb,t):document.createElement(t);return r&&lc($,r),qa(e,$,s)};const dc=(e,t,r)=>qa(e,document.createTextNode(t),r);const qa=(e,t,r)=>e?void 0===r?e.appendChild(t):e.insertBefore(t,e.children[r]):t;const fc=(e,t)=>e.children[t];const gc=(e,t,r,s,$,n=!0)=>(t.removeChild(r,s),t.createTree(e,r,$,s,n));const kc=(e,t)=>e.textContent=t;const lc=(e,t)=>{for(let r in t)xa(e,r,t[r],t);return e};const xa=(e,t,r,s)=>{if(t.startsWith("__"))return;const $=0===t.indexOf("on");if($||"function"!=typeof r||(r=r(s)),void 0!==r&&!1!==r)switch(t){case"style":qc(e,r);break;case"value":oc(e,r);break;case"accesskey":e.accessKey=r;break;case"contenteditable":e.contentEditable=r;break;case"tabindex":e.tabIndex=r;break;case"align":case"autocapitalize":case"checked":case"dir":case"draggable":case"hidden":case"id":case"lang":case"namespaceURI":case"scrollTop":case"scrollLeft":case"title":e[t]=r;break;default:$?uc(e,t.substr(2),r):e.setAttribute(t,!0===r?"":r);}else null!=e[t]?e[t]=null:e.removeAttribute(t);return e};const oc=(e,t)=>{let r;switch(e.type){case"text":case"textarea":case"password":case"search":case"number":case"email":case"url":case"tel":case"date":case"datetime-local":case"time":case"week":case"month":if(void 0!==(r=e.value)&&"string"==typeof t){const s=t.length-(r.length-(e.selectionStart||0));e.value=t,e.selectionStart=e.selectionEnd=s;break}default:e.value=t;}};const pc=(e,t,r)=>{for(let s=t.length;--s>=0;){const $=t[s];0===$.indexOf("on")?xc(e,$.substr(2),r[$]):e.hasAttribute($)?e.removeAttribute($):e[$]=null}};const qc=(e,t)=>(e.setAttribute("style",xb(t)),e);const uc=(e,t,r)=>w(r)?e.addEventListener(t,...r):e.addEventListener(t,r);const xc=(e,t,r)=>w(r)?e.removeEventListener(t,...r):e.removeEventListener(t,r);const Ac=(e,t)=>{const r=e.children[t];void 0!==r&&e.removeChild(r)};const p=t,Cc=Ua,Dc=cb,Hc=(e,r)=>{let $,i,t,n,a,o=e[0],l=Dc(e[1]);return"string"==typeof o&&($=lb.exec(o))||X(`${o} is not a valid tag name`),o!==(i=$[1])||!l||r&&!e[1].key?(a=l?Object.assign({},e[1]):{},t=$[2],n=$[3],t&&(a.id=t),n&&(n=n.replace(/\./g," "),a.class?a.class+=" "+n:a.class=n),a.__skip&&e.length<3?[i,a]:[i,a,...e.slice(l?2:1)]):e};const Jc=(e,r)=>g(r,e,e.ctx,[0],!1!==e.keys,!1!==e.span);const g=(e,r,$,i,t,n)=>{if(null!=e){if(p(e)){if(0===e.length)return;let a,o,l=e[1];if(l&&(o=l.__impl)&&(o=o.normalizeTree))return o(r,e);const s=e[0];if("function"==typeof s)return g(s.apply(null,[$,...e.slice(1)]),r,$,i,t,n);if("function"==typeof s.render){const o=[$,...e.slice(1)];return a=g(s.render.apply(s,o),r,$,i,t,n),p(a)&&(a.__this=s,a.__init=s.init,a.__release=s.release,a.__args=o),a}if(!1===(l=(a=Hc(e,t))[1]).__normalize)return a;if(t&&void 0===l.key&&(l.key=i.join("-")),a.length>2){const e=a[0],o=[e,l];n=n&&!qb[e];for(let l=2,s=2,x=0,c=a.length;l<c;l++){let e=a[l];if(null!=e){const a=p(e);if(a&&p(e[0])||!a&&Cc(e))for(let l of e)void 0!==(l=g(l,r,$,i.concat(x),t,n))&&(o[s++]=l),x++;else void 0!==(e=g(e,r,$,i.concat(x),t,n))&&(o[s++]=e),x++}}return o}return a}return"function"==typeof e?g(e($),r,$,i,t,n):"function"==typeof e.toHiccup?g(e.toHiccup(r.ctx),r,$,i,t,n):"function"==typeof e.deref?g(e.deref(),r,$,i,t,n):n?["span",t?{key:i.join("-")}:{},e.toString()]:e.toString()}};const Mc={createTree(e,t,r,$,i){return v(e,this,t,r,$,i)},hydrateTree(e,t,r,$){return u(e,this,t,r,$)},diffTree(e,t,r,$,i){Da(e,this,t,r,$,i)},normalizeTree:Jc,getElementById:e=>document.getElementById(e),getChild:fc,createElement:cc,createTextElement:dc,replaceChild(e,t,r,$,i){gc(e,this,t,r,$,i)},removeChild:Ac,setContent:kc,removeAttribs:pc,setAttrib:xa};const Rc=(e,o)=>od(e)?o.getElementById(e):e;const Uc=(e,r={},t=Mc)=>{const a=Object.assign({root:"app"},r);let $=[],n=!0;const o=Rc(a.root,t),i=()=>{if(n){a.ctx=yb(r.ctx,a.autoDerefKeys);const f=t.normalizeTree(a,e);null!=f&&(a.hydrate?(t.hydrateTree(a,o,f),a.hydrate=!1):t.diffTree(a,o,$,f),$=f),n&&requestAnimationFrame(i)}};return requestAnimationFrame(i),()=>n=!1};const Vc=([o,p,$],t)=>["option",{value:o,disabled:!!$,selected:o===t},p];const Wc=(o,p,$,t)=>["select",p,...$.map(o=>Vc(o,t))];function*$c($,r){const e=i($)(j()),t=e[1],s=e[2];for(let i of r){const $=s([],i);if(h($))return void(yield*y(t($.deref())));$.length&&(yield*$)}yield*y(t([]))}function*L($,r){const e=i($)([R,R,($,r)=>r])[2];for(let t of r){let $=e(l,t);if(h($))return void(($=y($.deref()))!==l&&(yield $));$!==l&&(yield $)}}const i=r=>A(r,"xform")?r.xform():r;class n{constructor(e){this.value=e}deref(){return this.value}}const gd=e=>new n(e);const h=e=>e instanceof n;const kd=e=>e instanceof n?e:new n(e);const y=e=>e instanceof n?e.deref():e;function j($){return $?[...$]:Wa(()=>[],($,r)=>($.push(r),$))}const qd=e=>2===e.length?[void 0,e[1]]:3===e.length?[e[1],e[2]]:E(e.length);function M(...e){const r=e[0],$=r[0],u=r[1],t=r[2],c=null==(e=qd(e))[0]?$():e[0],o=e[1];return y(u(A(o,"$reduce")?o.$reduce(t,c):ld(o)?ud(t,c,o):vd(t,c,o)))}const ud=(e,r,$)=>{for(let u=0,t=$.length;u<t;u++)if(r=e(r,$[u]),h(r)){r=r.deref();break}return r},vd=(e,r,$)=>{for(let u of $)if(r=e(r,u),h(r)){r=r.deref();break}return r},Wa=(e,r)=>[e,e=>e,r];const Ya=($,r,e=L)=>{const t=r.length-1;return td(r[t])?r.length>1?e($.apply(null,r.slice(0,t)),r[t]):e($(),r[0]):void 0};function f(...e){let r,$;switch(e.length){case 4:$=e[3],r=e[2];break;case 3:$=e[2];break;case 2:return b(r=>f(e[0],e[1],r));default:E(e.length);}return M(i(e[0])(e[1]),r,$)}function b(t,r){return r?L(b(t),r):r=>{const $=r[2];return U(r,(r,e)=>$(r,t(e)))}}const U=($,o)=>[$[0],$[1],o];const eb=e=>{const{1:r,2:$}=i(e)(j());let t=!1;return e=>{if(!t){let p=$([],e);return(t=h(p))&&(p=r(p.deref())),1===p.length?p[0]:p.length>0?p:void 0}}};function C($){return $?M(C(),$):Wa(()=>new Set,($,e)=>$.add(e))}function Y(...e){let[r,$,t,o,u,c,p,n,s,a]=e;switch(e.length){case 0:E(0);case 1:return r;case 2:return(...e)=>r($(...e));case 3:return(...e)=>r($(t(...e)));case 4:return(...e)=>r($(t(o(...e))));case 5:return(...e)=>r($(t(o(u(...e)))));case 6:return(...e)=>r($(t(o(u(c(...e))))));case 7:return(...e)=>r($(t(o(u(c(p(...e)))))));case 8:return(...e)=>r($(t(o(u(c(p(n(...e))))))));case 9:return(...e)=>r($(t(o(u(c(p(n(s(...e)))))))));case 10:default:const G=(...e)=>r($(t(o(u(c(p(n(s(a(...e))))))))));return 10===e.length?G:Y(G,...e.slice(10));}}function hb(...e){const[r,t,n,u,s,a,c,$]=e;switch(e.length){case 1:return e=>[r(e)];case 2:return e=>[r(e),t(e)];case 3:return e=>[r(e),t(e),n(e)];case 4:return e=>[r(e),t(e),n(e),u(e)];case 5:return e=>[r(e),t(e),n(e),u(e),s(e)];case 6:return e=>[r(e),t(e),n(e),u(e),s(e),a(e)];case 7:return e=>[r(e),t(e),n(e),u(e),s(e),a(e),c(e)];case 8:return e=>[r(e),t(e),n(e),u(e),s(e),a(e),c(e),$(e)];default:return r=>{let t=new Array(e.length);for(let n=e.length;--n>=0;)t[n]=e[n](r);return t};}}function ib(e,t,r){return new jb(e,t,r)}class jb{constructor(e,t,r){void 0===e?(e=0,t=1/0):void 0===t&&(t=e,e=0),r=void 0===r?e<t?1:-1:r,this.from=e,this.to=t,this.step=r}*[Symbol.iterator](){const e=this.step,t=this.to;let r=this.from;if(e>0)for(;r<t;)yield r,r+=e;else if(e<0)for(;r>t;)yield r,r+=e}$reduce(e,t){const r=this.step;if(r>0)for(let o=this.from,$=this.to;o<$&&!h(t);o+=r)t=e(t,o);else for(let o=this.from,$=this.to;o>$&&!h(t);o+=r)t=e(t,o);return t}}function*kb(...o){const t=o.map(o=>o[Symbol.iterator]());for(;;){const o=[];for(let e of t){let t=e.next();if(t.done)return;o.push(t.value)}yield o}}function Z(r,$){return $?L(Z(r),$):$=>{const e=$[2];return U($,($,t)=>r(t)?e($,t):$)}}const mb=e=>((null==e||!e[Symbol.iterator])&&X(`value is not iterable: ${e}`),e);const nb=r=>t(r)?r:[...mb(r)];const $=1/4294967295;class pb{float(t=1){return this.int()*$*t}norm(t=1){return 2*(this.int()*$-.5)*t}minmax(t,$){return this.float()*($-t)+t}gaussian(t=10,$=-.5,r=1){let a=0,n=t;for(;n-->0;)a+=this.float(r);return a/t+$}}const r=Math.random;class Bc extends pb{int(){return 4294967295*r()>>>0}float($=1){return r()*$}norm($=1){return 2*(r()-.5)*$}}const ab=new Bc;const tb=(e,t,r=ab)=>{const $=e.length;pa($>0,"no choices given");const o=e.map(t?(e,r)=>[e,t[r]]:e=>[e,1]).sort((e,t)=>t[1]-e[1]),m=o.reduce((e,t)=>e+t[1],0);return pa(m>0,"no choices given"),()=>{const e=r.float(m);let t=m;for(let r=0;r<$;r++)if((t-=o[r][1])<=e)return o[r][0]}};function ba(...e){return e=e.map(i),Y.apply(null,e)}function ca(e,r){return r?$c(ca(e),r):r=>{const $=r[2];let g=e;return U(r,(e,r)=>--g>0?$(e,r):0===g?kd($(e,r)):gd(e))}}function wb(...$){return b(hb.apply(null,$.map(eb)))}function D(...$){const e=Ya(D,$);if(e)return e;const[r,p]=$,t=Object.keys(r);return ba(wb.apply(null,t.map($=>r[$])),ea(t,p))}function ea(...r){const $=r.length>2&&Ya(ea,r);if($)return $;let e=r[0];if(t(e)&&(e=e.reduce((r,$,e)=>(r[$]=e,r),{})),r[1]){const $=Object.keys(e);return b(t=>f(ba(b(r=>[r,t[e[r]]]),Z(r=>void 0!==r[1])),r[1],$))}return b(zb(e))}const zb=e=>{const r=Object.keys(e),[t,n,o]=r,[s,c,$]=r.map(r=>e[r]);switch(r.length){case 3:return e=>{const r={};let a;return void 0!==(a=e[$])&&(r[o]=a),void 0!==(a=e[c])&&(r[n]=a),void 0!==(a=e[s])&&(r[t]=a),r};case 2:return e=>{const r={};let o;return void 0!==(o=e[c])&&(r[n]=o),void 0!==(o=e[s])&&(r[t]=o),r};case 1:return e=>{const r={};let n=e[s];return void 0!==n&&(r[t]=n),r};default:return t=>{let n,o;const s={};for(let c=r.length-1;c>=0;c--)n=r[c],void 0!==(o=t[e[n]])&&(s[n]=o);return s};}};function*Ab(e,$=1/0){for(;$-->0;)yield e()}const Bb=($,e,r=ab)=>Ab(e?tb(nb($),e,r):()=>$[0|r.float($.length)]);function*Cb(e,o=1/0){for(;o-->0;)yield e}const Db=t=>{const e=Object.assign({element:"h1",attribs:{},subElement:"small",subAttribs:{}},t);return(t,s,r)=>[e.element,e.attribs,s,r?[e.subElement,e.subAttribs,r]:void 0]};var Eb=function(){return Eb=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},Eb.apply(this,arguments)};function Fb(t,e,r,o){var n,a=arguments.length,$=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)$=Reflect.decorate(t,e,r,o);else for(var i=t.length-1;i>=0;i--)(n=t[i])&&($=(a<3?n($):a>3?n(e,r,$):n(e,r))||$);return a>3&&$&&Object.defineProperty(e,r,$),$}function fa(t){return this instanceof fa?(this.v=t,this):new fa(t)}const Hb=(e,o={})=>{const t=Reflect.ownKeys(e),r=Reflect.ownKeys(o),n=Symbol("isa");function p(o){for(let r of t){const t=Object.getOwnPropertyDescriptor(o.prototype,r);!t||t.configurable?Object.defineProperty(o.prototype,r,{value:e[r],writable:!0}):console.log(`not patching: ${o.name}.${r.toString()}`)}return Object.defineProperty(o.prototype,n,{value:!0}),o}for(let i of r)Object.defineProperty(p,i,{value:o[i],enumerable:o.propertyIsEnumerable(i)});return Object.defineProperty(p,Symbol.hasInstance,{value:e=>!!e[n]}),p};const Ib=Hb({addWatch(t,s){return this._watches=this._watches||{},!this._watches[t]&&(this._watches[t]=s,!0)},removeWatch(t){if(this._watches)return!!this._watches[t]&&(delete this._watches[t],!0)},notifyWatches(t,s){if(!this._watches)return;const e=this._watches;for(let i in e)e[i](i,t,s)}});const Jb=(r,o=r=>void 0!==r?": "+r:"")=>class extends Error{constructor(e){super(r(e)+o(e))}};const Kb=Jb(()=>"illegal state");const Lb=e=>{throw new Kb(e)};const ga=Array.isArray;const Nb=t=>"string"==typeof t;const Ob=r=>r&&(r instanceof Float32Array||r instanceof Float64Array||r instanceof Uint32Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Int8Array||r instanceof Uint16Array||r instanceof Int16Array||r instanceof Uint8ClampedArray);const ha=t=>ga(t)?t:Nb(t)?t.length>0?t.split("."):[]:null!=t?[t]:[];function Qb(e){const t=ha(e),[r,l,n,$]=t;switch(t.length){case 0:return e=>e;case 1:return e=>null!=e?e[r]:void 0;case 2:return e=>null!=e&&null!=(e=e[r])?e[l]:void 0;case 3:return e=>null!=e&&null!=(e=e[r])&&null!=(e=e[l])?e[n]:void 0;case 4:return e=>null!=e&&null!=(e=e[r])&&null!=(e=e[l])&&null!=(e=e[n])?e[$]:void 0;default:return e=>{const r=t.length-1;let l=e;for(let n=0;null!=l&&n<=r;n++)l=l[t[n]];return l};}}function ia($){const e=ha($),[t,r,o,p]=e;switch(e.length){case 0:return($,e)=>e;case 1:return($,e)=>($=a($),$[t]=e,$);case 2:return($,e)=>{let o;return($=a($))[t]=o=a($[t]),o[r]=e,$};case 3:return($,e)=>{let p,c;return($=a($))[t]=p=a($[t]),p[r]=c=a(p[r]),c[o]=e,$};case 4:return($,e)=>{let c,C,G;return($=a($))[t]=c=a($[t]),c[r]=C=a(c[r]),C[o]=G=a(C[o]),G[p]=e,$};default:let $;for(let t=e.length;--t>=0;)$=Tb(e[t],$);return $;}}const a=$=>ga($)||Ob($)?$.slice():Object.assign({},$);const Tb=($,e)=>(t,r)=>(t=a(t),t[$]=e?e(t[$],r):r,t);const ka=(e,$,t,...r)=>Vb(e,$,t,...r);function Vb(e,$,t,...r){return ia($)(e,t.apply(null,(r.unshift(Qb($)(e)),r)))}const la=(e,$,t)=>ia($)(e,t);let ma=class{constructor(e,t){t&&!t(e)&&Lb("initial state value did not validate"),this._value=e,this.valid=t}get value(){return this._value}set value(e){this.reset(e)}deref(){return this._value}equiv(e){return this===e}reset(e){const t=this._value;return this.valid&&!this.valid(e)?t:(this._value=e,this.notifyWatches(t,e),e)}resetIn(e,t){return this.reset(la(this._value,e,t))}resetInUnsafe(e,t){return this.reset(la(this._value,e,t))}swap(e,...t){return this.reset(e.apply(null,[this._value,...t]))}swapIn(e,t,...r){return this.reset(ka(this._value,e,t,...r))}swapInUnsafe(e,t,...r){return this.reset(ka(this._value,e,t,...r))}addWatch(e,t){}removeWatch(e){}notifyWatches(e,t){}release(){return delete this._watches,delete this._value,!0}};ma=Fb([Ib],ma);function Yb($,e){if(wd($))for(let t of e)$.set(t[0],t[1]);else for(let t of e)$.add(t);return $}const Zb=(e,$)=>A(e,"empty")?e.empty():new(e[Symbol.species]||$);const na=e=>db(e)?e:new Set(e);const _b=(e,$,r)=>r?M(e(),r):[()=>null,e=>e||new Set,(e,r)=>e?$(e,na(r)):na(r)];const F=(e,t,r)=>{if(r=r||Zb(e,Set),e===t)return Yb(r,e);if(t.size<e.size)return F(t,e,r);for(let $ of t)e.has($)&&r.add($);return r};function bc(e){return _b(bc,F,e)}function G($){return"object"==typeof $&&"string"==typeof $.name}function H($){return"object"==typeof $&&"number"==typeof $.step&&"number"==typeof $.alt}const ra=[0,2,4,-1,1,3,5],sa=ra.map($=>Math.floor(7*$/12));function ta($){const{step:t,alt:e,oct:r,dir:o=1}=$,p=ra[t]+7*e;return void 0===r?[o*p]:[o*p,o*(r-sa[t]-4*e)]}const hc=[3,0,4,1,5,2,6];function ic($){const[t,e,r]=$,o=hc[jc(t)],p=Math.floor((t+1)/7);return void 0===e?{step:o,alt:p,dir:r}:{step:o,alt:p,oct:e+4*p+sa[o],dir:r}}function jc($){const t=($+1)%7;return t<0?7+t:t}const ua={empty:!0,name:"",pc:"",acc:""},va={},wa=($,t)=>Array(t+1).join($),nc=$=>"CDEFGAB".charAt($),I=$=>$<0?wa("b",-$):wa("#",$),ya=$=>"b"===$[0]?-$.length:$.length;function d($){return"string"==typeof $?va[$]||(va[$]=vc($)):H($)?d(wc($)):G($)?d($.name):ua}const rc=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function sc($){const t=rc.exec($);return[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]}function tc($){return d(ic($))}const Aa=[0,2,4,5,7,9,11];function vc($){const t=sc($);if(""===t[0]||""!==t[3])return ua;const e=t[0],r=t[1],o=t[2],p=(e.charCodeAt(0)+3)%7,u=ya(r),a=o.length?+o:void 0,n=ta({step:p,alt:u,oct:a}),c=e+r+o,z=e+r,V=(Aa[p]+u+120)%12,s=void 0===a?-100:a,i=Aa[p]+u+12*(s+1),l=i>=0&&i<=127?i:null;return{empty:!1,acc:r,alt:u,chroma:V,coord:n,freq:void 0===a?null:440*Math.pow(2,(i-69)/12),height:i,letter:e,midi:l,name:c,oct:a,pc:z,step:p}}function wc($){const{step:t,alt:e,oct:r}=$,o=nc(t);if(!o)return"";const p=o+I(e);return r||0===r?p+r:p}const K={empty:!0,name:"",acc:""},yc=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$");function zc($){const t=yc.exec(`${$}`);return null===t?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}const Ca={};function s($){return"string"==typeof $?Ca[$]||(Ca[$]=Ec($)):H($)?s(Gc($)):G($)?s($.name):K}const Ea=[0,2,4,5,7,9,11],Fa="PMMPPMM";function Ec($){const t=zc($);if(""===t[0])return K;const e=+t[0],r=t[1],o=(Math.abs(e)-1)%7,p=Fa[o];if("M"===p&&"P"===r)return K;const u="M"===p?"majorable":"perfectable",a=""+e+r,n=e<0?-1:1,c=8===e||-8===e?e:n*(o+1),z=Fc(u,r),V=Math.floor((Math.abs(e)-1)/7);return{empty:!1,name:a,num:e,q:r,step:o,alt:z,dir:n,type:u,simple:c,semitones:n*(Ea[o]+z+12*V),chroma:(n*(Ea[o]+z)%12+12)%12,coord:ta({step:o,alt:z,oct:V,dir:n}),oct:V}}function Fc($,t){return"M"===t&&"majorable"===$||"P"===t&&"perfectable"===$?0:"m"===t&&"majorable"===$?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*("perfectable"===$?t.length:t.length+1):0}function Gc($){const{step:t,alt:e,oct:r=0,dir:o}=$;return o?(o<0?"-":"")+(t+1+7*r)+Ic("M"===Fa[t]?"majorable":"perfectable",e):""}const Ga=($,t)=>Array(Math.abs(t)+1).join($);function Ic($,t){return 0===t?"majorable"===$?"M":"P":-1===t&&"majorable"===$?"m":t>0?Ga("A",t):Ga("d","perfectable"===$?t:t+1)}function Ha($,t){const e=d($),r=s(t);if(e.empty||r.empty)return"";const o=e.coord,p=r.coord;return tc(1===o.length?[o[0]+p[0]]:[o[0]+p[0],o[1]+p[1]]).name}function Kc($){return+$>=0&&+$<=127}function Ia($){if(Kc($))return+$;const o=d($);return o.empty?null:o.midi}const Fd=Math.log(2),Ed=Math.log(440);const Oc="C C# D D# E F F# G G# A A# B".split(" "),Pc="C Db D Eb E F Gb G Ab A Bb B".split(" ");function Qc($,o={}){$=Math.round($);const r=(!0===o.sharps?Oc:Pc)[$%12];return o.pitchClass?r:r+(Math.floor($/12)-1)}const Ka=$=>o=>{const r=d(o);if(r.empty)return"";const t=$?r.alt>0:r.alt<0,v=null===r.midi;return Qc(r.midi||r.chroma,{sharps:t,pitchClass:v})},yd=Ka(!0),Cd=Ka(!1);const La={empty:!0,name:"",chordType:""},Ma={};function z($){return"string"==typeof $?Ma[$]||(Ma[$]=bd($)):"number"==typeof $?z(N[$]||""):H($)?Xc($):G($)?z($.name):La}function Xc($){return z(I($.alt)+N[$.step])}const Yc=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function Zc($){return Yc.exec($)||["","","",""]}const Oa="I II III IV V VI VII",N=Oa.split(" "),Bd=Oa.toLowerCase().split(" ");function bd($){const[r,e,a,t]=Zc($);if(!a)return La;const o=a.toUpperCase(),R=N.indexOf(o),n=ya(e);return{empty:!1,name:r,roman:a,interval:s({step:R,alt:n,dir:1}).name,acc:e,chordType:t,alt:n,step:R,major:a===o,oct:0,dir:1}}const Qa=t=>(i,a="")=>i.map((i,r)=>"-"!==i?t[r]+a+i:"");function e(t,i,a,r){return o=>{const $=t.split(" "),e=$.map(t=>z(t).interval||""),n=e.map(t=>Ha(o,t)),m=Qa(n);return{tonic:o,grades:$,intervals:e,scale:n,chords:m(i.split(" ")),chordsHarmonicFunction:a.split(" "),chordScales:m(r.split(",")," ")}}}const ed=(t,i)=>{const a=d(t),r=d(i);return a.empty||r.empty?0:r.coord[0]-a.coord[0]},fd=e("I II III IV V VI VII","maj7 m7 m7 maj7 7 m7 m7b5","T SD T SD D T D","major,dorian,phrygian,lydian,mixolydian,minor,locrian"),Ad=e("I II bIII IV V bVI bVII","m7 m7b5 maj7 m7 m7 maj7 7","T SD T SD D SD SD","minor,locrian,major,dorian,phrygian,lydian,mixolydian"),Dd=e("I II bIII IV V bVI VII","mmaj7 m7b5 +maj7 m7 7 maj7 mo7","T SD T SD D SD D","harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian"),zd=e("I II bIII IV V VI VII","m6 m7 +maj7 7 7 m7b5 m7b5","T SD T SD D - -","melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered");function jd(t){const i=fd(t),a=ed("C",t),r=Qa(i.scale);return{...i,type:"major",minorRelative:Ha(t,"-3m"),alteration:a,keySignature:I(a),secondaryDominants:r("- VI7 VII7 I7 II7 III7 -".split(" ")),secondaryDominantsMinorRelative:r("- IIIm7b5 IV#m7 Vm7 VIm7 VIIm7b5 -".split(" ")),substituteDominants:r("- bIII7 IV7 bV7 bVI7 bVII7 -".split(" ")),substituteDominantsMinorRelative:r("- IIIm7 Im7 IIbm7 VIm7 IVm7 -".split(" "))}}var Q,o={};!function(e){function t(){if(t.prototype._singleton)throw new Error("WebMidi is a singleton, it cannot be instantiated directly.");(t.prototype._singleton=this)._inputs=[],this._outputs=[],this._userHandlers={},this._stateChangeQueue=[],this._processingStateChange=!1,this._midiInterfaceEvents=["connected","disconnected"],this._nrpnBuffer=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],this._nrpnEventsEnabled=!0,this._nrpnTypes=["entry","increment","decrement"],this._notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this._semitones={C:0,D:2,E:4,F:5,G:7,A:9,B:11},Object.defineProperties(this,{MIDI_SYSTEM_MESSAGES:{value:{sysex:240,timecode:241,songposition:242,songselect:243,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MESSAGES:{value:{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,channelmode:11,nrpn:11,programchange:12,channelaftertouch:13,pitchbend:14},writable:!1,enumerable:!0,configurable:!1},MIDI_REGISTERED_PARAMETER:{value:{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]},writable:!1,enumerable:!0,configurable:!1},MIDI_CONTROL_CHANGE_MESSAGES:{value:{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101},writable:!1,enumerable:!0,configurable:!1},MIDI_NRPN_MESSAGES:{value:{entrymsb:6,entrylsb:38,increment:96,decrement:97,paramlsb:98,parammsb:99,nullactiveparameter:127},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MODE_MESSAGES:{value:{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127},writable:!1,enumerable:!0,configurable:!1},octaveOffset:{value:0,writable:!0,enumerable:!0,configurable:!1}}),Object.defineProperties(this,{supported:{enumerable:!0,get:function(){return"requestMIDIAccess"in navigator}},enabled:{enumerable:!0,get:function(){return void 0!==this.interface}.bind(this)},inputs:{enumerable:!0,get:function(){return this._inputs}.bind(this)},outputs:{enumerable:!0,get:function(){return this._outputs}.bind(this)},sysexEnabled:{enumerable:!0,get:function(){return!(!this.interface||!this.interface.sysexEnabled)}.bind(this)},nrpnEventsEnabled:{enumerable:!0,get:function(){return!!this._nrpnEventsEnabled}.bind(this),set:function(e){return this._nrpnEventsEnabled=e,this._nrpnEventsEnabled}},nrpnTypes:{enumerable:!0,get:function(){return this._nrpnTypes}.bind(this)},time:{enumerable:!0,get:function(){return performance.now()}}})}var n=new t;function r(e){var t=this;this._userHandlers={channel:{},system:{}},this._midiInput=e,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return t._midiInput.connection}},id:{enumerable:!0,get:function(){return t._midiInput.id}},manufacturer:{enumerable:!0,get:function(){return t._midiInput.manufacturer}},name:{enumerable:!0,get:function(){return t._midiInput.name}},state:{enumerable:!0,get:function(){return t._midiInput.state}},type:{enumerable:!0,get:function(){return t._midiInput.type}}}),this._initializeUserHandlers(),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}function i(e){var t=this;this._midiOutput=e,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return t._midiOutput.connection}},id:{enumerable:!0,get:function(){return t._midiOutput.id}},manufacturer:{enumerable:!0,get:function(){return t._midiOutput.manufacturer}},name:{enumerable:!0,get:function(){return t._midiOutput.name}},state:{enumerable:!0,get:function(){return t._midiOutput.state}},type:{enumerable:!0,get:function(){return t._midiOutput.type}}})}t.prototype.enable=function(e,t){this.enabled||(this.supported?navigator.requestMIDIAccess({sysex:t}).then(function(t){var n,r=[],i=[];this.interface=t,this._resetInterfaceUserHandlers(),this.interface.onstatechange=function(e){r.push(e)};for(var o=t.inputs.values(),a=o.next();a&&!a.done;a=o.next())i.push(a.value.open());for(var s=t.outputs.values(),u=s.next();u&&!u.done;u=s.next())i.push(u.value.open());function h(){clearTimeout(n),this._updateInputsAndOutputs(),this.interface.onstatechange=this._onInterfaceStateChange.bind(this),"function"==typeof e&&e.call(this),r.forEach(function(e){this._onInterfaceStateChange(e)}.bind(this))}n=setTimeout(h.bind(this),200),Promise&&Promise.all(i).catch(function(e){}).then(h.bind(this))}.bind(this),function(t){"function"==typeof e&&e.call(this,t)}.bind(this)):"function"==typeof e&&e(new Error("The Web MIDI API is not supported by your browser.")))},t.prototype.disable=function(){if(!this.supported)throw new Error("The Web MIDI API is not supported by your browser.");this.interface&&(this.interface.onstatechange=void 0),this.interface=void 0,this._inputs=[],this._outputs=[],this._nrpnEventsEnabled=!0,this._resetInterfaceUserHandlers()},t.prototype.addListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before adding event listeners.");if("function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(e)))throw new TypeError("The specified event type is not supported.");return this._userHandlers[e].push(t),this},t.prototype.hasListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before checking event listeners.");if("function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(e)))throw new TypeError("The specified event type is not supported.");for(var n=0;n<this._userHandlers[e].length;n++)if(this._userHandlers[e][n]===t)return!0;return!1},t.prototype.removeListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before removing event listeners.");if(void 0!==t&&"function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(0<=this._midiInterfaceEvents.indexOf(e)){if(t)for(var n=0;n<this._userHandlers[e].length;n++)this._userHandlers[e][n]===t&&this._userHandlers[e].splice(n,1);else this._userHandlers[e]=[];}else{if(void 0!==e)throw new TypeError("The specified event type is not supported.");this._resetInterfaceUserHandlers()}return this},t.prototype.toMIDIChannels=function(e){var t;if("all"===e||void 0===e)t=["all"];else{if("none"===e)return[];t=Array.isArray(e)?e:[e]}return-1<t.indexOf("all")&&(t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),t.map(function(e){return parseInt(e)}).filter(function(e){return 1<=e&&e<=16})},t.prototype.getInputById=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");e=String(e);for(var t=0;t<this.inputs.length;t++)if(this.inputs[t].id===e)return this.inputs[t];return!1},t.prototype.getOutputById=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");e=String(e);for(var t=0;t<this.outputs.length;t++)if(this.outputs[t].id===e)return this.outputs[t];return!1},t.prototype.getInputByName=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var t=0;t<this.inputs.length;t++)if(~this.inputs[t].name.indexOf(e))return this.inputs[t];return!1},t.prototype.getOctave=function(e){if(null!=e&&0<=e&&e<=127)return Math.floor(Math.floor(e)/12-1)+Math.floor(n.octaveOffset)},t.prototype.getOutputByName=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var t=0;t<this.outputs.length;t++)if(~this.outputs[t].name.indexOf(e))return this.outputs[t];return!1},t.prototype.guessNoteNumber=function(e){var t=!1;if(e&&e.toFixed&&0<=e&&e<=127?t=Math.round(e):0<=parseInt(e)&&parseInt(e)<=127?t=parseInt(e):("string"==typeof e||e instanceof String)&&(t=this.noteNameToNumber(e)),!1===t)throw new Error("Invalid input value ("+e+").");return t},t.prototype.noteNameToNumber=function(e){"string"!=typeof e&&(e="");var t=e.match(/([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)/i);if(!t)throw new RangeError("Invalid note name.");var r=n._semitones[t[1].toUpperCase()],i=12*(parseInt(t[3])+1-Math.floor(n.octaveOffset))+r;if(-1<t[2].toLowerCase().indexOf("b")?i-=t[2].length:-1<t[2].toLowerCase().indexOf("#")&&(i+=t[2].length),i<0||127<i)throw new RangeError("Invalid note name or note outside valid range.");return i},t.prototype._updateInputsAndOutputs=function(){this._updateInputs(),this._updateOutputs()},t.prototype._updateInputs=function(){for(var e=0;e<this._inputs.length;e++){for(var t=!0,n=this.interface.inputs.values(),i=n.next();i&&!i.done;i=n.next())if(this._inputs[e]._midiInput===i.value){t=!1;break}t&&this._inputs.splice(e,1)}this.interface&&this.interface.inputs.forEach(function(e){for(var t=!0,n=0;n<this._inputs.length;n++)this._inputs[n]._midiInput===e&&(t=!1);t&&this._inputs.push(new r(e))}.bind(this))},t.prototype._updateOutputs=function(){for(var e=0;e<this._outputs.length;e++){for(var t=!0,n=this.interface.outputs.values(),r=n.next();r&&!r.done;r=n.next())if(this._outputs[e]._midiOutput===r.value){t=!1;break}t&&this._outputs.splice(e,1)}this.interface&&this.interface.outputs.forEach(function(e){for(var t=!0,n=0;n<this._outputs.length;n++)this._outputs[n]._midiOutput===e&&(t=!1);t&&this._outputs.push(new i(e))}.bind(this))},t.prototype._onInterfaceStateChange=function(e){this._updateInputsAndOutputs();var t={timestamp:e.timeStamp,type:e.port.state};this.interface&&"connected"===e.port.state?"output"===e.port.type?t.port=this.getOutputById(e.port.id):"input"===e.port.type&&(t.port=this.getInputById(e.port.id)):t.port={connection:"closed",id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this._userHandlers[e.port.state].forEach(function(e){e(t)})},t.prototype._resetInterfaceUserHandlers=function(){for(var e=0;e<this._midiInterfaceEvents.length;e++)this._userHandlers[this._midiInterfaceEvents[e]]=[]},r.prototype.on=r.prototype.addListener=function(e,t,r){var i=this;if(void 0===t&&(t="all"),Array.isArray(t)||(t=[t]),t.forEach(function(e){if("all"!==e&&!(1<=e&&e<=16))throw new RangeError("The 'channel' parameter is invalid.")}),"function"!=typeof r)throw new TypeError("The 'listener' parameter must be a function.");if(void 0!==n.MIDI_SYSTEM_MESSAGES[e])this._userHandlers.system[e]||(this._userHandlers.system[e]=[]),this._userHandlers.system[e].push(r);else{if(void 0===n.MIDI_CHANNEL_MESSAGES[e])throw new TypeError("The specified event type is not supported.");if(-1<t.indexOf("all")){t=[];for(var o=1;o<=16;o++)t.push(o)}this._userHandlers.channel[e]||(this._userHandlers.channel[e]=[]),t.forEach(function(t){i._userHandlers.channel[e][t]||(i._userHandlers.channel[e][t]=[]),i._userHandlers.channel[e][t].push(r)})}return this},r.prototype.hasListener=function(e,t,r){var i=this;if("function"!=typeof r)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===t&&(t="all"),t.constructor!==Array&&(t=[t]),void 0!==n.MIDI_SYSTEM_MESSAGES[e]){for(var o=0;o<this._userHandlers.system[e].length;o++)if(this._userHandlers.system[e][o]===r)return!0}else if(void 0!==n.MIDI_CHANNEL_MESSAGES[e]){if(-1<t.indexOf("all")){t=[];for(var a=1;a<=16;a++)t.push(a)}return!!this._userHandlers.channel[e]&&t.every(function(t){var n=i._userHandlers.channel[e][t];return n&&-1<n.indexOf(r)})}return!1},r.prototype.removeListener=function(e,t,r){var i=this;if(void 0!==r&&"function"!=typeof r)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===t&&(t="all"),t.constructor!==Array&&(t=[t]),void 0!==n.MIDI_SYSTEM_MESSAGES[e]){if(void 0===r)this._userHandlers.system[e]=[];else for(var o=0;o<this._userHandlers.system[e].length;o++)this._userHandlers.system[e][o]===r&&this._userHandlers.system[e].splice(o,1);}else if(void 0!==n.MIDI_CHANNEL_MESSAGES[e]){if(-1<t.indexOf("all")){t=[];for(var a=1;a<=16;a++)t.push(a)}if(!this._userHandlers.channel[e])return this;t.forEach(function(t){var n=i._userHandlers.channel[e][t];if(n)if(void 0===r)i._userHandlers.channel[e][t]=[];else for(var o=0;o<n.length;o++)n[o]===r&&n.splice(o,1)})}else{if(void 0!==e)throw new TypeError("The specified event type is not supported.");this._initializeUserHandlers()}return this},r.prototype._initializeUserHandlers=function(){for(var e in n.MIDI_CHANNEL_MESSAGES)n.MIDI_CHANNEL_MESSAGES.hasOwnProperty(e)&&(this._userHandlers.channel[e]={});for(var t in n.MIDI_SYSTEM_MESSAGES)n.MIDI_SYSTEM_MESSAGES.hasOwnProperty(t)&&(this._userHandlers.system[t]=[])},r.prototype._onMidiMessage=function(e){if(0<this._userHandlers.system.midimessage.length){var t={target:this,data:e.data,timestamp:e.timeStamp,type:"midimessage"};this._userHandlers.system.midimessage.forEach(function(e){e(t)})}e.data[0]<240?(this._parseChannelEvent(e),this._parseNrpnEvent(e)):e.data[0]<=255&&this._parseSystemEvent(e)},r.prototype._parseNrpnEvent=function(e){var t,r,i=e.data[0]>>4,o=15&e.data[0],a=1+o;if(1<e.data.length&&(t=e.data[1],r=2<e.data.length?e.data[2]:void 0),n.nrpnEventsEnabled&&i===n.MIDI_CHANNEL_MESSAGES.controlchange&&(t>=n.MIDI_NRPN_MESSAGES.increment&&t<=n.MIDI_NRPN_MESSAGES.parammsb||t===n.MIDI_NRPN_MESSAGES.entrymsb||t===n.MIDI_NRPN_MESSAGES.entrylsb)){var s={target:this,type:"controlchange",data:e.data,timestamp:e.timeStamp,channel:a,controller:{number:t,name:this.getCcNameByNumber(t)},value:r};if(s.controller.number===n.MIDI_NRPN_MESSAGES.parammsb&&s.value!=n.MIDI_NRPN_MESSAGES.nullactiveparameter)n._nrpnBuffer[o]=[],n._nrpnBuffer[o][0]=s;else if(1===n._nrpnBuffer[o].length&&s.controller.number===n.MIDI_NRPN_MESSAGES.paramlsb)n._nrpnBuffer[o].push(s);else if(2!==n._nrpnBuffer[o].length||s.controller.number!==n.MIDI_NRPN_MESSAGES.increment&&s.controller.number!==n.MIDI_NRPN_MESSAGES.decrement&&s.controller.number!==n.MIDI_NRPN_MESSAGES.entrymsb){if(3===n._nrpnBuffer[o].length&&n._nrpnBuffer[o][2].number===n.MIDI_NRPN_MESSAGES.entrymsb&&s.controller.number===n.MIDI_NRPN_MESSAGES.entrylsb)n._nrpnBuffer[o].push(s);else if(3<=n._nrpnBuffer[o].length&&n._nrpnBuffer[o].length<=4&&s.controller.number===n.MIDI_NRPN_MESSAGES.parammsb&&s.value===n.MIDI_NRPN_MESSAGES.nullactiveparameter)n._nrpnBuffer[o].push(s);else if(4<=n._nrpnBuffer[o].length&&n._nrpnBuffer[o].length<=5&&s.controller.number===n.MIDI_NRPN_MESSAGES.paramlsb&&s.value===n.MIDI_NRPN_MESSAGES.nullactiveparameter){n._nrpnBuffer[o].push(s);var u=[];n._nrpnBuffer[o].forEach(function(e){u.push(e.data)});var h=n._nrpnBuffer[o][0].value<<7|n._nrpnBuffer[o][1].value,l=n._nrpnBuffer[o][2].value;6===n._nrpnBuffer[o].length&&(l=n._nrpnBuffer[o][2].value<<7|n._nrpnBuffer[o][3].value);var p="";switch(n._nrpnBuffer[o][2].controller.number){case n.MIDI_NRPN_MESSAGES.entrymsb:p=n._nrpnTypes[0];break;case n.MIDI_NRPN_MESSAGES.increment:p=n._nrpnTypes[1];break;case n.MIDI_NRPN_MESSAGES.decrement:p=n._nrpnTypes[2];break;default:throw new Error("The NPRN type was unidentifiable.");}var c={timestamp:s.timestamp,channel:s.channel,type:"nrpn",data:u,controller:{number:h,type:p,name:"Non-Registered Parameter "+h},value:l};n._nrpnBuffer[o]=[],this._userHandlers.channel[c.type]&&this._userHandlers.channel[c.type][c.channel]&&this._userHandlers.channel[c.type][c.channel].forEach(function(e){e(c)})}else n._nrpnBuffer[o]=[];}else n._nrpnBuffer[o].push(s)}},r.prototype._parseChannelEvent=function(e){var t,r,i=e.data[0]>>4,o=1+(15&e.data[0]);1<e.data.length&&(t=e.data[1],r=2<e.data.length?e.data[2]:void 0);var a={target:this,data:e.data,timestamp:e.timeStamp,channel:o};i===n.MIDI_CHANNEL_MESSAGES.noteoff||i===n.MIDI_CHANNEL_MESSAGES.noteon&&0===r?(a.type="noteoff",a.note={number:t,name:n._notes[t%12],octave:n.getOctave(t)},a.velocity=r/127,a.rawVelocity=r):i===n.MIDI_CHANNEL_MESSAGES.noteon?(a.type="noteon",a.note={number:t,name:n._notes[t%12],octave:n.getOctave(t)},a.velocity=r/127,a.rawVelocity=r):i===n.MIDI_CHANNEL_MESSAGES.keyaftertouch?(a.type="keyaftertouch",a.note={number:t,name:n._notes[t%12],octave:n.getOctave(t)},a.value=r/127):i===n.MIDI_CHANNEL_MESSAGES.controlchange&&0<=t&&t<=119?(a.type="controlchange",a.controller={number:t,name:this.getCcNameByNumber(t)},a.value=r):i===n.MIDI_CHANNEL_MESSAGES.channelmode&&120<=t&&t<=127?(a.type="channelmode",a.controller={number:t,name:this.getChannelModeByNumber(t)},a.value=r):i===n.MIDI_CHANNEL_MESSAGES.programchange?(a.type="programchange",a.value=t):i===n.MIDI_CHANNEL_MESSAGES.channelaftertouch?(a.type="channelaftertouch",a.value=t/127):i===n.MIDI_CHANNEL_MESSAGES.pitchbend?(a.type="pitchbend",a.value=((r<<7)+t-8192)/8192):a.type="unknownchannelmessage",this._userHandlers.channel[a.type]&&this._userHandlers.channel[a.type][o]&&this._userHandlers.channel[a.type][o].forEach(function(e){e(a)})},r.prototype.getCcNameByNumber=function(e){if(!(0<=(e=Math.floor(e))&&e<=119))throw new RangeError("The control change number must be between 0 and 119.");for(var t in n.MIDI_CONTROL_CHANGE_MESSAGES)if(n.MIDI_CONTROL_CHANGE_MESSAGES.hasOwnProperty(t)&&e===n.MIDI_CONTROL_CHANGE_MESSAGES[t])return t},r.prototype.getChannelModeByNumber=function(e){if(!(120<=(e=Math.floor(e))&&status<=127))throw new RangeError("The control change number must be between 120 and 127.");for(var t in n.MIDI_CHANNEL_MODE_MESSAGES)if(n.MIDI_CHANNEL_MODE_MESSAGES.hasOwnProperty(t)&&e===n.MIDI_CHANNEL_MODE_MESSAGES[t])return t},r.prototype._parseSystemEvent=function(e){var t=e.data[0],r={target:this,data:e.data,timestamp:e.timeStamp};t===n.MIDI_SYSTEM_MESSAGES.sysex?r.type="sysex":t===n.MIDI_SYSTEM_MESSAGES.timecode?r.type="timecode":t===n.MIDI_SYSTEM_MESSAGES.songposition?r.type="songposition":t===n.MIDI_SYSTEM_MESSAGES.songselect?(r.type="songselect",r.song=e.data[1]):t===n.MIDI_SYSTEM_MESSAGES.tuningrequest?r.type="tuningrequest":t===n.MIDI_SYSTEM_MESSAGES.clock?r.type="clock":t===n.MIDI_SYSTEM_MESSAGES.start?r.type="start":t===n.MIDI_SYSTEM_MESSAGES.continue?r.type="continue":t===n.MIDI_SYSTEM_MESSAGES.stop?r.type="stop":t===n.MIDI_SYSTEM_MESSAGES.activesensing?r.type="activesensing":t===n.MIDI_SYSTEM_MESSAGES.reset?r.type="reset":r.type="unknownsystemmessage",this._userHandlers.system[r.type]&&this._userHandlers.system[r.type].forEach(function(e){e(r)})},i.prototype.send=function(e,t,n){if(!(128<=e&&e<=255))throw new RangeError("The status byte must be an integer between 128 (0x80) and 255 (0xFF).");void 0===t&&(t=[]),Array.isArray(t)||(t=[t]);var r=[];return t.forEach(function(e){var t=Math.floor(e);if(!(0<=t&&t<=255))throw new RangeError("Data bytes must be integers between 0 (0x00) and 255 (0xFF).");r.push(t)}),this._midiOutput.send([e].concat(r),parseFloat(n)||0),this},i.prototype.sendSysex=function(e,t,r){if(!n.sysexEnabled)throw new Error("Sysex message support must first be activated.");return r=r||{},e=[].concat(e),t.forEach(function(e){if(e<0||127<e)throw new RangeError("The data bytes of a sysex message must be integers between 0 (0x00) and 127 (0x7F).")}),t=e.concat(t,n.MIDI_SYSTEM_MESSAGES.sysexend),this.send(n.MIDI_SYSTEM_MESSAGES.sysex,t,this._parseTimeParameter(r.time)),this},i.prototype.sendTimecodeQuarterFrame=function(e,t){return t=t||{},this.send(n.MIDI_SYSTEM_MESSAGES.timecode,e,this._parseTimeParameter(t.time)),this},i.prototype.sendSongPosition=function(e,t){t=t||{};var r=(e=Math.floor(e)||0)>>7&127,i=127&e;return this.send(n.MIDI_SYSTEM_MESSAGES.songposition,[r,i],this._parseTimeParameter(t.time)),this},i.prototype.sendSongSelect=function(e,t){if(t=t||{},!(0<=(e=Math.floor(e))&&e<=127))throw new RangeError("The song number must be between 0 and 127.");return this.send(n.MIDI_SYSTEM_MESSAGES.songselect,[e],this._parseTimeParameter(t.time)),this},i.prototype.sendTuningRequest=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.tuningrequest,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendClock=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.clock,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendStart=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.start,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendContinue=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.continue,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendStop=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.stop,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendActiveSensing=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.activesensing,[],this._parseTimeParameter(e.time)),this},i.prototype.sendReset=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.reset,void 0,this._parseTimeParameter(e.time)),this},i.prototype.stopNote=function(e,t,r){if("all"===e)return this.sendChannelMode("allnotesoff",0,t,r);var i=64;return(r=r||{}).rawVelocity?!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=127&&(i=r.velocity):!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=1&&(i=127*r.velocity),this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){this.send((n.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(t-1),[e,Math.round(i)],this._parseTimeParameter(r.time))}.bind(this))}.bind(this)),this},i.prototype.playNote=function(e,t,r){var i,o=64;if((r=r||{}).rawVelocity?!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=127&&(o=r.velocity):!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=1&&(o=127*r.velocity),i=this._parseTimeParameter(r.time),this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){this.send((n.MIDI_CHANNEL_MESSAGES.noteon<<4)+(t-1),[e,Math.round(o)],i)}.bind(this))}.bind(this)),!isNaN(r.duration)){r.duration<=0&&(r.duration=0);var a=64;r.rawVelocity?!isNaN(r.release)&&0<=r.release&&r.release<=127&&(a=r.release):!isNaN(r.release)&&0<=r.release&&r.release<=1&&(a=127*r.release),this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){this.send((n.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(t-1),[e,Math.round(a)],(i||n.time)+r.duration)}.bind(this))}.bind(this))}return this},i.prototype.sendKeyAftertouch=function(e,t,r,i){var o=this;if(i=i||{},t<1||16<t)throw new RangeError("The channel must be between 1 and 16.");(isNaN(r)||r<0||1<r)&&(r=.5);var a=Math.round(127*r);return this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){o.send((n.MIDI_CHANNEL_MESSAGES.keyaftertouch<<4)+(t-1),[e,a],o._parseTimeParameter(i.time))})}),this},i.prototype.sendControlChange=function(e,t,r,i){if(i=i||{},"string"==typeof e){if(void 0===(e=n.MIDI_CONTROL_CHANGE_MESSAGES[e]))throw new TypeError("Invalid controller name.")}else if(!(0<=(e=Math.floor(e))&&e<=119))throw new RangeError("Controller numbers must be between 0 and 119.");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("Controller value must be between 0 and 127.");return n.toMIDIChannels(r).forEach(function(r){this.send((n.MIDI_CHANNEL_MESSAGES.controlchange<<4)+(r-1),[e,t],this._parseTimeParameter(i.time))}.bind(this)),this},i.prototype._selectRegisteredParameter=function(e,t,r){var i=this;if(e[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The control65 value must be between 0 and 127");if(e[1]=Math.floor(e[1]),!(0<=e[1]&&e[1]<=127))throw new RangeError("The control64 value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.sendControlChange(101,e[0],t,{time:r}),i.sendControlChange(100,e[1],t,{time:r})}),this},i.prototype._selectNonRegisteredParameter=function(e,t,r){var i=this;if(e[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The control63 value must be between 0 and 127");if(e[1]=Math.floor(e[1]),!(0<=e[1]&&e[1]<=127))throw new RangeError("The control62 value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.sendControlChange(99,e[0],t,{time:r}),i.sendControlChange(98,e[1],t,{time:r})}),this},i.prototype._setCurrentRegisteredParameter=function(e,t,r){var i=this;if((e=[].concat(e))[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The msb value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.sendControlChange(6,e[0],t,{time:r})}),e[1]=Math.floor(e[1]),0<=e[1]&&e[1]<=127&&n.toMIDIChannels(t).forEach(function(){i.sendControlChange(38,e[1],t,{time:r})}),this},i.prototype._deselectRegisteredParameter=function(e,t){var r=this;return n.toMIDIChannels(e).forEach(function(){r.sendControlChange(101,127,e,{time:t}),r.sendControlChange(100,127,e,{time:t})}),this},i.prototype.setRegisteredParameter=function(e,t,r,i){var o=this;if(i=i||{},!Array.isArray(e)){if(!n.MIDI_REGISTERED_PARAMETER[e])throw new Error("The specified parameter is not available.");e=n.MIDI_REGISTERED_PARAMETER[e]}return n.toMIDIChannels(r).forEach(function(){o._selectRegisteredParameter(e,r,i.time),o._setCurrentRegisteredParameter(t,r,i.time),o._deselectRegisteredParameter(r,i.time)}),this},i.prototype.setNonRegisteredParameter=function(e,t,r,i){var o=this;if(i=i||{},!(0<=e[0]&&e[0]<=127&&0<=e[1]&&e[1]<=127))throw new Error("Position 0 and 1 of the 2-position parameter array must both be between 0 and 127.");return t=[].concat(t),n.toMIDIChannels(r).forEach(function(){o._selectNonRegisteredParameter(e,r,i.time),o._setCurrentRegisteredParameter(t,r,i.time),o._deselectRegisteredParameter(r,i.time)}),this},i.prototype.incrementRegisteredParameter=function(e,t,r){var i=this;if(r=r||{},!Array.isArray(e)){if(!n.MIDI_REGISTERED_PARAMETER[e])throw new Error("The specified parameter is not available.");e=n.MIDI_REGISTERED_PARAMETER[e]}return n.toMIDIChannels(t).forEach(function(){i._selectRegisteredParameter(e,t,r.time),i.sendControlChange(96,0,t,{time:r.time}),i._deselectRegisteredParameter(t,r.time)}),this},i.prototype.decrementRegisteredParameter=function(e,t,r){if(r=r||{},!Array.isArray(e)){if(!n.MIDI_REGISTERED_PARAMETER[e])throw new TypeError("The specified parameter is not available.");e=n.MIDI_REGISTERED_PARAMETER[e]}return n.toMIDIChannels(t).forEach(function(){this._selectRegisteredParameter(e,t,r.time),this.sendControlChange(97,0,t,{time:r.time}),this._deselectRegisteredParameter(t,r.time)}.bind(this)),this},i.prototype.setPitchBendRange=function(e,t,r,i){var o=this;if(i=i||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The cents value must be between 0 and 127");return n.toMIDIChannels(r).forEach(function(){o.setRegisteredParameter("pitchbendrange",[e,t],r,{time:i.time})}),this},i.prototype.setModulationRange=function(e,t,r,i){var o=this;if(i=i||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The cents value must be between 0 and 127");return n.toMIDIChannels(r).forEach(function(){o.setRegisteredParameter("modulationrange",[e,t],r,{time:i.time})}),this},i.prototype.setMasterTuning=function(e,t,r){var i=this;if(r=r||{},(e=parseFloat(e)||0)<=-65||64<=e)throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");var o=Math.floor(e)+64,a=e-Math.floor(e),s=(a=Math.round((a+1)/2*16383))>>7&127,u=127&a;return n.toMIDIChannels(t).forEach(function(){i.setRegisteredParameter("channelcoarsetuning",o,t,{time:r.time}),i.setRegisteredParameter("channelfinetuning",[s,u],t,{time:r.time})}),this},i.prototype.setTuningProgram=function(e,t,r){var i=this;if(r=r||{},!(0<=(e=Math.floor(e))&&e<=127))throw new RangeError("The program value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.setRegisteredParameter("tuningprogram",e,t,{time:r.time})}),this},i.prototype.setTuningBank=function(e,t,r){var i=this;if(r=r||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The bank value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.setRegisteredParameter("tuningbank",e,t,{time:r.time})}),this},i.prototype.sendChannelMode=function(e,t,r,i){if(i=i||{},"string"==typeof e){if(!(e=n.MIDI_CHANNEL_MODE_MESSAGES[e]))throw new TypeError("Invalid channel mode message name.")}else if(!(120<=(e=Math.floor(e))&&e<=127))throw new RangeError("Channel mode numerical identifiers must be between 120 and 127.");if((t=Math.floor(t)||0)<0||127<t)throw new RangeError("Value must be an integer between 0 and 127.");return n.toMIDIChannels(r).forEach(function(r){this.send((n.MIDI_CHANNEL_MESSAGES.channelmode<<4)+(r-1),[e,t],this._parseTimeParameter(i.time))}.bind(this)),this},i.prototype.sendProgramChange=function(e,t,r){var i=this;if(r=r||{},e=Math.floor(e),isNaN(e)||e<0||127<e)throw new RangeError("Program numbers must be between 0 and 127.");return n.toMIDIChannels(t).forEach(function(t){i.send((n.MIDI_CHANNEL_MESSAGES.programchange<<4)+(t-1),[e],i._parseTimeParameter(r.time))}),this},i.prototype.sendChannelAftertouch=function(e,t,r){var i=this;r=r||{},e=parseFloat(e),(isNaN(e)||e<0||1<e)&&(e=.5);var o=Math.round(127*e);return n.toMIDIChannels(t).forEach(function(e){i.send((n.MIDI_CHANNEL_MESSAGES.channelaftertouch<<4)+(e-1),[o],i._parseTimeParameter(r.time))}),this},i.prototype.sendPitchBend=function(e,t,r){var i=this;if(r=r||{},isNaN(e)||e<-1||1<e)throw new RangeError("Pitch bend value must be between -1 and 1.");var o=Math.round((e+1)/2*16383),a=o>>7&127,s=127&o;return n.toMIDIChannels(t).forEach(function(e){i.send((n.MIDI_CHANNEL_MESSAGES.pitchbend<<4)+(e-1),[s,a],i._parseTimeParameter(r.time))}),this},i.prototype._parseTimeParameter=function(e){var t,r=parseFloat(e);return"string"==typeof e&&"+"===e.substring(0,1)?r&&0<r&&(t=n.time+r):r>n.time&&(t=r),t},i.prototype._convertNoteToArray=function(e){var t=[];return Array.isArray(e)||(e=[e]),e.forEach(function(e){t.push(n.guessNoteNumber(e))}),t},"function"==typeof Q&&"object"==typeof Q.amd?Q([],function(){return n}):o?o=n:e.WebMidi||(e.WebMidi=n)}(o);const md={anim:100,pad:1,margin:0,hlOn:{fill:"#E83015"},bgOn:{fill:"#CCCCCC"},bgOff:{fill:"#CCCCCC"},fgOn:{fill:"#E83015"},fgOff:{fill:"#fff"},floor:1},nd=["filter",{id:"blur"},["feGaussianBlur",{in:"SourceGraphic",stdDeviation:".25"}]],S=(t={})=>{const s=Object.assign(Object.assign({r:5},md),t),{r:e,pad:i,margin:n,glyph:a,floor:c}=s,g=e*Math.pow(.5,2),l=e+i,r=l+n,$=2*l+2*n,o={width:$,height:$*c},b={transition:`all ${s.anim}ms ease-out`},O={cx:r,cy:r},f=Object.assign(Object.assign(Object.assign({},s.hlOn),O),{r:l}),j=Object.assign(Object.assign(Object.assign({},s.bgOn),O),{style:b,r:e}),T=Object.assign(Object.assign({},j),s.bgOff),p=Object.assign(Object.assign(Object.assign({},s.fgOn),O),{style:b,r:g}),G=Object.assign(Object.assign({},p),s.fgOff),Y=Object.assign(Object.assign({},s.fgOn),{x:"50%",y:"50%","text-anchor":"middle","alignment-baseline":"central",font:"bold sans-serif","font-size":.5*$,style:b}),h=Object.assign(Object.assign({},Y),s.fgOff);return(t,s,e,i)=>["svg",Object.assign(Object.assign({},o),s),nd,["g",["circle",i?f:{}],["circle",e?j:T],a?["text",e?Y:h,a]:["circle",e?p:G]]]};const pd=Db({element:"h2",attribs:{class:"#000"}});const Xa=(t,s,e={})=>(i,n)=>["a",Object.assign(Object.assign({},e),{onclick:t,disabled:n}),s];const rd=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],sd=f(b($=>jd($)),j(),rd);let T=f(D({raw:b($=>$),tonicMidi:b($=>Ia($.tonic+"2")%12),musicKey:b($=>$.tonic),normalizedMidis:b($=>f(b($=>Ia($+"2")%12),C(),$.scale))}),j(),sd);console.log(T);const Za=[...Cb(!1,12)],c=new ma({enabledMidi:!1,midiDevices:[],keyState:Za,highlights:new Set,size:[window.innerWidth,window.innerHeight]}),V=$=>{c.resetIn(["keyState",$],!c.deref().keyState[$])},Pa=$=>{c.resetIn(["highlights"],$)};window.addEventListener("resize",()=>{c.resetIn(["size"],[window.innerWidth,window.innerHeight])});const Ta={class:"mr3 pv2 ph2 bg-black white f4"},hd=()=>{const $=Xa(()=>void c.resetIn(["keyState"],Za),"Clear",Ta),e=Xa(()=>void c.resetIn(["keyState"],[...ca(12,Bb([!0,!1],[.5,.5]))]),"Random",Ta);return()=>["div.mv4",[$],[e]]},P={anim:0,r:16,pad:2},ad=Object.assign(Object.assign({},P),{glyph:"C"}),Tc=Object.assign(Object.assign({},P),{bgOn:{fill:"#000"},bgOff:{fill:"#000"},floor:2}),Sc=$=>{const e=c.deref();return()=>["div.mb4",...e.keyState.map((i,t)=>[4===t?"div.dib.mr4":"div.dib",[0===t?S(Object.assign(Object.assign({},ad),$)):new Set([2,4,5,7,9,11]).has(t)?S(Object.assign(Object.assign({},P),$)):S(Object.assign(Object.assign({},Tc),$)),{class:"pointer mr0",onclick:()=>V(t)},i,e.highlights.has(t)]])]},Nc=($,e)=>{const i={width:e,height:e/35,rx:5,fill:"#e2e2e2"};return()=>["div.dib",...$.map(($,t)=>["div.mv2.mr2",{onmouseover:()=>Pa($.normalizedMidis),onmouseout:()=>void Pa(new Set)},["div",$.musicKey,["small"," maj"]],["div",["svg",{width:1.1*e,height:e/35},["g",["rect",i],$.common.size?["rect",Object.assign(Object.assign({},i),{width:$.similarity*e,fill:"#000"})]:[]]]]])]},Ja=()=>{var $iFCn$$interop$default=J(o);$iFCn$$interop$default.d.inputs.forEach($=>$.addListener("noteon","all",e=>{V(e.note.number%12),console.log(`Received 'noteon' message (${e.note.name+e.note.octave}) from ${$.name}`)}))},vb=$=>{var $iFCn$$interop$default=J(o);"All Devices"!==$?($iFCn$$interop$default.d.inputs.forEach($=>$.removeListener()),$iFCn$$interop$default.d.getInputByName($).addListener("noteon","all",e=>{V(e.note.number%12),console.log(`Received 'noteon' message (${e.note.name+e.note.octave}) from ${$}`)})):Ja()};var $a=J(o);$a.d.enable($=>{$?console.log("WebMidi could not be enabled.",$):(console.log("WebMidi enabled!"),c.resetIn(["enabledMidi"],!0),c.resetIn(["midiDevices"],$a.d.inputs.map($=>$.name)),Ja())});const Id=Uc(()=>{const $=c.deref(),e=$.enabledMidi;let i=$.midiDevices;i.length>0&&i.unshift("All Devices");const t=$.keyState,B=$.size,d=Math.min(36,.9*B[0]/13),r=Math.min(400,.9*B[0]);let a=f(b($=>t[$]?$:null),C(),ib(12)),o=f(b($=>F($.normalizedMidis,a)),j(),T),n=f(D({musicKey:b($=>$[0].musicKey),normalizedMidis:b($=>$[0].normalizedMidis),common:b($=>$[1]),similarity:b($=>$[1].size/a.size+(a.has($[0].tonicMidi)?.1:0))}),j(),kb(T,o));return n=n.sort(($,e)=>e.similarity-$.similarity),["div",[pd,"OP-Z KEY FINDER"],["div",["p",e?"Web MIDI is available : )":"Web MIDI is unavailable : ("],i.length>1?[Wc,{onchange:$=>vb($.target.value)},f(b($=>[$,$]),j(),new Set(i))]:[]],hd,["div",Sc({r:d/2*(8/9),pad:d/2*(1/9)}),Nc(n,r)]]});return{"B6dB":{}};});