parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function Aa(a){return a&&a.__esModule?{d:a.default}:{d:a}}var yd=function(){return yd=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},yd.apply(this,arguments)};function Mb(e,t,r,n){var o,a=arguments.length,$=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)$=Reflect.decorate(e,t,r,n);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&($=(a<3?o($):a>3?o(t,r,$):o(t,r))||$);return a>3&&$&&Object.defineProperty(t,r,$),$}var a=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function Nb(e){return this instanceof Nb?(this.v=e,this):new Nb(e)}var b=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};const zd=e=>null!=e&&"function"==typeof e.deref;const $a=e=>zd(e)?e.deref():e;var Ad,Ob;(function($){$[$.FINE=0]="FINE",$[$.DEBUG=1]="DEBUG",$[$.INFO=2]="INFO",$[$.WARN=3]="WARN",$[$.SEVERE=4]="SEVERE",$[$.NONE=5]="NONE"})(Ob||(Ad=Ob={},Ad));var Bd=false;const ma=Symbol();const _a=()=>{};const Cd="*";function Pb(){if(Bd)return;Bd=true}var Dd=(Pb(),{});const na=void 0===Dd?(r,$="assertion failed")=>{if("function"==typeof r&&!r()||!r)throw new Error("function"==typeof $?$():$)}:_a;const Ed=Object.freeze({level:Ob.NONE,fine(){},debug(){},info(){},warn(){},severe(){}});const Qb=(e,t={})=>{const o=Reflect.ownKeys(e),r=Reflect.ownKeys(t),n=Symbol("isa");function i(t){for(let r of o){const o=Object.getOwnPropertyDescriptor(t.prototype,r);!o||o.configurable?Object.defineProperty(t.prototype,r,{value:e[r],writable:!0}):console.log(`not patching: ${t.name}.${r.toString()}`)}return Object.defineProperty(t.prototype,n,{value:!0}),t}for(let p of r)Object.defineProperty(i,p,{value:t[p],enumerable:t.propertyIsEnumerable(p)});return Object.defineProperty(i,Symbol.hasInstance,{value:e=>!!e[n]}),i};const Rb=(e,t)=>{if(e)for(let i,r=0,s=e.length;r<s;r++)if((i=e[r])[0].call(i[1],t),t.canceled)return};const Fd=Qb({addListener(e,t,i){let r=(this._listeners=this._listeners||{})[e];return!r&&(r=this._listeners[e]=[]),-1===this.__listener(r,t,i)&&(r.push([t,i]),!0)},removeListener(e,t,i){let r;if(!(r=this._listeners))return!1;const s=r[e];if(s){const n=this.__listener(s,t,i);if(-1!==n)return s.splice(n,1),!s.length&&delete r[e],!0}return!1},notify(e){let t;if(!(t=this._listeners))return!1;void 0===e.target&&(e.target=this),Rb(t[e.id],e),Rb(t[Cd],e)},__listener(e,t,i){let r=e.length;for(;--r>=0;){const s=e[r];if(s[0]===t&&s[1]===i)break}return r}});const Gd=Qb({addWatch(t,e){return this._watches=this._watches||{},!this._watches[t]&&(this._watches[t]=e,!0)},removeWatch(t){if(this._watches)return!!this._watches[t]&&(delete this._watches[t],!0)},notifyWatches(t,e){if(!this._watches)return;const i=this._watches;for(let h in i)i[h](h,t,e)}});const ab=(r,o=r=>void 0!==r?": "+r:"")=>class extends Error{constructor(s){super(r(s)+o(s))}};const Hd=ab(()=>"illegal argument(s)");const Ba=r=>{throw new Hd(r)};const Id=ab(()=>"illegal arity");const ga=r=>{throw new Id(r)};const Jd=ab(()=>"illegal state");const Kd=r=>{throw new Jd(r)};const bb=o=>"function"==typeof o;const ha=(n,t)=>null!=n&&"function"==typeof n[t];const V=Array.isArray;const Sb=t=>null!=t&&"function"!=typeof t&&void 0!==t.length;const Z=t=>"string"==typeof t;const Ld=e=>null!=e&&"function"==typeof e[Symbol.iterator];const Md=$=>$ instanceof Map;const Tb=t=>null!=t&&"string"!=typeof t&&"function"==typeof t[Symbol.iterator];const Ub=Object.getPrototypeOf,Nd=$=>{let r;return null!=$&&"object"==typeof $&&(null===(r=Ub($))||null===Ub(r))};const Od=s=>s instanceof Promise;const Pd=t=>t instanceof Set;const Qd=r=>r&&(r instanceof Float32Array||r instanceof Float64Array||r instanceof Uint32Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Int8Array||r instanceof Uint16Array||r instanceof Int16Array||r instanceof Uint8ClampedArray);const cb=o=>V(o)?o:Z(o)?o.length>0?o.split("."):[]:null!=o?[o]:[];const Rd=e=>db(e);function db(e){const t=cb(e),[r,l,n,$]=t;switch(t.length){case 0:return e=>e;case 1:return e=>null!=e?e[r]:void 0;case 2:return e=>null!=e&&null!=(e=e[r])?e[l]:void 0;case 3:return e=>null!=e&&null!=(e=e[r])&&null!=(e=e[l])?e[n]:void 0;case 4:return e=>null!=e&&null!=(e=e[r])&&null!=(e=e[l])&&null!=(e=e[n])?e[$]:void 0;default:return e=>{const r=t.length-1;let l=e;for(let n=0;null!=l&&n<=r;n++)l=l[t[n]];return l};}}const Sd=$=>Ca($);function Ca($){const e=cb($),[t,r,o,p]=e;switch(e.length){case 0:return($,e)=>e;case 1:return($,e)=>($=W($),$[t]=e,$);case 2:return($,e)=>{let o;return($=W($))[t]=o=W($[t]),o[r]=e,$};case 3:return($,e)=>{let p,c;return($=W($))[t]=p=W($[t]),p[r]=c=W(p[r]),c[o]=e,$};case 4:return($,e)=>{let c,C,G;return($=W($))[t]=c=W($[t]),c[r]=C=W(c[r]),C[o]=G=W(C[o]),G[p]=e,$};default:let $;for(let t=e.length;--t>=0;)$=Td(e[t],$);return $;}}const W=$=>V($)||Qd($)?$.slice():Object.assign({},$);const Td=($,e)=>(t,r)=>(t=W(t),t[$]=e?e(t[$],r):r,t);const Da=(e,$,t,...r)=>Ud(e,$,t,...r);function Ud(e,$,t,...r){return Ca($)(e,t.apply(null,(r.unshift(db($)(e)),r)))}const eb=(e,$,t)=>Ca($)(e,t);const Vd=(e,$)=>Wd(e,$);function Wd(e,$){const r=db(e),t=Ca(e);return(e,...a)=>t(e,$.apply(null,(a.unshift(r(e)),a)))}let fb=class{constructor(e,t){t&&!t(e)&&Kd("initial state value did not validate"),this._value=e,this.valid=t}get value(){return this._value}set value(e){this.reset(e)}deref(){return this._value}equiv(e){return this===e}reset(e){const t=this._value;return this.valid&&!this.valid(e)?t:(this._value=e,this.notifyWatches(t,e),e)}resetIn(e,t){return this.reset(eb(this._value,e,t))}resetInUnsafe(e,t){return this.reset(eb(this._value,e,t))}swap(e,...t){return this.reset(e.apply(null,[this._value,...t]))}swapIn(e,t,...r){return this.reset(Da(this._value,e,t,...r))}swapInUnsafe(e,t,...r){return this.reset(Da(this._value,e,t,...r))}addWatch(e,t){}removeWatch(e){}notifyWatches(e,t){}release(){return delete this._watches,delete this._value,!0}};fb=Mb([Gd],fb);let Xd=0;const Yd=()=>Xd++;const Vb=Object.getPrototypeOf({}),Y=(e,t)=>{let $;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=($=Object.getPrototypeOf(e))&&$!==Vb||null!=($=Object.getPrototypeOf(t))&&$!==Vb?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?Wb(e,t):e instanceof Set&&t instanceof Set?Xb(e,t):e instanceof Map&&t instanceof Map?Yb(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:Zb(e,t)))};const Wb=(e,t,$=Y)=>{let o=e.length;if(o===t.length)for(;--o>=0&&$(e[o],t[o]););return o<0};const Xb=(e,t,$=Y)=>e.size===t.size&&$([...e.keys()].sort(),[...t.keys()].sort());const Yb=(e,t,$=Y)=>e.size===t.size&&$([...e].sort(),[...t].sort());const Zb=(e,t,$=Y)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let o in e)if(!t.hasOwnProperty(o)||!$(e[o],t[o]))return!1;return!0};function $b(t,e,i,s,r){return new Zd(t,e,i,s,r)}class Zd{constructor(t,e,i,s=!0,r=Y){this.parent=t,this.id=`view-${Yd()}`,this.tx=i||(t=>t),this.path=cb(e),this.isDirty=!0,this.isLazy=s;const $=Rd(this.path),h=this.parent.deref();this.unprocessed=h?$(h):void 0,s||(this.state=this.tx(this.unprocessed),this.unprocessed=void 0),t.addWatch(this.id,(t,e,i)=>{const h=e?$(e):e,o=i?$(i):i;r(o,h)||(s?this.unprocessed=o:this.state=this.tx(o),this.isDirty=!0)})}get value(){return this.deref()}deref(){return this.isDirty&&(this.isLazy&&(this.state=this.tx(this.unprocessed),this.unprocessed=void 0),this.isDirty=!1),this.state}changed(){return this.isDirty}view(){return this.isDirty&&this.isLazy?this.tx(this.unprocessed):this.state}release(){return this.unprocessed=void 0,this.isLazy||(this.state=this.tx(void 0)),this.isDirty=!0,this.parent.removeWatch(this.id)}}let gb,hb;var $d,X;(function($){$[$.ONLY_DISTANCE=0]="ONLY_DISTANCE",$[$.ONLY_DISTANCE_LINEAR=1]="ONLY_DISTANCE_LINEAR",$[$.ONLY_DISTANCE_LINEAR_ONLY_CHANGES=2]="ONLY_DISTANCE_LINEAR_ONLY_CHANGES",$[$.FULL=3]="FULL"})(X||($d=X={},$d));let _d=[],ae=[];const be=r=>gb&&gb.length>=r?gb:gb=new Int32Array(r),ce=r=>hb&&hb.length>=r?hb:hb=new Int32Array(r);const _b=(r,$,e,a,t)=>{const c=$.length,l=r.linear;if(r.distance=c,t!==X.ONLY_DISTANCE){for(let r=0,e=0;r<c;r++,e+=3)l[e]=a,l[e+1]=r,l[e+2]=$[r];if(t===X.FULL){const a=r[e];for(let r=0;r<c;r++)a[r]=$[r]}}return r},de=(r,$,e=X.FULL,a=Y)=>{const t={distance:0,adds:{},dels:{},const:{},linear:[]};if(r===$||null==r&&null==$)return t;if(null==r||0===r.length)return _b(t,$,"adds",1,e);if(null==$||0===$.length)return _b(t,r,"dels",-1,e);const c=r.length>=$.length;let l,h,n,o;c?(l=$,h=r):(l=r,h=$),n=l.length,o=h.length;const d=n+1,i=o-n,s=i+d,z=n+o+3,J=ce(z).fill(-1,0,z),f=be(z).fill(-1,0,z),v=_d,p=ae,u=(r,$,e)=>{let t,c;$>e?(t=J[r-1],c=$):(t=J[r+1],c=e);let i=c-(r-d);for(;i<n&&c<o&&a(l[i],h[c]);)i++,c++;J[r]=p.length/3,p.push(i,c,t),f[r]=c};let P,_=-1;do{for(P=-++_+d;P<s;P++)u(P,f[P-1]+1,f[P+1]);for(P=s+_;P>s;P--)u(P,f[P-1]+1,f[P+1]);u(s,f[s-1]+1,f[s+1])}while(f[s]!==o);if(t.distance=i+2*_,e!==X.ONLY_DISTANCE){for(_=3*J[s];_>=0;)v.push(_),_=3*p[_+2];e===X.FULL?ee(v,p,t,l,h,c):fe(v,p,t,l,h,c,e===X.ONLY_DISTANCE_LINEAR)}return v.length=0,p.length=0,t};const ee=(r,$,e,a,t,c)=>{const l=e.linear,h=e.const;let n,o,d,i,s=r.length,z=0,J=0;for(c?(n=e.dels,o=e.adds,d=-1,i=1):(n=e.adds,o=e.dels,d=1,i=-1);--s>=0;){const e=r[s],c=$[e],f=$[e+1],v=f-c;for(;z<c||J<f;){const r=J-z;v>r?(l.push(d,J,n[J]=t[J]),J++):v<r?(l.push(i,z,o[z]=a[z]),z++):(l.push(0,z,h[z]=a[z]),z++,J++)}}},fe=(r,$,e,a,t,c,l)=>{const h=e.linear,n=c?-1:1,o=c?1:-1;let d=r.length,i=0,s=0;for(;--d>=0;){const e=r[d],c=$[e],z=$[e+1],J=z-c;for(;i<c||s<z;){const r=s-i;J>r?(h.push(n,s,t[s]),s++):J<r?(h.push(o,i,a[i]),i++):(l&&h.push(0,i,a[i]),i++,s++)}}};const ge=(t,$,e=X.FULL,i=Y)=>t===$?{distance:0}:e===X.ONLY_DISTANCE?he(t,$,i):ie(t,$,i);const he=(t,$,e)=>{t||(t={}),$||($={});let i=0;for(let r in t){const f=$[r];(void 0===f||!e(t[r],f))&&i++}for(let r in $)!(r in t)&&i++;return{distance:i}},ie=(t,$,e)=>{t||(t={}),$||($={});let i=0;const r=[],f=[],o=[];for(let O in t){const r=$[O];void 0===r?(f.push(O),i++):e(t[O],r)||(o.push(O,r),i++)}for(let O in $)O in t||(r.push(O),i++);return{distance:i,adds:r,dels:f,edits:o}};const Ea=Array.isArray,je=Math.max,ac=Object.getPrototypeOf({}),bc=(()=>{const e=new Array(2048);for(let t=2,$=e.length;t<$;t++)e[t]=t-2;return e})(),ke=e=>{if(e<=bc.length)return bc.slice(0,e);const t=new Array(e);for(;--e>=2;)t[e]=e-2;return t},cc=(e,t,$,r,i,o=0)=>{const n=i[1];if(n.__skip)return;if(!1===n.__diff)return oa(r),void t.replaceChild(e,$,o,i);const f=r[1];if(f&&f.__skip)return void t.replaceChild(e,$,o,i,!1);let s=n.__impl;if(s&&s!==t)return s.diffTree(e,s,$,r,i,o);const a=de(r,i,X.ONLY_DISTANCE_LINEAR,pa);if(0===a.distance)return;const h=a.linear,T=t.getChild($,o);let l,p,K,Q;if(0!==h[0]||r[1].key!==n.key)return oa(r),void t.replaceChild(e,$,o,i);if((Q=r.__release)&&Q!==i.__release&&oa(r),0!==h[3]&&(pe(t,T,r[1],i[1]),2===a.distance))return;const v=h.length,d=r.length-1,u=qe(h),c=ke(d+1);for(l=2,p=6;p<v;l++,p+=3)(K=h[p])&&(-1===K?le(e,t,T,r,i,h,p,u,c,d):me(e,t,T,h,p,u,c,d));(Q=i.__init)&&Q!=r.__init&&Q.apply(i,[T,...i.__args])};const le=(e,t,$,r,i,o,n,f,s,a)=>{const h=o[n+2];if(Ea(h)){let T=h[1].key;if(void 0!==T&&void 0!==f[T][2]){const o=f[T];T=o[0],cc(e,t,$,r[T],i[o[2]],s[T])}else{const e=o[n+1];oa(h),t.removeChild($,s[e]),ne(s,a,e)}}else"string"==typeof h&&t.setContent($,"")},me=(e,t,$,r,i,o,n,f)=>{const s=r[i+2];if("string"==typeof s)t.setContent($,s);else if(Ea(s)){const a=s[1].key;if(void 0===a||void 0===o[a][0]){const o=r[i+1];t.createTree(e,$,s,n[o]),oe(n,f,o)}}},ne=(e,t,$)=>{for(;t>$;t--)e[t]=je(e[t]-1,0)},oe=(e,t,$)=>{for(;t>=$;t--)e[t]++},pe=(e,t,$,r)=>{const i=ge($,r,X.FULL,Y);e.removeAttribs(t,i.dels,$);let o,n,f,s=ma;for(o=(f=i.edits).length;(o-=2)>=0;)"o"===(n=f[o])[0]&&"n"===n[1]&&e.removeAttribs(t,[n],$),"value"!==n?e.setAttrib(t,n,f[o+1],r):s=f[o+1];for(o=(f=i.adds).length;--o>=0;)"value"!==(n=f[o])?e.setAttrib(t,n,r[n],r):s=r[n];s!==ma&&e.setAttrib(t,"value",s,r)};const oa=e=>{if(Ea(e)){let t;if((t=e[1])&&!1===t.__release)return;for(e.__release&&(e.__release.apply(e.__this,e.__args),delete e.__release),t=e.length;--t>=2;)oa(e[t])}};const qe=e=>{let t,$,r;const i={};for(let o=e.length;(o-=3)>=0;)$=e[o+2],Ea($)&&void 0!==(t=$[1].key)&&(!(r=i[t])&&(i[t]=r=[,,]),r[e[o]+1]=e[o+1]);return i},pa=(e,t)=>{let $;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=($=Object.getPrototypeOf(e))&&$!==ac||null!=($=Object.getPrototypeOf(t))&&$!==ac?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?Wb(e,t,pa):e instanceof Set&&t instanceof Set?Xb(e,t,pa):e instanceof Map&&t instanceof Map?Yb(e,t,pa):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:!(!1===e.__diff||!1===t.__diff)&&Zb(e,t,pa)))};const re={"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&apos;"};const se=/^([^\s\.#]+)(?:#([^\s\.#]+))?(?:\.([^\s#]+))?$/;const c=new RegExp(`[${Object.keys(re).join("")}]`,"g");const te={button:1,option:1,script:1,style:1,text:1,textarea:1,title:1};const dc=e=>e.split(" ").reduce((e,t)=>(e[t]=!0,e),{}),ue=dc("animate animateColor animateMotion animateTransform circle clipPath color-profile defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font foreignObject g image line linearGradient marker mask metadata mpath path pattern polygon polyline radialGradient rect set stop style svg switch symbol text textPath title tref tspan use view");const d=dc("area base br circle col command ellipse embed hr img input keygen line link meta param path polygon polyline rect source stop track use wbr ?xml");const ec=(e,r)=>{if(null==(r=$a(r)))return e;if(Z(r))return e+" "+r;const $=new Set(e.split(" "));for(let t in r)$a(r[t])?$.add(t):$.delete(t);return[...$].join(" ")};const ve=$=>{let t,r="";for(let e in $)t=$a($[e]),bb(t)&&(t=t($)),null!=t&&(r+=`${e}:${t};`);return r};const we=(e,t)=>{if(null==e||!t||!t.length)return e;const r=Object.assign({},e);for(let n of t){const e=r[n];ha(e,"deref")&&(r[n]=e.deref())}return r};const xe=e=>Object.keys(e).reduce((r,$)=>(r.push(`${$}: ${e[$]}`),r),[]).join(" ");const ye="http://www.w3.org/2000/svg";const Fa=V,fc=Tb,gc=Z,hc=(e,t)=>t.__init&&t.__init.apply(t.__this,[e,...t.__args]),Ga=(e,t,r,s,$,n=!0)=>{if(Fa(s)){const o=s[0];if("function"==typeof o)return Ga(e,t,r,o.apply(null,[e.ctx,...s.slice(1)]),$);const i=s[1];if(i.__impl)return i.__impl.createTree(e,r,s,$,n);const a=t.createElement(r,o,i,$);if(s.length>2){const r=s.length;for(let $=2;$<r;$++)Ga(e,t,a,s[$],void 0,n)}return n&&hc(a,s),a}if(fc(s)){const o=[];for(let i of s)o.push(Ga(e,t,r,i,$,n));return o}return null==s?r:t.createTextElement(r,s)};const Ha=(e,t,r,s,$=0)=>{if(Fa(s)){const n=t.getChild(r,$);"function"==typeof s[0]&&Ha(e,t,r,s[0].apply(null,[e.ctx,...s.slice(1)]),$);const o=s[1];if(o.__impl)return o.__impl.hydrateTree(e,r,s,$);hc(n,s);for(let e in o)"o"===e[0]&&"n"===e[1]&&t.setAttrib(n,e,o[e]);for(let r=s.length,$=2;$<r;$++)Ha(e,t,n,s[$],$-2)}else if(fc(s))for(let n of s)Ha(e,t,r,n,$),$++};const ze=(e,t,r,s)=>{const $=ue[t]?document.createElementNS(ye,t):document.createElement(t);return r&&Ee($,r),ic(e,$,s)};const Ae=(e,t,r)=>ic(e,document.createTextNode(t),r);const ic=(e,t,r)=>e?void 0===r?e.appendChild(t):e.insertBefore(t,e.children[r]):t;const Be=(e,t)=>e.children[t];const Ce=(e,t,r,s,$,n=!0)=>(t.removeChild(r,s),t.createTree(e,r,$,s,n));const De=(e,t)=>e.textContent=t;const Ee=(e,t)=>{for(let r in t)jc(e,r,t[r],t);return e};const jc=(e,t,r,s)=>{if(t.startsWith("__"))return;const $="o"===t[0]&&"n"===t[1];if($||"function"!=typeof r||(r=r(s)),void 0!==r&&!1!==r)switch(t){case"style":He(e,r);break;case"value":Fe(e,r);break;case"prefix":e.setAttribute(t,gc(r)?r:xe(r));break;case"accesskey":e.accessKey=r;break;case"contenteditable":e.contentEditable=r;break;case"tabindex":e.tabIndex=r;break;case"align":case"autocapitalize":case"checked":case"dir":case"draggable":case"hidden":case"id":case"lang":case"namespaceURI":case"scrollTop":case"scrollLeft":case"title":e[t]=r;break;default:$?Ie(e,t.substr(2),r):e.setAttribute(t,!0===r?"":r);}else null!=e[t]?e[t]=null:e.removeAttribute(t);return e};const Fe=(e,t)=>{let r;switch(e.type){case"text":case"textarea":case"password":case"search":case"number":case"email":case"url":case"tel":case"date":case"datetime-local":case"time":case"week":case"month":if(void 0!==(r=e.value)&&"string"==typeof t){const s=t.length-(r.length-(e.selectionStart||0));e.value=t,e.selectionStart=e.selectionEnd=s;break}default:e.value=t;}};const Ge=(e,t,r)=>{for(let s=t.length;--s>=0;){const $=t[s];"o"===$[0]&&"n"===$[1]?Je(e,$.substr(2),r[$]):e.hasAttribute($)?e.removeAttribute($):e[$]=null}};const He=(e,t)=>(e.setAttribute("style",ve(t)),e);const Ie=(e,t,r)=>gc(r)?e.setAttribute("on"+t,r):Fa(r)?e.addEventListener(t,...r):e.addEventListener(t,r);const Je=(e,t,r)=>Fa(r)?e.removeEventListener(t,...r):e.removeEventListener(t,r);const Ke=(e,t)=>{const r=e.children[t];void 0!==r&&e.removeChild(r)};const Ia=V,Le=Tb,Me=Nd,Ne=Z,Oe=(e,r)=>{let $,i,t,n,a,o=e[0],l=Me(e[1]);if("string"==typeof o&&($=se.exec(o))||Ba(`${o} is not a valid tag name`),o===(i=$[1])&&l&&(!r||e[1].key))return e;a=l?Object.assign({},e[1]):{},t=$[2],n=$[3],t&&(a.id=t);const s=a.class;return n?(n=n.replace(/\./g," "),a.class=s?ec(n,s):n):s&&(a.class=Ne(s)?s:ec("",s)),a.__skip&&e.length<3?[i,a]:[i,a,...e.slice(l?2:1)]};const Pe=(e,r)=>aa(r,e,e.ctx,[0],!1!==e.keys,!1!==e.span);const aa=(e,r,$,i,t,n)=>{if(null!=e){if(Ia(e)){if(0===e.length)return;let a,o,l=e[1];if(l&&(o=l.__impl)&&(o=o.normalizeTree))return o(r,e);const s=e[0];if("function"==typeof s)return aa(s.apply(null,[$,...e.slice(1)]),r,$,i,t,n);if("function"==typeof s.render){const o=[$,...e.slice(1)];return a=aa(s.render.apply(s,o),r,$,i,t,n),Ia(a)&&(a.__this=s,a.__init=s.init,a.__release=s.release,a.__args=o),a}if(!1===(l=(a=Oe(e,t))[1]).__normalize)return a;if(t&&void 0===l.key&&(l.key=i.join("-")),a.length>2){const e=a[0],o=[e,l];n=n&&!te[e];for(let l=2,s=2,x=0,C=a.length;l<C;l++){let e=a[l];if(null!=e){const a=Ia(e);if(a&&Ia(e[0])||!a&&Le(e))for(let l of e)void 0!==(l=aa(l,r,$,i.concat(x),t,n))&&(o[s++]=l),x++;else void 0!==(e=aa(e,r,$,i.concat(x),t,n))&&(o[s++]=e),x++}}return o}return a}return"function"==typeof e?aa(e($),r,$,i,t,n):"function"==typeof e.toHiccup?aa(e.toHiccup(r.ctx),r,$,i,t,n):"function"==typeof e.deref?aa(e.deref(),r,$,i,t,n):n?["span",t?{key:i.join("-")}:{},e.toString()]:e.toString()}};const Qe={createTree(e,t,r,$,i){return Ga(e,this,t,r,$,i)},hydrateTree(e,t,r,$){return Ha(e,this,t,r,$)},diffTree(e,t,r,$,i){cc(e,this,t,r,$,i)},normalizeTree:Pe,getElementById:e=>document.getElementById(e),getChild:Be,createElement:ze,createTextElement:Ae,replaceChild(e,t,r,$,i){Ce(e,this,t,r,$,i)},removeChild:Ke,setContent:De,removeAttribs:Ge,setAttrib:jc};const Re=(e,o)=>Z(e)?o.getElementById(e):e;const Se=(e,r={},t=Qe)=>{const a=Object.assign({root:"app"},r);let $=[],n=!0;const o=Re(a.root,t),i=()=>{if(n){a.ctx=we(r.ctx,a.autoDerefKeys);const f=t.normalizeTree(a,e);null!=f&&(a.hydrate?(t.hydrateTree(a,o,f),a.hydrate=!1):t.diffTree(a,o,$,f),$=f),n&&requestAnimationFrame(i)}};return requestAnimationFrame(i),()=>n=!1};const ea="--set-value";const Te="--update-value";const Ja="--toggle-value";const ib="--cancel";const Ue="--dispatch";const kc="--dispatch-async";const F="--dispatch-now";const lc="--delay";const Ve="--fetch";const N="--state";const We="--redo";const Xe="--undo";let ia=Ed;class Ye{constructor(t,e){this.handlers={},this.effects={},this.eventQueue=[],this.priorities=[],this.addBuiltIns(),t&&this.addHandlers(t),e&&this.addEffects(e)}addBuiltIns(){this.addEffects({[Ue]:[t=>this.dispatch(t),-999],[kc]:[([t,e,r,s],i,$)=>{const o=this.effects[t];if(o){const t=o(e,i,$);Od(t)?t.then(t=>this.dispatch([r,t])).catch(t=>this.dispatch([s,t])):ia.warn("async effect did not return Promise")}else ia.warn(`skipping invalid async effect: ${t}`)},-999],[lc]:[([t,e])=>new Promise(r=>setTimeout(()=>r(e),t)),1e3],[Ve]:[t=>fetch(t).then(t=>{if(!t.ok)throw new Error(t.statusText);return t}),1e3]})}addHandler(t,e){const r=this.interceptorsFromSpec(e);r.length>0?(this.handlers[t]&&(this.removeHandler(t),ia.warn(`overriding handler for ID: ${t}`)),this.handlers[t]=r):Ba(`no handlers in spec for ID: ${t}`)}addHandlers(t){for(let e in t)this.addHandler(e,t[e])}addEffect(t,e,r=1){this.effects[t]&&(this.removeEffect(t),ia.warn(`overriding effect for ID: ${t}`)),this.effects[t]=e;const s=[t,r],i=this.priorities;for(let $=0;$<i.length;$++)if(s[1]<i[$][1])return void i.splice($,0,s);i.push(s)}addEffects(t){for(let e in t){const r=t[e];V(r)?this.addEffect(e,r[0],r[1]):this.addEffect(e,r)}}instrumentWith(t,e){const r=t.map(mc),s=this.handlers;for(let i of e||Object.keys(s)){const t=s[i];t&&(s[i]=r.concat(t))}}removeHandler(t){delete this.handlers[t]}removeHandlers(t){for(let e of t)this.removeHandler(e)}removeEffect(t){delete this.effects[t];const e=this.priorities;for(let r=e.length-1;r>=0;r--)if(t===e[r][0])return void e.splice(r,1)}removeEffects(t){for(let e of t)this.removeEffect(e)}context(){return this.currCtx}dispatch(...t){this.eventQueue.push(...t)}dispatchNow(...t){(this.currQueue||this.eventQueue).push(...t)}dispatchLater(t,e=17){setTimeout(()=>this.dispatch(t),e)}processQueue(t){if(this.eventQueue.length>0){this.currQueue=[...this.eventQueue],this.eventQueue.length=0,t=this.currCtx=t||{};for(let e of this.currQueue)this.processEvent(t,e);return this.currQueue=this.currCtx=void 0,this.processEffects(t),!0}return!1}processEvent(t,e){const r=this.handlers[e[0]];r?this.processForward(t,r,e)&&this.processReverse(t,r,e):ia.warn(`missing handler for event type: ${e[0].toString()}`)}processForward(t,e,r){let s=!1;for(let i=0,$=e.length;i<$&&!t[ib];i++){const $=e[i];$.pre&&this.mergeEffects(t,$.pre(t[N],r,this,t)),s=s||!!$.post}return s}processReverse(t,e,r){for(let s=e.length;--s>=0&&!t[ib];){const i=e[s];i.post&&this.mergeEffects(t,i.post(t[N],r,this,t))}}processEffects(t){const e=this.effects;for(let r of this.priorities){const s=r[0],i=t[s];void 0!==i&&this.processEffect(t,e,s,i)}}processEffect(t,e,r,s){const i=e[r];if(r!==N)for(let $ of s)i($,this,t);else i(s,this,t)}mergeEffects(t,e){if(e)for(let r in e){const s=e[r];if(null!=s)if(r===N||r===ib)t[r]=s;else if(r===F){if(V(s[0]))for(let t of s)t&&this.dispatchNow(t);else this.dispatchNow(s);}else if(t[r]||(t[r]=[]),V(s[0]))for(let e of s)void 0!==e&&t[r].push(e);else t[r].push(s)}}interceptorsFromSpec(t){return V(t)?t.map(mc):bb(t)?[{pre:t}]:[t]}}class Ze extends Ye{constructor(t,e,r){super(e,r),this.state=t||new fb({})}deref(){return this.state.deref()}addBuiltIns(){super.addBuiltIns(),this.addHandlers({[ea]:(t,[e,[r,s]])=>({[N]:eb(t,r,s)}),[Te]:(t,[e,[r,s,...i]])=>({[N]:Da(t,r,s,...i)}),[Ja]:(t,[e,r])=>({[N]:Da(t,r,t=>!t)}),[Xe]:nc("undo"),[We]:nc("redo")}),this.addEffects({[N]:[t=>this.state.reset(t),-1e3]})}processQueue(t){if(this.eventQueue.length>0){const e=this.state.deref();this.currQueue=[...this.eventQueue],this.eventQueue.length=0,t=this.currCtx=Object.assign(Object.assign({},t),{[N]:e});for(let r of this.currQueue)this.processEvent(t,r);return this.currQueue=this.currCtx=void 0,this.processEffects(t),this.state.deref()!==e}return!1}}const mc=t=>bb(t)?{pre:t}:t,nc=t=>(e,[r,s],i,$)=>{const o=s?s[0]:"history";if(ha($[o],t)){const e=$[o][t]();return{[N]:i.state.deref(),[F]:s?void 0!==e?s[1]:s[2]:void 0}}ia.warn("no history in context")};const $e=(e,$)=>{const t=Sd(e);return(e,[r,o])=>({[N]:t(e,$?$(o):o)})};const _e=(e,$)=>{const t=Vd(e,$);return(e,[$,...r])=>({[N]:t(e,...r)})};const qa="route-changed";let oc=class{constructor(t){if(t.authenticator=t.authenticator||((t,i,r)=>({id:t.id,title:t.title,params:r})),t.prefix=void 0===t.prefix?"/":t.prefix,t.separator=t.separator||"/",this.config=t,na(void 0!==this.routeForID(this.config.defaultRouteID),`missing config for default route: '${this.config.defaultRouteID}'`),t.initialRouteID){const i=this.routeForID(t.initialRouteID);na(void 0!==i,`missing config for initial route: ${this.config.initialRouteID}`),na(!af(i),"initial route MUST not be parametric")}}addListener(t,i,r){}removeListener(t,i,r){}notify(t){}start(){if(this.config.initialRouteID){const t=this.routeForID(this.config.initialRouteID);this.current={id:t.id,title:t.title,params:{}},this.notify({id:qa,value:this.current})}}route(t){"#"===t.charAt(0)&&(t=t.substr(1)),t=t.substr(this.config.prefix.length);const i=this.config.routes,r=t.split(this.config.separator);let e;for(let o=0,a=i.length;o<a;o++){const t=i[o],a=this.matchRoute(r,t);if(a){e=a;break}}if(!e){if(!this.handleRouteFailure())return;const t=this.routeForID(this.config.defaultRouteID);e={id:t.id,title:t.title,params:{}}}return Y(e,this.current)||(this.current=e,this.notify({id:qa,value:e})),e}format(...t){let i,[r,e,o]=t;switch(t.length){case 3:i={id:r,params:e};break;case 2:Z(r)?i={id:r,params:e}:(o=e,i=r);break;case 1:i=Z(r)?{id:r}:r;break;default:ga(t.length);}const a=this.routeForID(i.id);if(a){const t=i.params||{};return(o?"#":"")+this.config.prefix+a.match.map(i=>"?"===i.charAt(0)?null!=(i=t[i.substr(1)])?i:"NULL":i).join(this.config.separator)}Ba(`invalid route ID: ${i.id}`)}routeForID(t){return this.config.routes.find(i=>i.id===t)}matchRoute(t,i){const r=i.match,e=r.length;if(t.length===e){const o={};for(let i=0;i<e;i++){const e=r[i];if("?"===e.charAt(0))o[e.substr(1)]=t[i];else if(t[i]!==e)return}if(i.validate&&!this.validateRouteParams(o,i.validate))return;return i.auth?this.config.authenticator(i,t,o):{id:i.id,title:i.title,params:o}}}validateRouteParams(t,i){for(let r in i)if(void 0!==t[r]){const e=i[r];if(e.coerce&&(t[r]=e.coerce(t[r])),e.check&&!e.check(t[r]))return!1}return!0}handleRouteFailure(){return!0}};oc=Mb([Fd],oc);const af=t=>t.match.some(t=>"?"===t.charAt(0));class bf extends oc{constructor(t){super(t),this.useFragment=!1!==t.useFragment,this.ignoreHashChange=!1}start(){if(window.addEventListener("popstate",this.handlePopChange()),this.useFragment&&window.addEventListener("hashchange",this.handleHashChange()),this.config.initialRouteID){const t=this.routeForID(this.config.initialRouteID);this.route(this.format({id:t.id,title:t.title}))}else this.route(this.useFragment?location.hash:location.pathname)}release(){window.removeEventListener("popstate",this.popHandler),this.useFragment&&window.removeEventListener("hashchange",this.hashHandler)}route(t,e=!0){const i=this.current,r=super.route(t);return r&&!Y(r,i)&&(this.currentPath=this.format(r),e&&history.pushState(this.currentPath,r.title||window.document.title||"",this.currentPath)),r}routeTo(t){this.useFragment&&(location.hash=t),this.route(t)}format(...t){let e;switch(t.length){case 2:e={id:t[0],params:t[1]};break;case 1:e=Z(t[0])?{id:t[0]}:t[0];break;default:ga(t.length);}return super.format(e,this.useFragment)}handlePopChange(){return this.popHandler=this.popHandler||(t=>{this.route(t.state||(this.useFragment?location.hash:location.pathname),!1)}).bind(this)}handleHashChange(){return this.hashHandler=this.hashHandler||(t=>{if(!this.ignoreHashChange){const e=t.newURL.substr(t.newURL.indexOf("#"));e!==this.currentPath&&this.route(e,!1)}}).bind(this)}handleRouteFailure(){return this.ignoreHashChange=!0,location.hash=this.format({id:this.routeForID(this.config.defaultRouteID).id}),this.ignoreHashChange=!1,!0}}const cf=([o,p,$],t)=>["option",{value:o,disabled:!!$,selected:o===t},p];const df=(o,p,$,t)=>["select",p,...$.map(o=>cf(o,t))];function pc(...e){let[r,$,t,o,u,c,p,n,s,a]=e;switch(e.length){case 0:ga(0);case 1:return r;case 2:return(...e)=>r($(...e));case 3:return(...e)=>r($(t(...e)));case 4:return(...e)=>r($(t(o(...e))));case 5:return(...e)=>r($(t(o(u(...e)))));case 6:return(...e)=>r($(t(o(u(c(...e))))));case 7:return(...e)=>r($(t(o(u(c(p(...e)))))));case 8:return(...e)=>r($(t(o(u(c(p(n(...e))))))));case 9:return(...e)=>r($(t(o(u(c(p(n(s(...e)))))))));case 10:default:const G=(...e)=>r($(t(o(u(c(p(n(s(a(...e))))))))));return 10===e.length?G:pc(G,...e.slice(10));}}function ef(...e){const[r,t,n,u,s,a,c,$]=e;switch(e.length){case 1:return e=>[r(e)];case 2:return e=>[r(e),t(e)];case 3:return e=>[r(e),t(e),n(e)];case 4:return e=>[r(e),t(e),n(e),u(e)];case 5:return e=>[r(e),t(e),n(e),u(e),s(e)];case 6:return e=>[r(e),t(e),n(e),u(e),s(e),a(e)];case 7:return e=>[r(e),t(e),n(e),u(e),s(e),a(e),c(e)];case 8:return e=>[r(e),t(e),n(e),u(e),s(e),a(e),c(e),$(e)];default:return r=>{let t=new Array(e.length);for(let n=e.length;--n>=0;)t[n]=e[n](r);return t};}}const ff=e=>((null==e||!e[Symbol.iterator])&&Ba(`value is not iterable: ${e}`),e);const gf=r=>V(r)?r:[...ff(r)];const qc=1/4294967295;class hf{float(t=1){return this.int()*qc*t}norm(t=1){return 2*(this.int()*qc-.5)*t}minmax(t,$){return this.float()*($-t)+t}gaussian(t=10,$=-.5,r=1){let a=0,n=t;for(;n-->0;)a+=this.float(r);return a/t+$}}const jb=Math.random;class jf extends hf{int(){return 4294967295*jb()>>>0}float($=1){return jb()*$}norm($=1){return 2*(jb()-.5)*$}}const rc=new jf;const kf=(e,t,r=rc)=>{const $=e.length;na($>0,"no choices given");const o=e.map(t?(e,r)=>[e,t[r]]:e=>[e,1]).sort((e,t)=>t[1]-e[1]),m=o.reduce((e,t)=>e+t[1],0);return na(m>0,"no choices given"),()=>{const e=r.float(m);let t=m;for(let r=0;r<$;r++)if((t-=o[r][1])<=e)return o[r][0]}};const lf=t=>{const e=Object.assign({element:"h1",attribs:{},subElement:"small",subAttribs:{}},t);return(t,s,r)=>[e.element,e.attribs,s,r?[e.subElement,e.subAttribs,r]:void 0]};const mf={anim:100,pad:1,margin:0,vertical:!1,bgOn:{fill:"#000"},bgOff:{fill:"#999"},fgOn:{fill:"#fff"},fgOff:{fill:"#fff"}};const nf=(s={})=>{const t=Object.assign(Object.assign({w:10,h:10},mf),s),{w:e,h:i,pad:g,margin:a,vertical:n}=t,c=2*a,b=g+a,O=n?e+2*g:2*(e+g),f=n?2*(i+g):i+2*g,r={width:O+c,height:f+c},l={transition:`all ${t.anim}ms ease-out`},$=Object.assign(Object.assign({},t.bgOn),{width:O,height:f,x:a,y:a}),j=Object.assign(Object.assign({},$),t.bgOff),o=Object.assign(Object.assign(Object.assign({},n?{x:b,y:b}:{x:O+a-g-e,y:b}),t.fgOn),{style:l,width:e,height:i}),h=Object.assign(Object.assign(Object.assign({},o),n?{y:f+a-g-i}:{x:b}),t.fgOff);return(s,t,e)=>["svg",Object.assign(Object.assign({},r),t),["rect",e?$:j],["rect",e?o:h]]};function*of($,r){const e=ra($)(H()),t=e[1],s=e[2];for(let i of r){const $=s([],i);if(fa($))return void(yield*Ka(t($.deref())));$.length&&(yield*$)}yield*Ka(t([]))}function*kb($,r){const e=ra($)([_a,_a,($,r)=>r])[2];for(let t of r){let $=e(ma,t);if(fa($))return void(($=Ka($.deref()))!==ma&&(yield $));$!==ma&&(yield $)}}const ra=r=>ha(r,"xform")?r.xform():r;class sa{constructor(e){this.value=e}deref(){return this.value}}const pf=e=>new sa(e);const fa=e=>e instanceof sa;const qf=e=>e instanceof sa?e:new sa(e);const Ka=e=>e instanceof sa?e.deref():e;function H($){return $?[...$]:vf(()=>[],($,r)=>($.push(r),$))}const rf=e=>2===e.length?[void 0,e[1]]:3===e.length?[e[1],e[2]]:ga(e.length);function sf(...e){const r=e[0],$=r[0],u=r[1],t=r[2],c=null==(e=rf(e))[0]?$():e[0],o=e[1];return Ka(u(ha(o,"$reduce")?o.$reduce(t,c):Sb(o)?tf(t,c,o):uf(t,c,o)))}const tf=(e,r,$)=>{for(let u=0,t=$.length;u<t;u++)if(r=e(r,$[u]),fa(r)){r=r.deref();break}return r},uf=(e,r,$)=>{for(let u of $)if(r=e(r,u),fa(r)){r=r.deref();break}return r},vf=(e,r)=>[e,e=>e,r];const sc=($,r,e=kb)=>{const t=r.length-1;return Ld(r[t])?r.length>1?e($.apply(null,r.slice(0,t)),r[t]):e($(),r[0]):void 0};function L(...e){let r,$;switch(e.length){case 4:$=e[3],r=e[2];break;case 3:$=e[2];break;case 2:return q(r=>L(e[0],e[1],r));default:ga(e.length);}return sf(ra(e[0])(e[1]),r,$)}function q(t,r){return r?kb(q(t),r):r=>{const $=r[2];return lb(r,(r,e)=>$(r,t(e)))}}const lb=($,o)=>[$[0],$[1],o];const wf=e=>{const{1:r,2:$}=ra(e)(H());let t=!1;return e=>{if(!t){let p=$([],e);return(t=fa(p))&&(p=r(p.deref())),1===p.length?p[0]:p.length>0?p:void 0}}};function tc(e,t,r){return new xf(e,t,r)}class xf{constructor(e,t,r){void 0===e?(e=0,t=1/0):void 0===t&&(t=e,e=0),r=void 0===r?e<t?1:-1:r,this.from=e,this.to=t,this.step=r}*[Symbol.iterator](){const e=this.step,t=this.to;let r=this.from;if(e>0)for(;r<t;)yield r,r+=e;else if(e<0)for(;r>t;)yield r,r+=e}$reduce(e,t){const r=this.step;if(r>0)for(let o=this.from,$=this.to;o<$&&!fa(t);o+=r)t=e(t,o);else for(let o=this.from,$=this.to;o>$&&!fa(t);o+=r)t=e(t,o);return t}}function*yf(...o){const t=o.map(o=>o[Symbol.iterator]());for(;;){const o=[];for(let e of t){let t=e.next();if(t.done)return;o.push(t.value)}yield o}}function mb(r,$){return $?kb(mb(r),$):$=>{const e=$[2];return lb($,($,t)=>r(t)?e($,t):$)}}function La(...e){return e=e.map(ra),pc.apply(null,e)}function Ma(e,r){return r?of(Ma(e),r):r=>{const $=r[2];let g=e;return lb(r,(e,r)=>--g>0?$(e,r):0===g?qf($(e,r)):pf(e))}}function zf(...$){return q(ef.apply(null,$.map(wf)))}function nb(...$){const e=sc(nb,$);if(e)return e;const[r,p]=$,t=Object.keys(r);return La(zf.apply(null,t.map($=>r[$])),uc(t,p))}function uc(...r){const $=r.length>2&&sc(uc,r);if($)return $;let e=r[0];if(V(e)&&(e=e.reduce((r,$,e)=>(r[$]=e,r),{})),r[1]){const $=Object.keys(e);return q(t=>L(La(q(r=>[r,t[e[r]]]),mb(r=>void 0!==r[1])),r[1],$))}return q(Af(e))}const Af=e=>{const r=Object.keys(e),[t,n,o]=r,[s,c,$]=r.map(r=>e[r]);switch(r.length){case 3:return e=>{const r={};let a;return void 0!==(a=e[$])&&(r[o]=a),void 0!==(a=e[c])&&(r[n]=a),void 0!==(a=e[s])&&(r[t]=a),r};case 2:return e=>{const r={};let o;return void 0!==(o=e[c])&&(r[n]=o),void 0!==(o=e[s])&&(r[t]=o),r};case 1:return e=>{const r={};let n=e[s];return void 0!==n&&(r[t]=n),r};default:return t=>{let n,o;const s={};for(let c=r.length-1;c>=0;c--)n=r[c],void 0!==(o=t[e[n]])&&(s[n]=o);return s};}};function*Bf(e,$=1/0){for(;$-->0;)yield e()}const vc=($,e,r=rc)=>Bf(e?kf(gf($),e,r):()=>$[0|r.float($.length)]);function*Cf(e,o=1/0){for(;o-->0;)yield e}var ob,ta={};!function(e){function t(){if(t.prototype._singleton)throw new Error("WebMidi is a singleton, it cannot be instantiated directly.");(t.prototype._singleton=this)._inputs=[],this._outputs=[],this._userHandlers={},this._stateChangeQueue=[],this._processingStateChange=!1,this._midiInterfaceEvents=["connected","disconnected"],this._nrpnBuffer=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],this._nrpnEventsEnabled=!0,this._nrpnTypes=["entry","increment","decrement"],this._notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this._semitones={C:0,D:2,E:4,F:5,G:7,A:9,B:11},Object.defineProperties(this,{MIDI_SYSTEM_MESSAGES:{value:{sysex:240,timecode:241,songposition:242,songselect:243,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MESSAGES:{value:{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,channelmode:11,nrpn:11,programchange:12,channelaftertouch:13,pitchbend:14},writable:!1,enumerable:!0,configurable:!1},MIDI_REGISTERED_PARAMETER:{value:{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]},writable:!1,enumerable:!0,configurable:!1},MIDI_CONTROL_CHANGE_MESSAGES:{value:{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101},writable:!1,enumerable:!0,configurable:!1},MIDI_NRPN_MESSAGES:{value:{entrymsb:6,entrylsb:38,increment:96,decrement:97,paramlsb:98,parammsb:99,nullactiveparameter:127},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MODE_MESSAGES:{value:{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127},writable:!1,enumerable:!0,configurable:!1},octaveOffset:{value:0,writable:!0,enumerable:!0,configurable:!1}}),Object.defineProperties(this,{supported:{enumerable:!0,get:function(){return"requestMIDIAccess"in navigator}},enabled:{enumerable:!0,get:function(){return void 0!==this.interface}.bind(this)},inputs:{enumerable:!0,get:function(){return this._inputs}.bind(this)},outputs:{enumerable:!0,get:function(){return this._outputs}.bind(this)},sysexEnabled:{enumerable:!0,get:function(){return!(!this.interface||!this.interface.sysexEnabled)}.bind(this)},nrpnEventsEnabled:{enumerable:!0,get:function(){return!!this._nrpnEventsEnabled}.bind(this),set:function(e){return this._nrpnEventsEnabled=e,this._nrpnEventsEnabled}},nrpnTypes:{enumerable:!0,get:function(){return this._nrpnTypes}.bind(this)},time:{enumerable:!0,get:function(){return performance.now()}}})}var n=new t;function r(e){var t=this;this._userHandlers={channel:{},system:{}},this._midiInput=e,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return t._midiInput.connection}},id:{enumerable:!0,get:function(){return t._midiInput.id}},manufacturer:{enumerable:!0,get:function(){return t._midiInput.manufacturer}},name:{enumerable:!0,get:function(){return t._midiInput.name}},state:{enumerable:!0,get:function(){return t._midiInput.state}},type:{enumerable:!0,get:function(){return t._midiInput.type}}}),this._initializeUserHandlers(),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}function i(e){var t=this;this._midiOutput=e,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return t._midiOutput.connection}},id:{enumerable:!0,get:function(){return t._midiOutput.id}},manufacturer:{enumerable:!0,get:function(){return t._midiOutput.manufacturer}},name:{enumerable:!0,get:function(){return t._midiOutput.name}},state:{enumerable:!0,get:function(){return t._midiOutput.state}},type:{enumerable:!0,get:function(){return t._midiOutput.type}}})}t.prototype.enable=function(e,t){this.enabled||(this.supported?navigator.requestMIDIAccess({sysex:t}).then(function(t){var n,r=[],i=[];this.interface=t,this._resetInterfaceUserHandlers(),this.interface.onstatechange=function(e){r.push(e)};for(var o=t.inputs.values(),a=o.next();a&&!a.done;a=o.next())i.push(a.value.open());for(var s=t.outputs.values(),u=s.next();u&&!u.done;u=s.next())i.push(u.value.open());function h(){clearTimeout(n),this._updateInputsAndOutputs(),this.interface.onstatechange=this._onInterfaceStateChange.bind(this),"function"==typeof e&&e.call(this),r.forEach(function(e){this._onInterfaceStateChange(e)}.bind(this))}n=setTimeout(h.bind(this),200),Promise&&Promise.all(i).catch(function(e){}).then(h.bind(this))}.bind(this),function(t){"function"==typeof e&&e.call(this,t)}.bind(this)):"function"==typeof e&&e(new Error("The Web MIDI API is not supported by your browser.")))},t.prototype.disable=function(){if(!this.supported)throw new Error("The Web MIDI API is not supported by your browser.");this.interface&&(this.interface.onstatechange=void 0),this.interface=void 0,this._inputs=[],this._outputs=[],this._nrpnEventsEnabled=!0,this._resetInterfaceUserHandlers()},t.prototype.addListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before adding event listeners.");if("function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(e)))throw new TypeError("The specified event type is not supported.");return this._userHandlers[e].push(t),this},t.prototype.hasListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before checking event listeners.");if("function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(e)))throw new TypeError("The specified event type is not supported.");for(var n=0;n<this._userHandlers[e].length;n++)if(this._userHandlers[e][n]===t)return!0;return!1},t.prototype.removeListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before removing event listeners.");if(void 0!==t&&"function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(0<=this._midiInterfaceEvents.indexOf(e)){if(t)for(var n=0;n<this._userHandlers[e].length;n++)this._userHandlers[e][n]===t&&this._userHandlers[e].splice(n,1);else this._userHandlers[e]=[];}else{if(void 0!==e)throw new TypeError("The specified event type is not supported.");this._resetInterfaceUserHandlers()}return this},t.prototype.toMIDIChannels=function(e){var t;if("all"===e||void 0===e)t=["all"];else{if("none"===e)return[];t=Array.isArray(e)?e:[e]}return-1<t.indexOf("all")&&(t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),t.map(function(e){return parseInt(e)}).filter(function(e){return 1<=e&&e<=16})},t.prototype.getInputById=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");e=String(e);for(var t=0;t<this.inputs.length;t++)if(this.inputs[t].id===e)return this.inputs[t];return!1},t.prototype.getOutputById=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");e=String(e);for(var t=0;t<this.outputs.length;t++)if(this.outputs[t].id===e)return this.outputs[t];return!1},t.prototype.getInputByName=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var t=0;t<this.inputs.length;t++)if(~this.inputs[t].name.indexOf(e))return this.inputs[t];return!1},t.prototype.getOctave=function(e){if(null!=e&&0<=e&&e<=127)return Math.floor(Math.floor(e)/12-1)+Math.floor(n.octaveOffset)},t.prototype.getOutputByName=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var t=0;t<this.outputs.length;t++)if(~this.outputs[t].name.indexOf(e))return this.outputs[t];return!1},t.prototype.guessNoteNumber=function(e){var t=!1;if(e&&e.toFixed&&0<=e&&e<=127?t=Math.round(e):0<=parseInt(e)&&parseInt(e)<=127?t=parseInt(e):("string"==typeof e||e instanceof String)&&(t=this.noteNameToNumber(e)),!1===t)throw new Error("Invalid input value ("+e+").");return t},t.prototype.noteNameToNumber=function(e){"string"!=typeof e&&(e="");var t=e.match(/([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)/i);if(!t)throw new RangeError("Invalid note name.");var r=n._semitones[t[1].toUpperCase()],i=12*(parseInt(t[3])+1-Math.floor(n.octaveOffset))+r;if(-1<t[2].toLowerCase().indexOf("b")?i-=t[2].length:-1<t[2].toLowerCase().indexOf("#")&&(i+=t[2].length),i<0||127<i)throw new RangeError("Invalid note name or note outside valid range.");return i},t.prototype._updateInputsAndOutputs=function(){this._updateInputs(),this._updateOutputs()},t.prototype._updateInputs=function(){for(var e=0;e<this._inputs.length;e++){for(var t=!0,n=this.interface.inputs.values(),i=n.next();i&&!i.done;i=n.next())if(this._inputs[e]._midiInput===i.value){t=!1;break}t&&this._inputs.splice(e,1)}this.interface&&this.interface.inputs.forEach(function(e){for(var t=!0,n=0;n<this._inputs.length;n++)this._inputs[n]._midiInput===e&&(t=!1);t&&this._inputs.push(new r(e))}.bind(this))},t.prototype._updateOutputs=function(){for(var e=0;e<this._outputs.length;e++){for(var t=!0,n=this.interface.outputs.values(),r=n.next();r&&!r.done;r=n.next())if(this._outputs[e]._midiOutput===r.value){t=!1;break}t&&this._outputs.splice(e,1)}this.interface&&this.interface.outputs.forEach(function(e){for(var t=!0,n=0;n<this._outputs.length;n++)this._outputs[n]._midiOutput===e&&(t=!1);t&&this._outputs.push(new i(e))}.bind(this))},t.prototype._onInterfaceStateChange=function(e){this._updateInputsAndOutputs();var t={timestamp:e.timeStamp,type:e.port.state};this.interface&&"connected"===e.port.state?"output"===e.port.type?t.port=this.getOutputById(e.port.id):"input"===e.port.type&&(t.port=this.getInputById(e.port.id)):t.port={connection:"closed",id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this._userHandlers[e.port.state].forEach(function(e){e(t)})},t.prototype._resetInterfaceUserHandlers=function(){for(var e=0;e<this._midiInterfaceEvents.length;e++)this._userHandlers[this._midiInterfaceEvents[e]]=[]},r.prototype.on=r.prototype.addListener=function(e,t,r){var i=this;if(void 0===t&&(t="all"),Array.isArray(t)||(t=[t]),t.forEach(function(e){if("all"!==e&&!(1<=e&&e<=16))throw new RangeError("The 'channel' parameter is invalid.")}),"function"!=typeof r)throw new TypeError("The 'listener' parameter must be a function.");if(void 0!==n.MIDI_SYSTEM_MESSAGES[e])this._userHandlers.system[e]||(this._userHandlers.system[e]=[]),this._userHandlers.system[e].push(r);else{if(void 0===n.MIDI_CHANNEL_MESSAGES[e])throw new TypeError("The specified event type is not supported.");if(-1<t.indexOf("all")){t=[];for(var o=1;o<=16;o++)t.push(o)}this._userHandlers.channel[e]||(this._userHandlers.channel[e]=[]),t.forEach(function(t){i._userHandlers.channel[e][t]||(i._userHandlers.channel[e][t]=[]),i._userHandlers.channel[e][t].push(r)})}return this},r.prototype.hasListener=function(e,t,r){var i=this;if("function"!=typeof r)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===t&&(t="all"),t.constructor!==Array&&(t=[t]),void 0!==n.MIDI_SYSTEM_MESSAGES[e]){for(var o=0;o<this._userHandlers.system[e].length;o++)if(this._userHandlers.system[e][o]===r)return!0}else if(void 0!==n.MIDI_CHANNEL_MESSAGES[e]){if(-1<t.indexOf("all")){t=[];for(var a=1;a<=16;a++)t.push(a)}return!!this._userHandlers.channel[e]&&t.every(function(t){var n=i._userHandlers.channel[e][t];return n&&-1<n.indexOf(r)})}return!1},r.prototype.removeListener=function(e,t,r){var i=this;if(void 0!==r&&"function"!=typeof r)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===t&&(t="all"),t.constructor!==Array&&(t=[t]),void 0!==n.MIDI_SYSTEM_MESSAGES[e]){if(void 0===r)this._userHandlers.system[e]=[];else for(var o=0;o<this._userHandlers.system[e].length;o++)this._userHandlers.system[e][o]===r&&this._userHandlers.system[e].splice(o,1);}else if(void 0!==n.MIDI_CHANNEL_MESSAGES[e]){if(-1<t.indexOf("all")){t=[];for(var a=1;a<=16;a++)t.push(a)}if(!this._userHandlers.channel[e])return this;t.forEach(function(t){var n=i._userHandlers.channel[e][t];if(n)if(void 0===r)i._userHandlers.channel[e][t]=[];else for(var o=0;o<n.length;o++)n[o]===r&&n.splice(o,1)})}else{if(void 0!==e)throw new TypeError("The specified event type is not supported.");this._initializeUserHandlers()}return this},r.prototype._initializeUserHandlers=function(){for(var e in n.MIDI_CHANNEL_MESSAGES)n.MIDI_CHANNEL_MESSAGES.hasOwnProperty(e)&&(this._userHandlers.channel[e]={});for(var t in n.MIDI_SYSTEM_MESSAGES)n.MIDI_SYSTEM_MESSAGES.hasOwnProperty(t)&&(this._userHandlers.system[t]=[])},r.prototype._onMidiMessage=function(e){if(0<this._userHandlers.system.midimessage.length){var t={target:this,data:e.data,timestamp:e.timeStamp,type:"midimessage"};this._userHandlers.system.midimessage.forEach(function(e){e(t)})}e.data[0]<240?(this._parseChannelEvent(e),this._parseNrpnEvent(e)):e.data[0]<=255&&this._parseSystemEvent(e)},r.prototype._parseNrpnEvent=function(e){var t,r,i=e.data[0]>>4,o=15&e.data[0],a=1+o;if(1<e.data.length&&(t=e.data[1],r=2<e.data.length?e.data[2]:void 0),n.nrpnEventsEnabled&&i===n.MIDI_CHANNEL_MESSAGES.controlchange&&(t>=n.MIDI_NRPN_MESSAGES.increment&&t<=n.MIDI_NRPN_MESSAGES.parammsb||t===n.MIDI_NRPN_MESSAGES.entrymsb||t===n.MIDI_NRPN_MESSAGES.entrylsb)){var s={target:this,type:"controlchange",data:e.data,timestamp:e.timeStamp,channel:a,controller:{number:t,name:this.getCcNameByNumber(t)},value:r};if(s.controller.number===n.MIDI_NRPN_MESSAGES.parammsb&&s.value!=n.MIDI_NRPN_MESSAGES.nullactiveparameter)n._nrpnBuffer[o]=[],n._nrpnBuffer[o][0]=s;else if(1===n._nrpnBuffer[o].length&&s.controller.number===n.MIDI_NRPN_MESSAGES.paramlsb)n._nrpnBuffer[o].push(s);else if(2!==n._nrpnBuffer[o].length||s.controller.number!==n.MIDI_NRPN_MESSAGES.increment&&s.controller.number!==n.MIDI_NRPN_MESSAGES.decrement&&s.controller.number!==n.MIDI_NRPN_MESSAGES.entrymsb){if(3===n._nrpnBuffer[o].length&&n._nrpnBuffer[o][2].number===n.MIDI_NRPN_MESSAGES.entrymsb&&s.controller.number===n.MIDI_NRPN_MESSAGES.entrylsb)n._nrpnBuffer[o].push(s);else if(3<=n._nrpnBuffer[o].length&&n._nrpnBuffer[o].length<=4&&s.controller.number===n.MIDI_NRPN_MESSAGES.parammsb&&s.value===n.MIDI_NRPN_MESSAGES.nullactiveparameter)n._nrpnBuffer[o].push(s);else if(4<=n._nrpnBuffer[o].length&&n._nrpnBuffer[o].length<=5&&s.controller.number===n.MIDI_NRPN_MESSAGES.paramlsb&&s.value===n.MIDI_NRPN_MESSAGES.nullactiveparameter){n._nrpnBuffer[o].push(s);var u=[];n._nrpnBuffer[o].forEach(function(e){u.push(e.data)});var h=n._nrpnBuffer[o][0].value<<7|n._nrpnBuffer[o][1].value,l=n._nrpnBuffer[o][2].value;6===n._nrpnBuffer[o].length&&(l=n._nrpnBuffer[o][2].value<<7|n._nrpnBuffer[o][3].value);var p="";switch(n._nrpnBuffer[o][2].controller.number){case n.MIDI_NRPN_MESSAGES.entrymsb:p=n._nrpnTypes[0];break;case n.MIDI_NRPN_MESSAGES.increment:p=n._nrpnTypes[1];break;case n.MIDI_NRPN_MESSAGES.decrement:p=n._nrpnTypes[2];break;default:throw new Error("The NPRN type was unidentifiable.");}var c={timestamp:s.timestamp,channel:s.channel,type:"nrpn",data:u,controller:{number:h,type:p,name:"Non-Registered Parameter "+h},value:l};n._nrpnBuffer[o]=[],this._userHandlers.channel[c.type]&&this._userHandlers.channel[c.type][c.channel]&&this._userHandlers.channel[c.type][c.channel].forEach(function(e){e(c)})}else n._nrpnBuffer[o]=[];}else n._nrpnBuffer[o].push(s)}},r.prototype._parseChannelEvent=function(e){var t,r,i=e.data[0]>>4,o=1+(15&e.data[0]);1<e.data.length&&(t=e.data[1],r=2<e.data.length?e.data[2]:void 0);var a={target:this,data:e.data,timestamp:e.timeStamp,channel:o};i===n.MIDI_CHANNEL_MESSAGES.noteoff||i===n.MIDI_CHANNEL_MESSAGES.noteon&&0===r?(a.type="noteoff",a.note={number:t,name:n._notes[t%12],octave:n.getOctave(t)},a.velocity=r/127,a.rawVelocity=r):i===n.MIDI_CHANNEL_MESSAGES.noteon?(a.type="noteon",a.note={number:t,name:n._notes[t%12],octave:n.getOctave(t)},a.velocity=r/127,a.rawVelocity=r):i===n.MIDI_CHANNEL_MESSAGES.keyaftertouch?(a.type="keyaftertouch",a.note={number:t,name:n._notes[t%12],octave:n.getOctave(t)},a.value=r/127):i===n.MIDI_CHANNEL_MESSAGES.controlchange&&0<=t&&t<=119?(a.type="controlchange",a.controller={number:t,name:this.getCcNameByNumber(t)},a.value=r):i===n.MIDI_CHANNEL_MESSAGES.channelmode&&120<=t&&t<=127?(a.type="channelmode",a.controller={number:t,name:this.getChannelModeByNumber(t)},a.value=r):i===n.MIDI_CHANNEL_MESSAGES.programchange?(a.type="programchange",a.value=t):i===n.MIDI_CHANNEL_MESSAGES.channelaftertouch?(a.type="channelaftertouch",a.value=t/127):i===n.MIDI_CHANNEL_MESSAGES.pitchbend?(a.type="pitchbend",a.value=((r<<7)+t-8192)/8192):a.type="unknownchannelmessage",this._userHandlers.channel[a.type]&&this._userHandlers.channel[a.type][o]&&this._userHandlers.channel[a.type][o].forEach(function(e){e(a)})},r.prototype.getCcNameByNumber=function(e){if(!(0<=(e=Math.floor(e))&&e<=119))throw new RangeError("The control change number must be between 0 and 119.");for(var t in n.MIDI_CONTROL_CHANGE_MESSAGES)if(n.MIDI_CONTROL_CHANGE_MESSAGES.hasOwnProperty(t)&&e===n.MIDI_CONTROL_CHANGE_MESSAGES[t])return t},r.prototype.getChannelModeByNumber=function(e){if(!(120<=(e=Math.floor(e))&&status<=127))throw new RangeError("The control change number must be between 120 and 127.");for(var t in n.MIDI_CHANNEL_MODE_MESSAGES)if(n.MIDI_CHANNEL_MODE_MESSAGES.hasOwnProperty(t)&&e===n.MIDI_CHANNEL_MODE_MESSAGES[t])return t},r.prototype._parseSystemEvent=function(e){var t=e.data[0],r={target:this,data:e.data,timestamp:e.timeStamp};t===n.MIDI_SYSTEM_MESSAGES.sysex?r.type="sysex":t===n.MIDI_SYSTEM_MESSAGES.timecode?r.type="timecode":t===n.MIDI_SYSTEM_MESSAGES.songposition?r.type="songposition":t===n.MIDI_SYSTEM_MESSAGES.songselect?(r.type="songselect",r.song=e.data[1]):t===n.MIDI_SYSTEM_MESSAGES.tuningrequest?r.type="tuningrequest":t===n.MIDI_SYSTEM_MESSAGES.clock?r.type="clock":t===n.MIDI_SYSTEM_MESSAGES.start?r.type="start":t===n.MIDI_SYSTEM_MESSAGES.continue?r.type="continue":t===n.MIDI_SYSTEM_MESSAGES.stop?r.type="stop":t===n.MIDI_SYSTEM_MESSAGES.activesensing?r.type="activesensing":t===n.MIDI_SYSTEM_MESSAGES.reset?r.type="reset":r.type="unknownsystemmessage",this._userHandlers.system[r.type]&&this._userHandlers.system[r.type].forEach(function(e){e(r)})},i.prototype.send=function(e,t,n){if(!(128<=e&&e<=255))throw new RangeError("The status byte must be an integer between 128 (0x80) and 255 (0xFF).");void 0===t&&(t=[]),Array.isArray(t)||(t=[t]);var r=[];return t.forEach(function(e){var t=Math.floor(e);if(!(0<=t&&t<=255))throw new RangeError("Data bytes must be integers between 0 (0x00) and 255 (0xFF).");r.push(t)}),this._midiOutput.send([e].concat(r),parseFloat(n)||0),this},i.prototype.sendSysex=function(e,t,r){if(!n.sysexEnabled)throw new Error("Sysex message support must first be activated.");return r=r||{},e=[].concat(e),t.forEach(function(e){if(e<0||127<e)throw new RangeError("The data bytes of a sysex message must be integers between 0 (0x00) and 127 (0x7F).")}),t=e.concat(t,n.MIDI_SYSTEM_MESSAGES.sysexend),this.send(n.MIDI_SYSTEM_MESSAGES.sysex,t,this._parseTimeParameter(r.time)),this},i.prototype.sendTimecodeQuarterFrame=function(e,t){return t=t||{},this.send(n.MIDI_SYSTEM_MESSAGES.timecode,e,this._parseTimeParameter(t.time)),this},i.prototype.sendSongPosition=function(e,t){t=t||{};var r=(e=Math.floor(e)||0)>>7&127,i=127&e;return this.send(n.MIDI_SYSTEM_MESSAGES.songposition,[r,i],this._parseTimeParameter(t.time)),this},i.prototype.sendSongSelect=function(e,t){if(t=t||{},!(0<=(e=Math.floor(e))&&e<=127))throw new RangeError("The song number must be between 0 and 127.");return this.send(n.MIDI_SYSTEM_MESSAGES.songselect,[e],this._parseTimeParameter(t.time)),this},i.prototype.sendTuningRequest=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.tuningrequest,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendClock=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.clock,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendStart=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.start,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendContinue=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.continue,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendStop=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.stop,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendActiveSensing=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.activesensing,[],this._parseTimeParameter(e.time)),this},i.prototype.sendReset=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.reset,void 0,this._parseTimeParameter(e.time)),this},i.prototype.stopNote=function(e,t,r){if("all"===e)return this.sendChannelMode("allnotesoff",0,t,r);var i=64;return(r=r||{}).rawVelocity?!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=127&&(i=r.velocity):!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=1&&(i=127*r.velocity),this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){this.send((n.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(t-1),[e,Math.round(i)],this._parseTimeParameter(r.time))}.bind(this))}.bind(this)),this},i.prototype.playNote=function(e,t,r){var i,o=64;if((r=r||{}).rawVelocity?!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=127&&(o=r.velocity):!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=1&&(o=127*r.velocity),i=this._parseTimeParameter(r.time),this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){this.send((n.MIDI_CHANNEL_MESSAGES.noteon<<4)+(t-1),[e,Math.round(o)],i)}.bind(this))}.bind(this)),!isNaN(r.duration)){r.duration<=0&&(r.duration=0);var a=64;r.rawVelocity?!isNaN(r.release)&&0<=r.release&&r.release<=127&&(a=r.release):!isNaN(r.release)&&0<=r.release&&r.release<=1&&(a=127*r.release),this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){this.send((n.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(t-1),[e,Math.round(a)],(i||n.time)+r.duration)}.bind(this))}.bind(this))}return this},i.prototype.sendKeyAftertouch=function(e,t,r,i){var o=this;if(i=i||{},t<1||16<t)throw new RangeError("The channel must be between 1 and 16.");(isNaN(r)||r<0||1<r)&&(r=.5);var a=Math.round(127*r);return this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){o.send((n.MIDI_CHANNEL_MESSAGES.keyaftertouch<<4)+(t-1),[e,a],o._parseTimeParameter(i.time))})}),this},i.prototype.sendControlChange=function(e,t,r,i){if(i=i||{},"string"==typeof e){if(void 0===(e=n.MIDI_CONTROL_CHANGE_MESSAGES[e]))throw new TypeError("Invalid controller name.")}else if(!(0<=(e=Math.floor(e))&&e<=119))throw new RangeError("Controller numbers must be between 0 and 119.");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("Controller value must be between 0 and 127.");return n.toMIDIChannels(r).forEach(function(r){this.send((n.MIDI_CHANNEL_MESSAGES.controlchange<<4)+(r-1),[e,t],this._parseTimeParameter(i.time))}.bind(this)),this},i.prototype._selectRegisteredParameter=function(e,t,r){var i=this;if(e[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The control65 value must be between 0 and 127");if(e[1]=Math.floor(e[1]),!(0<=e[1]&&e[1]<=127))throw new RangeError("The control64 value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.sendControlChange(101,e[0],t,{time:r}),i.sendControlChange(100,e[1],t,{time:r})}),this},i.prototype._selectNonRegisteredParameter=function(e,t,r){var i=this;if(e[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The control63 value must be between 0 and 127");if(e[1]=Math.floor(e[1]),!(0<=e[1]&&e[1]<=127))throw new RangeError("The control62 value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.sendControlChange(99,e[0],t,{time:r}),i.sendControlChange(98,e[1],t,{time:r})}),this},i.prototype._setCurrentRegisteredParameter=function(e,t,r){var i=this;if((e=[].concat(e))[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The msb value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.sendControlChange(6,e[0],t,{time:r})}),e[1]=Math.floor(e[1]),0<=e[1]&&e[1]<=127&&n.toMIDIChannels(t).forEach(function(){i.sendControlChange(38,e[1],t,{time:r})}),this},i.prototype._deselectRegisteredParameter=function(e,t){var r=this;return n.toMIDIChannels(e).forEach(function(){r.sendControlChange(101,127,e,{time:t}),r.sendControlChange(100,127,e,{time:t})}),this},i.prototype.setRegisteredParameter=function(e,t,r,i){var o=this;if(i=i||{},!Array.isArray(e)){if(!n.MIDI_REGISTERED_PARAMETER[e])throw new Error("The specified parameter is not available.");e=n.MIDI_REGISTERED_PARAMETER[e]}return n.toMIDIChannels(r).forEach(function(){o._selectRegisteredParameter(e,r,i.time),o._setCurrentRegisteredParameter(t,r,i.time),o._deselectRegisteredParameter(r,i.time)}),this},i.prototype.setNonRegisteredParameter=function(e,t,r,i){var o=this;if(i=i||{},!(0<=e[0]&&e[0]<=127&&0<=e[1]&&e[1]<=127))throw new Error("Position 0 and 1 of the 2-position parameter array must both be between 0 and 127.");return t=[].concat(t),n.toMIDIChannels(r).forEach(function(){o._selectNonRegisteredParameter(e,r,i.time),o._setCurrentRegisteredParameter(t,r,i.time),o._deselectRegisteredParameter(r,i.time)}),this},i.prototype.incrementRegisteredParameter=function(e,t,r){var i=this;if(r=r||{},!Array.isArray(e)){if(!n.MIDI_REGISTERED_PARAMETER[e])throw new Error("The specified parameter is not available.");e=n.MIDI_REGISTERED_PARAMETER[e]}return n.toMIDIChannels(t).forEach(function(){i._selectRegisteredParameter(e,t,r.time),i.sendControlChange(96,0,t,{time:r.time}),i._deselectRegisteredParameter(t,r.time)}),this},i.prototype.decrementRegisteredParameter=function(e,t,r){if(r=r||{},!Array.isArray(e)){if(!n.MIDI_REGISTERED_PARAMETER[e])throw new TypeError("The specified parameter is not available.");e=n.MIDI_REGISTERED_PARAMETER[e]}return n.toMIDIChannels(t).forEach(function(){this._selectRegisteredParameter(e,t,r.time),this.sendControlChange(97,0,t,{time:r.time}),this._deselectRegisteredParameter(t,r.time)}.bind(this)),this},i.prototype.setPitchBendRange=function(e,t,r,i){var o=this;if(i=i||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The cents value must be between 0 and 127");return n.toMIDIChannels(r).forEach(function(){o.setRegisteredParameter("pitchbendrange",[e,t],r,{time:i.time})}),this},i.prototype.setModulationRange=function(e,t,r,i){var o=this;if(i=i||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The cents value must be between 0 and 127");return n.toMIDIChannels(r).forEach(function(){o.setRegisteredParameter("modulationrange",[e,t],r,{time:i.time})}),this},i.prototype.setMasterTuning=function(e,t,r){var i=this;if(r=r||{},(e=parseFloat(e)||0)<=-65||64<=e)throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");var o=Math.floor(e)+64,a=e-Math.floor(e),s=(a=Math.round((a+1)/2*16383))>>7&127,u=127&a;return n.toMIDIChannels(t).forEach(function(){i.setRegisteredParameter("channelcoarsetuning",o,t,{time:r.time}),i.setRegisteredParameter("channelfinetuning",[s,u],t,{time:r.time})}),this},i.prototype.setTuningProgram=function(e,t,r){var i=this;if(r=r||{},!(0<=(e=Math.floor(e))&&e<=127))throw new RangeError("The program value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.setRegisteredParameter("tuningprogram",e,t,{time:r.time})}),this},i.prototype.setTuningBank=function(e,t,r){var i=this;if(r=r||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The bank value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.setRegisteredParameter("tuningbank",e,t,{time:r.time})}),this},i.prototype.sendChannelMode=function(e,t,r,i){if(i=i||{},"string"==typeof e){if(!(e=n.MIDI_CHANNEL_MODE_MESSAGES[e]))throw new TypeError("Invalid channel mode message name.")}else if(!(120<=(e=Math.floor(e))&&e<=127))throw new RangeError("Channel mode numerical identifiers must be between 120 and 127.");if((t=Math.floor(t)||0)<0||127<t)throw new RangeError("Value must be an integer between 0 and 127.");return n.toMIDIChannels(r).forEach(function(r){this.send((n.MIDI_CHANNEL_MESSAGES.channelmode<<4)+(r-1),[e,t],this._parseTimeParameter(i.time))}.bind(this)),this},i.prototype.sendProgramChange=function(e,t,r){var i=this;if(r=r||{},e=Math.floor(e),isNaN(e)||e<0||127<e)throw new RangeError("Program numbers must be between 0 and 127.");return n.toMIDIChannels(t).forEach(function(t){i.send((n.MIDI_CHANNEL_MESSAGES.programchange<<4)+(t-1),[e],i._parseTimeParameter(r.time))}),this},i.prototype.sendChannelAftertouch=function(e,t,r){var i=this;r=r||{},e=parseFloat(e),(isNaN(e)||e<0||1<e)&&(e=.5);var o=Math.round(127*e);return n.toMIDIChannels(t).forEach(function(e){i.send((n.MIDI_CHANNEL_MESSAGES.channelaftertouch<<4)+(e-1),[o],i._parseTimeParameter(r.time))}),this},i.prototype.sendPitchBend=function(e,t,r){var i=this;if(r=r||{},isNaN(e)||e<-1||1<e)throw new RangeError("Pitch bend value must be between -1 and 1.");var o=Math.round((e+1)/2*16383),a=o>>7&127,s=127&o;return n.toMIDIChannels(t).forEach(function(e){i.send((n.MIDI_CHANNEL_MESSAGES.pitchbend<<4)+(e-1),[s,a],i._parseTimeParameter(r.time))}),this},i.prototype._parseTimeParameter=function(e){var t,r=parseFloat(e);return"string"==typeof e&&"+"===e.substring(0,1)?r&&0<r&&(t=n.time+r):r>n.time&&(t=r),t},i.prototype._convertNoteToArray=function(e){var t=[];return Array.isArray(e)||(e=[e]),e.forEach(function(e){t.push(n.guessNoteNumber(e))}),t},"function"==typeof ob&&"object"==typeof ob.amd?ob([],function(){return n}):ta?ta=n:e.WebMidi||(e.WebMidi=n)}(ta);const Df="route-to";const Ef="toggle-debug";const Na="toggle-key-state";const ua="set-key-state";const wc="reset-key-state";const xc="set-random-key-state";const pb="set-highlights";const yc="reset-highlights";const zc="set-size";const Ac="toggle-view-config";const Bc="set-midi-devices";const ja="set-midi-file";const Cc="set-midi-file-error";const Ff="set-comparison";const Dc=e=>{var $iFCn$$interop$default=Aa(ta);$iFCn$$interop$default.d.inputs.forEach(i=>i.addListener("noteon","all",$=>{e.dispatch([Na,$.note.number%12]),console.log(`Received 'noteon' message (${$.note.name+$.note.octave}) from ${i.name}`)}))},Gf=e=>{var $iFCn$$interop$default=Aa(ta);$iFCn$$interop$default.d.enable(i=>{i?console.log("WebMidi could not be enabled.",i):(console.log("WebMidi enabled!"),e.dispatch([Bc,$iFCn$$interop$default.d.inputs.map(e=>e.name)]),Dc(e))})};const Hf=(e,i)=>{var $iFCn$$interop$default=Aa(ta);$iFCn$$interop$default.d.inputs.forEach(e=>e.removeListener()),"All Devices"!==i?$iFCn$$interop$default.d.getInputByName(i).addListener("noteon","all",$=>{e.dispatch([Na,$.note.number%12]),console.log(`Received 'noteon' message (${$.note.name+$.note.octave}) from ${i}`)}):Dc(e)},If=e=>{const i=e.views,$=e.bus;return()=>{const e=i.enabledMidi.deref();let n=i.midiDevices.deref();return["div",e?["span.mid-gray.bg-washed-green.pa1","Web MIDI is available"]:["span.mid-gray.bg-washed-red.pa1","Web MIDI is unavailable"],["span.ml2",n.length>=1?[df,{onchange:e=>Hf($,e.target.value)},L(q(e=>[e,e]),H(),["All Devices",...n])]:[]]]}};const Ec="route-to";class Jf{constructor(t){this.config=t,this.state=new fb(t.initialState||{}),this.ctx={bus:new Ze(this.state,t.events,t.effects),views:{},ui:t.ui},this.addViews(this.config.views),this.router=new bf(t.router),this.router.addListener(qa,t=>this.ctx.bus.dispatch([qa,t.value])),this.ctx.bus.addHandlers({[qa]:$e("route"),[Df]:(t,[e,i])=>({[Ec]:i})}),this.ctx.bus.addEffect(Ec,([t,e])=>this.router.routeTo(this.router.format(t,e))),this.addViews({route:"route",routeComponent:["route.id",t=>(this.config.components[t]||(()=>["div",`missing component for route: ${t}`]))(this.ctx)]})}addViews(t){const e=this.ctx.views;for(let i in t){const r=t[i];e[i]=V(r)?$b(this.state,r[0],r[1]):$b(this.state,r)}}start(){Gf(this.ctx.bus),window.addEventListener("resize",()=>{this.ctx.bus.dispatch([zc])}),this.router.start(),Se(()=>{if(this.ctx.bus.processQueue())return this.rootComponent()},{root:this.config.domRoot,ctx:this.ctx})}rootComponent(){this.ctx.views.debug.deref(),this.ctx.ui;return["div",["div",this.ctx.views.routeComponent]]}}const Fc=(t,n,$={})=>(o,s)=>["a",Object.assign(Object.assign({},$),{onclick:t,disabled:s}),n];const Kf=t=>{const o=t.ui,$=Fc(o=>{o.preventDefault(),t.bus.dispatch([wc])},"Clear",o.toolbar.button),r=Fc(o=>{o.preventDefault(),t.bus.dispatch([xc])},"Random",o.toolbar.button);return()=>["div.mv4",[$],[r]]};const Lf={anim:100,pad:1,margin:0,hlOn:{fill:"#E83015"},bgOn:{fill:"#CCCCCC"},bgOff:{fill:"#CCCCCC"},fgOn:{fill:"#E83015"},fgOff:{fill:"#fff"},floor:1},Mf=["filter",{id:"blur"},["feGaussianBlur",{in:"SourceGraphic",stdDeviation:".25"}]],qb=(s={})=>{const i=Object.assign(Object.assign({r:5},Lf),s),{r:e,pad:t,margin:n,glyph:a,floor:g}=i,c=e*Math.pow(.5,2),l=e+t,O=l+n,r=2*l+2*n,f={width:r,height:r*g},b={transition:`all ${i.anim}ms ease-out`},o={cx:O,cy:O},$=Object.assign(Object.assign(Object.assign({},i.hlOn),o),{r:l}),j=Object.assign(Object.assign(Object.assign({},i.bgOn),o),{style:b,r:e}),C=Object.assign(Object.assign({},j),i.bgOff),E=Object.assign(Object.assign(Object.assign({},i.fgOn),o),{style:b,r:c}),G=Object.assign(Object.assign({},E),i.fgOff),h=Object.assign(Object.assign({},i.fgOn),{x:"50%",y:"50%","text-anchor":"middle","alignment-baseline":"central",font:"bold sans-serif","font-size":.5*r,style:b}),p=Object.assign(Object.assign({},h),i.fgOff);return(s,i,e,t)=>["svg",Object.assign(Object.assign({},f),i),Mf,["g",["circle",t?$:{}],["circle",e?j:C],a?["text",e?h:p,a]:["circle",e?E:G]]]};const rb={anim:0,r:16,pad:2},Nf=Object.assign(Object.assign({},rb),{glyph:"C"}),Of=Object.assign(Object.assign({},rb),{bgOn:{fill:"#000"},bgOff:{fill:"#000"},floor:2}),Pf=i=>{const t=i.views,$=t.size.deref(),e=Math.min(36,.9*$[0]/13),s={r:e/2*(8/9),pad:e/2*(1/9)},r=t.highlights.deref();return["div.mb4",...t.keyState.deref().map((t,$)=>[4===$?"div.dib.mr4":"div.dib",[0===$?qb(Object.assign(Object.assign({},Nf),s)):[2,4,5,7,9,11].includes($)?qb(Object.assign(Object.assign({},rb),s)):qb(Object.assign(Object.assign({},Of),s)),{class:"pointer mr0",onclick:t=>{t.preventDefault(),i.bus.dispatch([Na,$])}},t,r.includes($)]])]};var ba={};const Qf=t=>t[Symbol.iterator]();function*Gc(e,r){let t,$={},i=Qf(e);for(;!(t=i.next()).done;){let e=r?r(t.value):t.value,i=JSON.stringify(e),o=$[i];o?o[1]++:$[i]=[e,1]}yield*Object.keys($).map(e=>$[e])}class Hc{constructor(e){this.value=e}deref(){return this.value}}const Ic=e=>e instanceof Hc;const Rf=e=>e instanceof Hc?e.deref():e;const Sf=e=>2===e.length?[void 0,e[1]]:3===e.length?[e[1],e[2]]:ga(e.length);function Tf(...e){const r=e[0],$=r[0],t=r[1],c=r[2],u=null==(e=Sf(e))[0]?$():e[0],o=e[1];return Rf(t(ha(o,"$reduce")?o.$reduce(c,u):Sb(o)?Uf(c,u,o):Vf(c,u,o)))}const Uf=(e,r,$)=>{for(let t=0,c=$.length;t<c;t++)if(r=e(r,$[t]),Ic(r)){r=r.deref();break}return r},Vf=(e,r,$)=>{for(let t of $)if(r=e(r,t),Ic(r)){r=r.deref();break}return r};function Wf($,e){if(Md($))for(let t of e)$.set(t[0],t[1]);else for(let t of e)$.add(t);return $}const Xf=(e,$)=>ha(e,"empty")?e.empty():new(e[Symbol.species]||$);const Jc=e=>Pd(e)?e:new Set(e);const Yf=(e,$,r)=>r?Tf(e(),r):[()=>null,e=>e||new Set,(e,r)=>e?$(e,Jc(r)):Jc(r)];const sb=(e,t,r)=>{if(r=r||Xf(e,Set),e===t)return Wf(r,e);if(t.size<e.size)return sb(t,e,r);for(let $ of t)e.has($)&&r.add($);return r};function Zf(e){return Yf(Zf,sb,e)}const Oa=($,t)=>Array(Math.abs(t)+1).join($);function $f($,t,e){return function(...r){return console.warn(`${$} is deprecated. Use ${t}.`),e.apply(this,r)}}function tb($){return null!==$&&"object"==typeof $&&"string"==typeof $.name}function ub($){return null!==$&&"object"==typeof $&&"number"==typeof $.step&&"number"==typeof $.alt}const Kc=[0,2,4,-1,1,3,5],Lc=Kc.map($=>Math.floor(7*$/12));function Mc($){const{step:t,alt:e,oct:r,dir:o=1}=$,x=Kc[t]+7*e;return void 0===r?[o*x]:[o*x,o*(r-Lc[t]-4*e)]}const _f=[3,0,4,1,5,2,6];function ag($){const[t,e,r]=$,o=_f[bg(t)],x=Math.floor((t+1)/7);return void 0===e?{step:o,alt:x,dir:r}:{step:o,alt:x,oct:e+4*x+Lc[o],dir:r}}function bg($){const t=($+1)%7;return t<0?7+t:t}const Nc={empty:!0,name:"",pc:"",acc:""},Oc=new Map,cg=$=>"CDEFGAB".charAt($),vb=$=>$<0?Oa("b",-$):Oa("#",$),Pc=$=>"b"===$[0]?-$.length:$.length;function ca($){const t=Oc.get($);if(t)return t;const e="string"==typeof $?hg($):ub($)?ca(ig($)):tb($)?ca($.name):Nc;return Oc.set($,e),e}const dg=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function eg($){const t=dg.exec($);return[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]}function fg($){return ca(ag($))}const gg=($,t)=>($%t+t)%t,wb=[0,2,4,5,7,9,11];function hg($){const t=eg($);if(""===t[0]||""!==t[3])return Nc;const e=t[0],r=t[1],o=t[2],x=(e.charCodeAt(0)+3)%7,n=Pc(r),a=o.length?+o:void 0,I=Mc({step:x,alt:n,oct:a}),c=e+r+o,R=e+r,p=(wb[x]+n+120)%12,k=void 0===a?gg(wb[x]+n,12)-1188:wb[x]+n+12*(a+1),s=k>=0&&k<=127?k:null;return{empty:!1,acc:r,alt:n,chroma:p,coord:I,freq:void 0===a?null:440*Math.pow(2,(k-69)/12),height:k,letter:e,midi:s,name:c,oct:a,pc:R,step:x}}function ig($){const{step:t,alt:e,oct:r}=$,o=cg(t);if(!o)return"";const x=o+vb(e);return r||0===r?x+r:x}const xb={empty:!0,name:"",acc:""},jg=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$");function kg($){const t=jg.exec(`${$}`);return null===t?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}const Qc={};function Pa($){return"string"==typeof $?Qc[$]||(Qc[$]=lg($)):ub($)?Pa(ng($)):tb($)?Pa($.name):xb}const Rc=[0,2,4,5,7,9,11],Sc="PMMPPMM";function lg($){const t=kg($);if(""===t[0])return xb;const e=+t[0],r=t[1],o=(Math.abs(e)-1)%7,x=Sc[o];if("M"===x&&"P"===r)return xb;const n="M"===x?"majorable":"perfectable",a=""+e+r,I=e<0?-1:1,c=8===e||-8===e?e:I*(o+1),R=mg(n,r),p=Math.floor((Math.abs(e)-1)/7);return{empty:!1,name:a,num:e,q:r,step:o,alt:R,dir:I,type:n,simple:c,semitones:I*(Rc[o]+R+12*p),chroma:(I*(Rc[o]+R)%12+12)%12,coord:Mc({step:o,alt:R,oct:p,dir:I}),oct:p}}function mg($,t){return"M"===t&&"majorable"===$||"P"===t&&"perfectable"===$?0:"m"===t&&"majorable"===$?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*("perfectable"===$?t.length:t.length+1):0}function ng($){const{step:t,alt:e,oct:r=0,dir:o}=$;return o?(o<0?"-":"")+(t+1+7*r)+og("M"===Sc[t]?"majorable":"perfectable",e):""}function og($,t){return 0===t?"majorable"===$?"M":"P":-1===t&&"majorable"===$?"m":t>0?Oa("A",t):Oa("d","perfectable"===$?t:t+1)}function Tc($,t){const e=ca($),r=Pa(t);if(e.empty||r.empty)return"";const o=e.coord,x=r.coord;return fg(1===o.length?[o[0]+x[0]]:[o[0]+x[0],o[1]+x[1]]).name}function pg($){return+$>=0&&+$<=127}function Uc($){if(pg($))return+$;const i=ca($);return i.empty?null:i.midi}const e=Math.log(2),f=Math.log(440);const qg="C C# D D# E F F# G G# A A# B".split(" "),rg="C Db D Eb E F Gb G Ab A Bb B".split(" ");function sg($,i={}){if(isNaN($)||$===-1/0||$===1/0)return"";$=Math.round($);const o=(!0===i.sharps?qg:rg)[$%12];return i.pitchClass?o:o+(Math.floor($/12)-1)}const tg=ca;const ug=Vc(!0),g=Vc(!1);function Vc($){return r=>{const e=tg(r);if(e.empty)return"";const P=$?e.alt>0:e.alt<0,t=null===e.midi;return sg(e.midi||e.chroma,{sharps:P,pitchClass:t})}}const Wc={empty:!0,name:"",chordType:""},Xc={};function va($){return"string"==typeof $?Xc[$]||(Xc[$]=yg($)):"number"==typeof $?va(yb[$]||""):ub($)?vg($):tb($)?va($.name):Wc}const h=$f("RomanNumeral.romanNumeral","RomanNumeral.get",va);function vg($){return va(vb($.alt)+yb[$.step])}const wg=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function xg($){return wg.exec($)||["","","",""]}const Yc="I II III IV V VI VII",yb=Yc.split(" "),i=Yc.toLowerCase().split(" ");function yg($){const[e,r,t,a]=xg($);if(!t)return Wc;const o=t.toUpperCase(),y=yb.indexOf(o),k=Pc(r);return{empty:!1,name:e,roman:t,interval:Pa({step:y,alt:k,dir:1}).name,acc:r,chordType:a,alt:k,step:y,major:t===o,oct:0,dir:1}}const Zc=r=>(a,$="")=>a.map((a,o)=>"-"!==a?r[o]+$+a:"");function Qa(r,a,$,o){return e=>{const t=r.split(" "),n=t.map(r=>va(r).interval||""),i=n.map(r=>Tc(e,r)),m=Zc(i);return{tonic:e,grades:t,intervals:n,scale:i,chords:m(a.split(" ")),chordsHarmonicFunction:$.split(" "),chordScales:m(o.split(",")," ")}}}const zg=(r,a)=>{const $=ca(r),o=ca(a);return $.empty||o.empty?0:o.coord[0]-$.coord[0]},Ag=Qa("I II III IV V VI VII","maj7 m7 m7 maj7 7 m7 m7b5","T SD T SD D T D","major,dorian,phrygian,lydian,mixolydian,minor,locrian"),j=Qa("I II bIII IV V bVI bVII","m7 m7b5 maj7 m7 m7 maj7 7","T SD T SD D SD SD","minor,locrian,major,dorian,phrygian,lydian,mixolydian"),k=Qa("I II bIII IV V bVI VII","mmaj7 m7b5 +maj7 m7 7 maj7 mo7","T SD T SD D SD D","harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian"),l=Qa("I II bIII IV V VI VII","m6 m7 +maj7 7 7 m7b5 m7b5","T SD T SD D - -","melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered");function Bg(r){const a=Ag(r),$=zg("C",r),o=Zc(a.scale);return{...a,type:"major",minorRelative:Tc(r,"-3m"),alteration:$,keySignature:vb($),secondaryDominants:o("- VI7 VII7 I7 II7 III7 -".split(" ")),secondaryDominantsMinorRelative:o("- IIIm7b5 IV#m7 Vm7 VIm7 VIIm7b5 -".split(" ")),substituteDominants:o("- bIII7 IV7 bV7 bVI7 bVII7 -".split(" ")),substituteDominantsMinorRelative:o("- IIIm7 Im7 IIbm7 VIm7 IVm7 -".split(" "))}}var Cg={};function Dg(e){var r=new D(e),t=r.readChunk();if("MThd"!=t.id)throw"Bad MIDI file.  Expected 'MHdr', got: '"+t.id+"'";for(var a=Eg(t.data),n=[],s=0;!r.eof()&&s<a.numTracks;s++){var o=r.readChunk();if("MTrk"!=o.id)throw"Bad MIDI file.  Expected 'MTrk', got: '"+o.id+"'";var i=Fg(o.data);n.push(i)}return{header:a,tracks:n}}function Eg(e){var r=new D(e),t={format:r.readUInt16(),numTracks:r.readUInt16()},a=r.readUInt16();return 32768&a?(t.framesPerSecond=256-(a>>8),t.ticksPerFrame=255&a):t.ticksPerBeat=a,t}function Fg(e){for(var r,t=new D(e),a=[];!t.eof();){var n=s();a.push(n)}return a;function s(){var e={};e.deltaTime=t.readVarInt();var a=t.readUInt8();if(240==(240&a)){if(255!==a){if(240==a){e.type="sysEx";s=t.readVarInt();return e.data=t.readBytes(s),e}if(247==a){e.type="endSysEx";s=t.readVarInt();return e.data=t.readBytes(s),e}throw"Unrecognised MIDI event type byte: "+a}e.meta=!0;var n=t.readUInt8(),s=t.readVarInt();switch(n){case 0:if(e.type="sequenceNumber",2!==s)throw"Expected length for sequenceNumber event is 2, got "+s;return e.number=t.readUInt16(),e;case 1:return e.type="text",e.text=t.readString(s),e;case 2:return e.type="copyrightNotice",e.text=t.readString(s),e;case 3:return e.type="trackName",e.text=t.readString(s),e;case 4:return e.type="instrumentName",e.text=t.readString(s),e;case 5:return e.type="lyrics",e.text=t.readString(s),e;case 6:return e.type="marker",e.text=t.readString(s),e;case 7:return e.type="cuePoint",e.text=t.readString(s),e;case 32:if(e.type="channelPrefix",1!=s)throw"Expected length for channelPrefix event is 1, got "+s;return e.channel=t.readUInt8(),e;case 33:if(e.type="portPrefix",1!=s)throw"Expected length for portPrefix event is 1, got "+s;return e.port=t.readUInt8(),e;case 47:if(e.type="endOfTrack",0!=s)throw"Expected length for endOfTrack event is 0, got "+s;return e;case 81:if(e.type="setTempo",3!=s)throw"Expected length for setTempo event is 3, got "+s;return e.microsecondsPerBeat=t.readUInt24(),e;case 84:if(e.type="smpteOffset",5!=s)throw"Expected length for smpteOffset event is 5, got "+s;var o=t.readUInt8();return e.frameRate={0:24,32:25,64:29,96:30}[96&o],e.hour=31&o,e.min=t.readUInt8(),e.sec=t.readUInt8(),e.frame=t.readUInt8(),e.subFrame=t.readUInt8(),e;case 88:if(e.type="timeSignature",4!=s)throw"Expected length for timeSignature event is 4, got "+s;return e.numerator=t.readUInt8(),e.denominator=1<<t.readUInt8(),e.metronome=t.readUInt8(),e.thirtyseconds=t.readUInt8(),e;case 89:if(e.type="keySignature",2!=s)throw"Expected length for keySignature event is 2, got "+s;return e.key=t.readInt8(),e.scale=t.readUInt8(),e;case 127:return e.type="sequencerSpecific",e.data=t.readBytes(s),e;default:return e.type="unknownMeta",e.data=t.readBytes(s),e.metatypeByte=n,e;}}else{var i;if(0==(128&a)){if(null===r)throw"Running status byte encountered before status byte";i=a,a=r,e.running=!0}else i=t.readUInt8(),r=a;var d=a>>4;switch(e.channel=15&a,d){case 8:return e.type="noteOff",e.noteNumber=i,e.velocity=t.readUInt8(),e;case 9:var u=t.readUInt8();return e.type=0===u?"noteOff":"noteOn",e.noteNumber=i,e.velocity=u,0===u&&(e.byte9=!0),e;case 10:return e.type="noteAftertouch",e.noteNumber=i,e.amount=t.readUInt8(),e;case 11:return e.type="controller",e.controllerType=i,e.value=t.readUInt8(),e;case 12:return e.type="programChange",e.programNumber=i,e;case 13:return e.type="channelAftertouch",e.amount=i,e;case 14:return e.type="pitchBend",e.value=i+(t.readUInt8()<<7)-8192,e;default:throw"Unrecognised MIDI event type: "+d;}}}}function D(e){this.buffer=e,this.bufferLen=this.buffer.length,this.pos=0}D.prototype.eof=function(){return this.pos>=this.bufferLen},D.prototype.readUInt8=function(){var e=this.buffer[this.pos];return this.pos+=1,e},D.prototype.readInt8=function(){var e=this.readUInt8();return 128&e?e-256:e},D.prototype.readUInt16=function(){return(this.readUInt8()<<8)+this.readUInt8()},D.prototype.readInt16=function(){var e=this.readUInt16();return 32768&e?e-65536:e},D.prototype.readUInt24=function(){return(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},D.prototype.readInt24=function(){var e=this.readUInt24();return 8388608&e?e-16777216:e},D.prototype.readUInt32=function(){return(this.readUInt8()<<24)+(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},D.prototype.readBytes=function(e){var r=this.buffer.slice(this.pos,this.pos+e);return this.pos+=e,r},D.prototype.readString=function(e){var r=this.readBytes(e);return String.fromCharCode.apply(null,r)},D.prototype.readVarInt=function(){for(var e=0;!this.eof();){var r=this.readUInt8();if(!(128&r))return e+r;e+=127&r,e<<=7}return e},D.prototype.readChunk=function(){var e=this.readString(4),r=this.readUInt32();return{id:e,length:r,data:this.readBytes(r)}},Cg=Dg;var Gg={};function Hg(t,e){if("object"!=typeof t)throw"Invalid MIDI data";e=e||{};var r,n=t.header||{},i=t.tracks||[],a=i.length,w=new B;for(Ig(w,n,a),r=0;r<a;r++)Jg(w,i[r],e);return w.buffer}function Ig(t,e,r){var n=null==e.format?1:e.format,i=128;e.timeDivision?i=e.timeDivision:e.ticksPerFrame&&e.framesPerSecond?i=-(255&e.framesPerSecond)<<8|255&e.ticksPerFrame:e.ticksPerBeat&&(i=32767&e.ticksPerBeat);var a=new B;a.writeUInt16(n),a.writeUInt16(r),a.writeUInt16(i),t.writeChunk("MThd",a.buffer)}function Jg(t,e,r){var n,i=new B,a=e.length,w=null;for(n=0;n<a;n++)!1!==r.running&&(r.running||e[n].running)||(w=null),w=Kg(i,e[n],w,r.useByte9ForNoteOff);t.writeChunk("MTrk",i.buffer)}function Kg(t,e,r,n){var i=e.type,a=e.deltaTime,w=e.text||"",I=e.data||[],o=null;switch(t.writeVarInt(a),i){case"sequenceNumber":t.writeUInt8(255),t.writeUInt8(0),t.writeVarInt(2),t.writeUInt16(e.number);break;case"text":t.writeUInt8(255),t.writeUInt8(1),t.writeVarInt(w.length),t.writeString(w);break;case"copyrightNotice":t.writeUInt8(255),t.writeUInt8(2),t.writeVarInt(w.length),t.writeString(w);break;case"trackName":t.writeUInt8(255),t.writeUInt8(3),t.writeVarInt(w.length),t.writeString(w);break;case"instrumentName":t.writeUInt8(255),t.writeUInt8(4),t.writeVarInt(w.length),t.writeString(w);break;case"lyrics":t.writeUInt8(255),t.writeUInt8(5),t.writeVarInt(w.length),t.writeString(w);break;case"marker":t.writeUInt8(255),t.writeUInt8(6),t.writeVarInt(w.length),t.writeString(w);break;case"cuePoint":t.writeUInt8(255),t.writeUInt8(7),t.writeVarInt(w.length),t.writeString(w);break;case"channelPrefix":t.writeUInt8(255),t.writeUInt8(32),t.writeVarInt(1),t.writeUInt8(e.channel);break;case"portPrefix":t.writeUInt8(255),t.writeUInt8(33),t.writeVarInt(1),t.writeUInt8(e.port);break;case"endOfTrack":t.writeUInt8(255),t.writeUInt8(47),t.writeVarInt(0);break;case"setTempo":t.writeUInt8(255),t.writeUInt8(81),t.writeVarInt(3),t.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":t.writeUInt8(255),t.writeUInt8(84),t.writeVarInt(5);var U=31&e.hour|{24:0,25:32,29:64,30:96}[e.frameRate];t.writeUInt8(U),t.writeUInt8(e.min),t.writeUInt8(e.sec),t.writeUInt8(e.frame),t.writeUInt8(e.subFrame);break;case"timeSignature":t.writeUInt8(255),t.writeUInt8(88),t.writeVarInt(4),t.writeUInt8(e.numerator);var s=255&Math.floor(Math.log(e.denominator)/Math.LN2);t.writeUInt8(s),t.writeUInt8(e.metronome),t.writeUInt8(e.thirtyseconds||8);break;case"keySignature":t.writeUInt8(255),t.writeUInt8(89),t.writeVarInt(2),t.writeInt8(e.key),t.writeUInt8(e.scale);break;case"sequencerSpecific":t.writeUInt8(255),t.writeUInt8(127),t.writeVarInt(I.length),t.writeBytes(I);break;case"unknownMeta":null!=e.metatypeByte&&(t.writeUInt8(255),t.writeUInt8(e.metatypeByte),t.writeVarInt(I.length),t.writeBytes(I));break;case"sysEx":t.writeUInt8(240),t.writeVarInt(I.length),t.writeBytes(I);break;case"endSysEx":t.writeUInt8(247),t.writeVarInt(I.length),t.writeBytes(I);break;case"noteOff":(o=(!1!==n&&e.byte9||n&&0==e.velocity?144:128)|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteOn":(o=144|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteAftertouch":(o=160|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.noteNumber),t.writeUInt8(e.amount);break;case"controller":(o=176|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.controllerType),t.writeUInt8(e.value);break;case"programChange":(o=192|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.programNumber);break;case"channelAftertouch":(o=208|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.amount);break;case"pitchBend":(o=224|e.channel)!==r&&t.writeUInt8(o);var c=8192+e.value,$=127&c,l=c>>7&127;t.writeUInt8($),t.writeUInt8(l);break;default:throw"Unrecognized event type: "+i;}return o}function B(){this.buffer=[]}B.prototype.writeUInt8=function(t){this.buffer.push(255&t)},B.prototype.writeInt8=B.prototype.writeUInt8,B.prototype.writeUInt16=function(t){var e=t>>8&255,r=255&t;this.writeUInt8(e),this.writeUInt8(r)},B.prototype.writeInt16=B.prototype.writeUInt16,B.prototype.writeUInt24=function(t){var e=t>>16&255,r=t>>8&255,n=255&t;this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(n)},B.prototype.writeInt24=B.prototype.writeUInt24,B.prototype.writeUInt32=function(t){var e=t>>24&255,r=t>>16&255,n=t>>8&255,i=255&t;this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(n),this.writeUInt8(i)},B.prototype.writeInt32=B.prototype.writeUInt32,B.prototype.writeBytes=function(t){this.buffer=this.buffer.concat(Array.prototype.slice.call(t,0))},B.prototype.writeString=function(t){var e,r=t.length,n=[];for(e=0;e<r;e++)n.push(t.codePointAt(e));this.writeBytes(n)},B.prototype.writeVarInt=function(t){if(t<0)throw"Cannot write negative variable-length integer";if(t<=127)this.writeUInt8(t);else{var e=t,r=[];for(r.push(127&e),e>>=7;e;){var n=127&e|128;r.push(n),e>>=7}this.writeBytes(r.reverse())}},B.prototype.writeChunk=function(t,e){this.writeString(t),this.writeUInt32(e.length),this.writeBytes(e)},Gg=Hg;var zb={};function $c(r,e,$){void 0===$&&($="ticks");var o=0,t=r.length,s=t;if(t>0&&r[t-1][$]<=e)return t-1;for(;o<s;){var a=Math.floor(o+(s-o)/2),i=r[a],n=r[a+1];if(i[$]===e){for(var v=a;v<r.length;v++){r[v][$]===e&&(a=v)}return a}if(i[$]<e&&n[$]>e)return a;i[$]>e?s=a:i[$]<e&&(o=a+1)}return-1}Object.defineProperty(zb,"__esModule",{value:!0});var Ra=$c;function Lg(r,e,$){if(void 0===$&&($="ticks"),r.length){var o=$c(r,e[$],$);r.splice(o+1,0,e)}else r.push(e)}zb.search=Ra;var Sa=Lg;zb.insert=Sa;var Ab={};Object.defineProperty(Ab,"__esModule",{value:!0});var Ta=new WeakMap,Bb=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];Ab.keySignatureKeys=Bb;var Mg=function(){function t(t){var e=this;this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",Ta.set(this,480),t&&(Ta.set(this,t.header.ticksPerBeat),t.tracks[0].forEach(function(t){t.meta&&("timeSignature"===t.type?e.timeSignatures.push({ticks:t.absoluteTime,timeSignature:[t.numerator,t.denominator]}):"setTempo"===t.type?e.tempos.push({bpm:6e7/t.microsecondsPerBeat,ticks:t.absoluteTime}):"keySignature"===t.type?e.keySignatures.push({key:Bb[t.key+7],scale:0===t.scale?"major":"minor",ticks:t.absoluteTime}):"trackName"===t.type?e.name=t.text:"endOfTrack"!==t.type&&e.meta.push({text:t.text,ticks:t.absoluteTime,type:t.type}))}),this.update())}return t.prototype.update=function(){var t=this,e=0,i=0;this.tempos.sort(function(t,e){return t.ticks-e.ticks}),this.tempos.forEach(function(r,s){var a=s>0?t.tempos[s-1].bpm:t.tempos[0].bpm,n=r.ticks/t.ppq-i,p=60/a*n;r.time=p+e,e=r.time,i+=n}),this.timeSignatures.sort(function(t,e){return t.ticks-e.ticks}),this.timeSignatures.forEach(function(e,i){var r=i>0?t.timeSignatures[i-1]:t.timeSignatures[0],s=(e.ticks-r.ticks)/t.ppq/r.timeSignature[0]/(r.timeSignature[1]/4);r.measures=r.measures||0,e.measures=s+r.measures})},t.prototype.ticksToSeconds=function(t){var e=Ra(this.tempos,t);if(-1!==e){var i=this.tempos[e],r=i.time,s=(t-i.ticks)/this.ppq;return r+60/i.bpm*s}return .5*(t/this.ppq)},t.prototype.ticksToMeasures=function(t){var e=Ra(this.timeSignatures,t);if(-1!==e){var i=this.timeSignatures[e],r=(t-i.ticks)/this.ppq;return i.measures+r/(i.timeSignature[0]/i.timeSignature[1])/4}return t/this.ppq/4},Object.defineProperty(t.prototype,"ppq",{get:function(){return Ta.get(this)},enumerable:!0,configurable:!0}),t.prototype.secondsToTicks=function(t){var e=Ra(this.tempos,t,"time");if(-1!==e){var i=this.tempos[e],r=(t-i.time)/(60/i.bpm);return Math.round(i.ticks+r*this.ppq)}var s=t/.5;return Math.round(s*this.ppq)},t.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(t){return{bpm:t.bpm,ticks:t.ticks}}),timeSignatures:this.timeSignatures}},t.prototype.fromJSON=function(t){this.name=t.name,this.tempos=t.tempos.map(function(t){return Object.assign({},t)}),this.timeSignatures=t.timeSignatures.map(function(t){return Object.assign({},t)}),this.keySignatures=t.keySignatures.map(function(t){return Object.assign({},t)}),this.meta=t.meta.map(function(t){return Object.assign({},t)}),Ta.set(this,t.ppq),this.update()},t.prototype.setTempo=function(t){this.tempos=[{bpm:t,ticks:0}],this.update()},t}(),Ua=Mg;Ab.Header=Ua;var Cb={};function Ng(r){if(!Array.isArray(r))throw new TypeError("Expected value to be an array");return _c(r)}function _c(r){return bd(r,[])}function Og(r,t){if(!Array.isArray(r))throw new TypeError("Expected value to be an array");return ad(r,t)}function ad(r,t){if("number"!=typeof t)throw new TypeError("Expected the depth to be a number");return cd(r,[],t)}function bd(r,t){for(var e=0;e<r.length;e++){var $=r[e];Array.isArray($)?bd($,t):t.push($)}return t}function cd(r,t,e){e--;for(var $=0;$<r.length;$++){var a=r[$];e>-1&&Array.isArray(a)?cd(a,t,e):t.push(a)}return t}(Cb=Ng).from=_c,Cb.depth=Og,Cb.fromDepth=ad;var ka={},Db=ka&&ka.__spreadArrays||function(){for(var e=0,a=0,r=arguments.length;a<r;a++)e+=arguments[a].length;var t=Array(e),o=0;for(a=0;a<r;a++)for(var n=arguments[a],$=0,i=n.length;$<i;$++,o++)t[o]=n[$];return t},Pg=ka&&ka.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ka,"__esModule",{value:!0});var Qg=Pg(Cb);function Rg(e,a){return[{absoluteTime:e.ticks,channel:a,deltaTime:0,noteNumber:e.midi,type:"noteOn",velocity:Math.floor(127*e.velocity)},{absoluteTime:e.ticks+e.durationTicks,channel:a,deltaTime:0,noteNumber:e.midi,type:"noteOff",velocity:Math.floor(127*e.noteOffVelocity)}]}function Sg(e){return Qg.default(e.notes.map(function(a){return Rg(a,e.channel)}))}function Tg(e,a){return{absoluteTime:e.ticks,channel:a,controllerType:e.number,deltaTime:0,type:"controller",value:e.value}}function Ug(e){for(var a=[],r=0;r<127;r++)e.controlChanges.hasOwnProperty(r)&&e.controlChanges[r].forEach(function(r){a.push(Tg(r,e.channel))});return a}function Vg(e,a){return{absoluteTime:e.ticks,channel:a,deltaTime:0,type:"pitchBend",value:e.value}}function Wg(e){var a=[];return e.pitchBends.forEach(function(r){a.push(Vg(r,e.channel))}),a}function Xg(e){return{absoluteTime:0,channel:e.channel,deltaTime:0,programNumber:e.instrument.number,type:"programChange"}}function Yg(e){return{absoluteTime:0,deltaTime:0,meta:!0,text:e,type:"trackName"}}function Zg(e){return{absoluteTime:e.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/e.bpm),type:"setTempo"}}function $g(e){return{absoluteTime:e.ticks,deltaTime:0,denominator:e.timeSignature[1],meta:!0,metronome:24,numerator:e.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function _g(e){var a=Bb.indexOf(e.key);return{absoluteTime:e.ticks,deltaTime:0,key:a+7,meta:!0,scale:"major"===e.scale?0:1,type:"keySignature"}}function ah(e){return{absoluteTime:e.ticks,deltaTime:0,meta:!0,text:e.text,type:e.type}}function bh(e){var a={header:{format:1,numTracks:e.tracks.length+1,ticksPerBeat:e.header.ppq},tracks:Db([Db([{absoluteTime:0,deltaTime:0,meta:!0,text:e.header.name,type:"trackName"}],e.header.keySignatures.map(function(e){return _g(e)}),e.header.meta.map(function(e){return ah(e)}),e.header.tempos.map(function(e){return Zg(e)}),e.header.timeSignatures.map(function(e){return $g(e)}))],e.tracks.map(function(e){return Db([Yg(e.name),Xg(e)],Sg(e),Ug(e),Wg(e))}))};return a.tracks=a.tracks.map(function(e){e=e.sort(function(e,a){return e.absoluteTime-a.absoluteTime});var a=0;return e.forEach(function(e){e.deltaTime=e.absoluteTime-a,a=e.absoluteTime,delete e.absoluteTime}),e.push({deltaTime:0,meta:!0,type:"endOfTrack"}),e}),new Uint8Array(Gg(a))}var dd=bh;ka.encode=dd;var Va={};Object.defineProperty(Va,"__esModule",{value:!0});var wa={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"};Va.controlChangeNames=wa;var xa=Object.keys(wa).reduce(function(e,t){return e[wa[t]]=t,e},{});Va.controlChangeIds=xa;var Eb=new WeakMap,ed=new WeakMap,ch=function(){function e(e,t){Eb.set(this,t),ed.set(this,e.controllerType),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(e.prototype,"number",{get:function(){return ed.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return wa[this.number]?wa[this.number]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return Eb.get(this).ticksToSeconds(this.ticks)},set:function(e){var t=Eb.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},e}(),fd=ch;Va.ControlChange=fd;var gd={};Object.defineProperty(gd,"__esModule",{value:!0});function dh(){return new Proxy({},{get:function(r,e){return r[e]?r[e]:xa.hasOwnProperty(e)?r[xa[e]]:void 0},set:function(r,e,o){return xa.hasOwnProperty(e)?r[xa[e]]=o:r[e]=o,!0}})}var hd=dh;gd.createControlChanges=hd;var id={};Object.defineProperty(id,"__esModule",{value:!0});var Fb=new WeakMap,eh=function(){function e(e,t){Fb.set(this,t),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(e.prototype,"time",{get:function(){return Fb.get(this).ticksToSeconds(this.ticks)},set:function(e){var t=Fb.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},e}(),jd=eh;id.PitchBend=jd;var Wa={};Object.defineProperty(Wa,"__esModule",{value:!0});var Gb=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"];Wa.instrumentByPatchID=Gb;var kd=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"];Wa.InstrumentFamilyByID=kd;var ld={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"};Wa.DrumKitByPatchID=ld;var md={};Object.defineProperty(md,"__esModule",{value:!0});var nd=new WeakMap,fh=function(){function e(e,t){if(this.number=0,nd.set(this,t),this.number=0,e){var r=e.find(function(e){return"programChange"===e.type});r&&(this.number=r.programNumber)}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.percussion?ld[this.number]:Gb[this.number]},set:function(e){var t=Gb.indexOf(e);-1!==t&&(this.number=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"family",{get:function(){return this.percussion?"drums":kd[Math.floor(this.number/8)]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"percussion",{get:function(){return 9===nd.get(this).channel},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{family:this.family,name:this.name,number:this.number}},e.prototype.fromJSON=function(e){this.number=e.number},e}(),Hb=fh;md.Instrument=Hb;var od={};function gh(t){var i=Math.floor(t/12)-1;return pd(t)+i.toString()}function pd(t){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t%12]}function hh(t){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].indexOf(t)}Object.defineProperty(od,"__esModule",{value:!0});var ih=function(){var t=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,i={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(e){var r=t.exec(e),o=r[1],a=r[2];return i[o.toLowerCase()]+12*(parseInt(a,10)+1)}}(),la=new WeakMap,jh=function(){function t(t,i,e){la.set(this,e),this.midi=t.midi,this.velocity=t.velocity,this.noteOffVelocity=i.velocity,this.ticks=t.ticks,this.durationTicks=i.ticks-t.ticks}return Object.defineProperty(t.prototype,"name",{get:function(){return gh(this.midi)},set:function(t){this.midi=ih(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(t){var i=t-this.octave;this.midi+=12*i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return pd(this.midi)},set:function(t){this.midi=12*(this.octave+1)+hh(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var t=la.get(this);return t.ticksToSeconds(this.ticks+this.durationTicks)-t.ticksToSeconds(this.ticks)},set:function(t){var i=la.get(this).secondsToTicks(this.time+t);this.durationTicks=i-this.ticks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return la.get(this).ticksToSeconds(this.ticks)},set:function(t){var i=la.get(this);this.ticks=i.secondsToTicks(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bars",{get:function(){return la.get(this).ticksToMeasures(this.ticks)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},t}(),qd=jh;od.Note=qd;var rd={};Object.defineProperty(rd,"__esModule",{value:!0});var Xa=new WeakMap,kh=function(){function e(e,t){var n=this;if(this.name="",this.notes=[],this.controlChanges=hd(),this.pitchBends=[],Xa.set(this,t),e){var r=e.find(function(e){return"trackName"===e.type});this.name=r?r.text:""}if(this.instrument=new Hb(e,this),this.channel=0,e){for(var i=e.filter(function(e){return"noteOn"===e.type}),o=e.filter(function(e){return"noteOff"===e.type}),a=function(){var e=i.shift();s.channel=e.channel;var t=o.findIndex(function(t){return t.noteNumber===e.noteNumber&&t.absoluteTime>=e.absoluteTime});if(-1!==t){var n=o.splice(t,1)[0];s.addNote({durationTicks:n.absoluteTime-e.absoluteTime,midi:e.noteNumber,noteOffVelocity:n.velocity/127,ticks:e.absoluteTime,velocity:e.velocity/127})}},s=this;i.length;)a();e.filter(function(e){return"controller"===e.type}).forEach(function(e){n.addCC({number:e.controllerType,ticks:e.absoluteTime,value:e.value/127})}),e.filter(function(e){return"pitchBend"===e.type}).forEach(function(e){n.addPitchBend({ticks:e.absoluteTime,value:e.value/Math.pow(2,13)})})}}return e.prototype.addNote=function(e){var t=Xa.get(this),n=new qd({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},t);return Object.assign(n,e),Sa(this.notes,n,"ticks"),this},e.prototype.addCC=function(e){var t=Xa.get(this),n=new fd({controllerType:e.number},t);return delete e.number,Object.assign(n,e),Array.isArray(this.controlChanges[n.number])||(this.controlChanges[n.number]=[]),Sa(this.controlChanges[n.number],n,"ticks"),this},e.prototype.addPitchBend=function(e){var t=Xa.get(this),n=new jd({},t);return Object.assign(n,e),Sa(this.pitchBends,n,"ticks"),this},Object.defineProperty(e.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,t=0;t<this.notes.length-1;t++){var n=this.notes[t].time+this.notes[t].duration;e<n&&(e=n)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,t=0;t<this.notes.length-1;t++){var n=this.notes[t].ticks+this.notes[t].durationTicks;e<n&&(e=n)}return e},enumerable:!0,configurable:!0}),e.prototype.fromJSON=function(e){var t=this;for(var n in this.name=e.name,this.channel=e.channel,this.instrument=new Hb(void 0,this),this.instrument.fromJSON(e.instrument),e.controlChanges)e.controlChanges[n]&&e.controlChanges[n].forEach(function(e){t.addCC({number:e.number,ticks:e.ticks,value:e.value})});e.notes.forEach(function(e){t.addNote({durationTicks:e.durationTicks,midi:e.midi,ticks:e.ticks,velocity:e.velocity})})},e.prototype.toJSON=function(){for(var e={},t=0;t<127;t++)this.controlChanges.hasOwnProperty(t)&&(e[t]=this.controlChanges[t].map(function(e){return e.toJSON()}));return{channel:this.channel,controlChanges:e,pitchBends:this.pitchBends.map(function(e){return e.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(e){return e.toJSON()})}},e}(),ya=kh;rd.Track=ya;var da={},lh=da&&da.__awaiter||function(r,e,t,a){return new(t||(t=Promise))(function(n,o){function i(r){try{$(a.next(r))}catch(e){o(e)}}function c(r){try{$(a.throw(r))}catch(e){o(e)}}function $(r){var e;r.done?n(r.value):(e=r.value,e instanceof t?e:new t(function(r){r(e)})).then(i,c)}$((a=a.apply(r,e||[])).next())})},mh=da&&da.__generator||function(r,e){var t,a,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,a&&(n=2&o[0]?a.return:o[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue;}o=e.call(r,i)}catch(c){o=[6,c],a=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};Object.defineProperty(da,"__esModule",{value:!0});var nh=function(){function r(r){var e=this,t=null;r&&(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),(t=Cg(r)).tracks.forEach(function(r){var e=0;r.forEach(function(r){e+=r.deltaTime,r.absoluteTime=e})}),t.tracks=qh(t.tracks)),this.header=new Ua(t),this.tracks=[],r&&(this.tracks=t.tracks.map(function(r){return new ya(r,e.header)}),1===t.header.format&&0===this.tracks[0].duration&&this.tracks.shift())}return r.fromUrl=function(e){return lh(this,void 0,void 0,function(){var t;return mh(this,function(a){switch(a.label){case 0:return[4,fetch(e)];case 1:return(t=a.sent()).ok?[4,t.arrayBuffer()]:[3,3];case 2:return[2,new r(a.sent())];case 3:throw new Error("could not load "+e);}})})},Object.defineProperty(r.prototype,"name",{get:function(){return this.header.name},set:function(r){this.header.name=r},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"duration",{get:function(){var r=this.tracks.map(function(r){return r.duration});return Math.max.apply(Math,r)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"durationTicks",{get:function(){var r=this.tracks.map(function(r){return r.durationTicks});return Math.max.apply(Math,r)},enumerable:!0,configurable:!0}),r.prototype.addTrack=function(){var r=new ya(void 0,this.header);return this.tracks.push(r),r},r.prototype.toArray=function(){return dd(this)},r.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(r){return r.toJSON()})}},r.prototype.fromJSON=function(r){var e=this;this.header=new Ua,this.header.fromJSON(r.header),this.tracks=r.tracks.map(function(r){var t=new ya(void 0,e.header);return t.fromJSON(r),t})},r.prototype.clone=function(){var e=new r;return e.fromJSON(this.toJSON()),e},r}(),sd=nh;da.Midi=sd;var oh=ya;da.Track=oh;var ph=Ua;function qh(r){for(var e=[],t=0;t<r.length;t++)for(var a=e.length,n=new Map,o=Array(16).fill(0),i=0,c=r[t];i<c.length;i++){var $=c[i],u=a,s=$.channel;if(void 0!==s){"programChange"===$.type&&(o[s]=$.programNumber);var f=o[s]+" "+s;n.has(f)?u=n.get(f):(u=a+n.size,n.set(f,u))}e[u]||e.push([]),e[u].push($)}return e}da.Header=ph;var rh,Ib,m=(Pb(),{}),n=arguments[0],Ya={};!function(t,r){"object"==typeof Ya?Ya=r():"function"==typeof Ib&&Ib.amd?Ib([],r):"object"==typeof Ya?(rh=r(),Ya.Meyda=rh):t.Meyda=r()}(window,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(r){return t[r]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s="./src/index.js")}({"./node_modules/assert/assert.js":function(t,r,e){(function(r){function n(t,r){if(t===r)return 0;for(var e=t.length,n=r.length,o=0,i=Math.min(e,n);o<i;++o)if(t[o]!==r[o]){e=t[o],n=r[o];break}return e<n?-1:n<e?1:0}function o(t){return r.Buffer&&"function"==typeof r.Buffer.isBuffer?r.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var i=e("./node_modules/webpack-stream/node_modules/util/util.js"),a=Object.prototype.hasOwnProperty,u=Array.prototype.slice,c="foo"===function(){}.name;function f(t){return Object.prototype.toString.call(t)}function s(t){return!o(t)&&"function"==typeof r.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var l=t.exports=b,p=/\s*function\s+([^\(\s]*)\s*/;function m(t){if(i.isFunction(t)){if(c)return t.name;var r=t.toString().match(p);return r&&r[1]}}function y(t,r){return"string"==typeof t?t.length<r?t:t.slice(0,r):t}function h(t){if(c||!i.isFunction(t))return i.inspect(t);var r=m(t);return"[Function"+(r?": "+r:"")+"]"}function d(t,r,e,n,o){throw new l.AssertionError({message:e,actual:t,expected:r,operator:n,stackStartFunction:o})}function b(t,r){t||d(t,!0,r,"==",l.ok)}function g(t,r,e,a){if(t===r)return!0;if(o(t)&&o(r))return 0===n(t,r);if(i.isDate(t)&&i.isDate(r))return t.getTime()===r.getTime();if(i.isRegExp(t)&&i.isRegExp(r))return t.source===r.source&&t.global===r.global&&t.multiline===r.multiline&&t.lastIndex===r.lastIndex&&t.ignoreCase===r.ignoreCase;if(null!==t&&"object"==typeof t||null!==r&&"object"==typeof r){if(s(t)&&s(r)&&f(t)===f(r)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(r.buffer));if(o(t)!==o(r))return!1;var c=(a=a||{actual:[],expected:[]}).actual.indexOf(t);return-1!==c&&c===a.expected.indexOf(r)||(a.actual.push(t),a.expected.push(r),function(t,r,e,n){if(null==t||null==r)return!1;if(i.isPrimitive(t)||i.isPrimitive(r))return t===r;if(e&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(r))return!1;var o=v(t),a=v(r);if(o&&!a||!o&&a)return!1;if(o)return t=u.call(t),r=u.call(r),g(t,r,e);var c,f,s=j(t),l=j(r);if(s.length!==l.length)return!1;for(s.sort(),l.sort(),f=s.length-1;f>=0;f--)if(s[f]!==l[f])return!1;for(f=s.length-1;f>=0;f--)if(c=s[f],!g(t[c],r[c],e,n))return!1;return!0}(t,r,e,a))}return e?t===r:t==r}function v(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function S(t,r){if(!t||!r)return!1;if("[object RegExp]"==Object.prototype.toString.call(r))return r.test(t);try{if(t instanceof r)return!0}catch(e){}return!Error.isPrototypeOf(r)&&!0===r.call({},t)}function w(t,r,e,n){var o;if("function"!=typeof r)throw new TypeError("\"block\" argument must be a function");"string"==typeof e&&(n=e,e=null),o=function(t){var r;try{t()}catch(e){r=e}return r}(r),n=(e&&e.name?" ("+e.name+").":".")+(n?" "+n:"."),t&&!o&&d(o,e,"Missing expected exception"+n);var a="string"==typeof n,u=!t&&o&&!e;if((!t&&i.isError(o)&&a&&S(o,e)||u)&&d(o,e,"Got unwanted exception"+n),t&&o&&e&&!S(o,e)||!t&&o)throw o}l.AssertionError=function(t){var r;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=y(h((r=this).actual),128)+" "+r.operator+" "+y(h(r.expected),128),this.generatedMessage=!0);var e=t.stackStartFunction||d;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var o=n.stack,i=m(e),a=o.indexOf("\n"+i);if(a>=0){var u=o.indexOf("\n",a+1);o=o.substring(u+1)}this.stack=o}}},i.inherits(l.AssertionError,Error),l.fail=d,l.ok=b,l.equal=function(t,r,e){t!=r&&d(t,r,e,"==",l.equal)},l.notEqual=function(t,r,e){t==r&&d(t,r,e,"!=",l.notEqual)},l.deepEqual=function(t,r,e){g(t,r,!1)||d(t,r,e,"deepEqual",l.deepEqual)},l.deepStrictEqual=function(t,r,e){g(t,r,!0)||d(t,r,e,"deepStrictEqual",l.deepStrictEqual)},l.notDeepEqual=function(t,r,e){g(t,r,!1)&&d(t,r,e,"notDeepEqual",l.notDeepEqual)},l.notDeepStrictEqual=function t(r,e,n){g(r,e,!0)&&d(r,e,n,"notDeepStrictEqual",t)},l.strictEqual=function(t,r,e){t!==r&&d(t,r,e,"===",l.strictEqual)},l.notStrictEqual=function(t,r,e){t===r&&d(t,r,e,"!==",l.notStrictEqual)},l.throws=function(t,r,e){w(!0,t,r,e)},l.doesNotThrow=function(t,r,e){w(!1,t,r,e)},l.ifError=function(t){if(t)throw t};var j=Object.keys||function(t){var r=[];for(var e in t)a.call(t,e)&&r.push(e);return r}}).call(this,e("./node_modules/webpack-stream/node_modules/webpack/buildin/global.js"))},"./node_modules/dct/index.js":function(t,r,e){t.exports=e("./node_modules/dct/src/dct.js")},"./node_modules/dct/src/dct.js":function(t,r){var e=null,n=function(t){(e=e||{})[t]=new Array(t*t);for(var r=Math.PI/t,n=0;n<t;n++)for(var o=0;o<t;o++)e[t][o+n*t]=Math.cos(r*(o+.5)*n)};t.exports=function(t,r){var o=t.length;return r=r||2,e&&e[o]||n(o),t.map(function(){return 0}).map(function(n,i){return r*t.reduce(function(t,r,n,a){return t+r*e[o][n+i*o]},0)})}},"./node_modules/fftjs/dist/fft.js":function(t,r,e){var n=e("./node_modules/fftjs/dist/utils.js"),o=function(t){var r={};void 0===t.real||void 0===t.imag?r=n.constructComplexArray(t):(r.real=t.real.slice(),r.imag=t.imag.slice());var e=r.real.length,o=Math.log2(e);if(Math.round(o)!=o)throw new Error("Input size must be a power of 2.");if(r.real.length!=r.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var i=n.bitReverseArray(e),a={real:[],imag:[]},u=0;u<e;u++)a.real[i[u]]=r.real[u],a.imag[i[u]]=r.imag[u];for(var c=0;c<e;c++)r.real[c]=a.real[c],r.imag[c]=a.imag[c];for(var f=1;f<=o;f++)for(var s=Math.pow(2,f),l=0;l<s/2;l++)for(var p=n.euler(l,s),m=0;m<e/s;m++){var y=s*m+l,h=s*m+l+s/2,d={real:r.real[y],imag:r.imag[y]},b={real:r.real[h],imag:r.imag[h]},g=n.multiply(p,b),v=n.subtract(d,g);r.real[h]=v.real,r.imag[h]=v.imag;var S=n.add(g,d);r.real[y]=S.real,r.imag[y]=S.imag}return r};t.exports={fft:o,ifft:function(t){if(void 0===t.real||void 0===t.imag)throw new Error("IFFT only accepts a complex input.");for(var r=t.real.length,e={real:[],imag:[]},i=0;i<r;i++){var a={real:t.real[i],imag:t.imag[i]},u=n.conj(a);e.real[i]=u.real,e.imag[i]=u.imag}var c=o(e);return e.real=c.real.map(function(t){return t/r}),e.imag=c.imag.map(function(t){return t/r}),e}}},"./node_modules/fftjs/dist/utils.js":function(t,r,e){function n(t){if(Array.isArray(t)){for(var r=0,e=Array(t.length);r<t.length;r++)e[r]=t[r];return e}return Array.from(t)}var o={},i={};t.exports={bitReverseArray:function(t){if(void 0===o[t]){for(var r=(t-1).toString(2).length,e="0".repeat(r),i={},a=0;a<t;a++){var u=a.toString(2);u=e.substr(u.length)+u,u=[].concat(n(u)).reverse().join(""),i[a]=parseInt(u,2)}o[t]=i}return o[t]},multiply:function(t,r){return{real:t.real*r.real-t.imag*r.imag,imag:t.real*r.imag+t.imag*r.real}},add:function(t,r){return{real:t.real+r.real,imag:t.imag+r.imag}},subtract:function(t,r){return{real:t.real-r.real,imag:t.imag-r.imag}},euler:function(t,r){var e=-2*Math.PI*t/r;return{real:Math.cos(e),imag:Math.sin(e)}},conj:function(t){return t.imag*=-1,t},constructComplexArray:function(t){var r={};r.real=void 0===t.real?t.slice():t.real.slice();var e=r.real.length;return void 0===i[e]&&(i[e]=Array.apply(null,Array(e)).map(Number.prototype.valueOf,0)),r.imag=i[e].slice(),r}}},"./node_modules/inherits/inherits_browser.js":function(t,r){"function"==typeof Object.create?t.exports=function(t,r){t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,r){t.super_=r;var e=function(){};e.prototype=r.prototype,t.prototype=new e,t.prototype.constructor=t}},"./node_modules/process/browser.js":function(t,r){var e,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var c,f=[],s=!1,l=-1;function p(){s&&c&&(s=!1,c.length?f=c.concat(f):l=-1,f.length&&m())}function m(){if(!s){var t=u(p);s=!0;for(var r=f.length;r;){for(c=f,f=[];++l<r;)c&&c[l].run();l=-1,r=f.length}c=null,s=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(r){try{return n.call(null,t)}catch(r){return n.call(this,t)}}}(t)}}function y(t,r){this.fun=t,this.array=r}function h(){}o.nextTick=function(t){var r=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)r[e-1]=arguments[e];f.push(new y(t,r)),1!==f.length||s||u(m)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"./node_modules/webpack-stream/node_modules/util/support/isBufferBrowser.js":function(t,r){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},"./node_modules/webpack-stream/node_modules/util/util.js":function(t,r,e){(function(t){var n=Object.getOwnPropertyDescriptors||function(t){for(var r=Object.keys(t),e={},n=0;n<r.length;n++)e[r[n]]=Object.getOwnPropertyDescriptor(t,r[n]);return e},o=/%[sdj%]/g;r.format=function(t){if(!b(t)){for(var r=[],e=0;e<arguments.length;e++)r.push(u(arguments[e]));return r.join(" ")}e=1;for(var n=arguments,i=n.length,a=String(t).replace(o,function(t){if("%%"===t)return"%";if(e>=i)return t;switch(t){case"%s":return String(n[e++]);case"%d":return Number(n[e++]);case"%j":try{return JSON.stringify(n[e++])}catch(r){return"[Circular]"}default:return t;}}),c=n[e];e<i;c=n[++e])h(c)||!S(c)?a+=" "+c:a+=" "+u(c);return a},r.deprecate=function(e,n){if(void 0!==t&&!0===t.noDeprecation)return e;if(void 0===t)return function(){return r.deprecate(e,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),o=!0}return e.apply(this,arguments)}};var i,a={};function u(t,e){var n={seen:[],stylize:f};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),y(e)?n.showHidden=e:e&&r._extend(n,e),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),s(n,t,n.depth)}function c(t,r){var e=u.styles[r];return e?"\x1B["+u.colors[e][0]+"m"+t+"\x1B["+u.colors[e][1]+"m":t}function f(t,r){return t}function s(t,e,n){if(t.customInspect&&e&&x(e.inspect)&&e.inspect!==r.inspect&&(!e.constructor||e.constructor.prototype!==e)){var o=e.inspect(n,t);return b(o)||(o=s(t,o,n)),o}var i=function(t,r){if(g(r))return t.stylize("undefined","undefined");if(b(r)){var e="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\"")+"'";return t.stylize(e,"string")}if(d(r))return t.stylize(""+r,"number");if(y(r))return t.stylize(""+r,"boolean");if(h(r))return t.stylize("null","null")}(t,e);if(i)return i;var a=Object.keys(e),u=function(t){var r={};return t.forEach(function(t,e){r[t]=!0}),r}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),j(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(e);if(0===a.length){if(x(e)){var c=e.name?": "+e.name:"";return t.stylize("[Function"+c+"]","special")}if(v(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(w(e))return t.stylize(Date.prototype.toString.call(e),"date");if(j(e))return l(e)}var f,S="",_=!1,M=["{","}"];(m(e)&&(_=!0,M=["[","]"]),x(e))&&(S=" [Function"+(e.name?": "+e.name:"")+"]");return v(e)&&(S=" "+RegExp.prototype.toString.call(e)),w(e)&&(S=" "+Date.prototype.toUTCString.call(e)),j(e)&&(S=" "+l(e)),0!==a.length||_&&0!=e.length?n<0?v(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),f=_?function(t,r,e,n,o){for(var i=[],a=0,u=r.length;a<u;++a)O(r,String(a))?i.push(p(t,r,e,n,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(p(t,r,e,n,o,!0))}),i}(t,e,n,u,a):a.map(function(r){return p(t,e,n,u,r,_)}),t.seen.pop(),function(t,r,e){if(t.reduce(function(t,r){return 0,r.indexOf("\n")>=0&&0,t+r.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return e[0]+(""===r?"":r+"\n ")+" "+t.join(",\n  ")+" "+e[1];return e[0]+r+" "+t.join(", ")+" "+e[1]}(f,S,M)):M[0]+S+M[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,r,e,n,o,i){var a,u,c;if((c=Object.getOwnPropertyDescriptor(r,o)||{value:r[o]}).get?u=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(u=t.stylize("[Setter]","special")),O(n,o)||(a="["+o+"]"),u||(t.seen.indexOf(c.value)<0?(u=h(e)?s(t,c.value,null):s(t,c.value,e-1)).indexOf("\n")>-1&&(u=i?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),g(a)){if(i&&o.match(/^\d+$/))return u;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,"\"").replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+u}function m(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function h(t){return null===t}function d(t){return"number"==typeof t}function b(t){return"string"==typeof t}function g(t){return void 0===t}function v(t){return S(t)&&"[object RegExp]"===_(t)}function S(t){return"object"==typeof t&&null!==t}function w(t){return S(t)&&"[object Date]"===_(t)}function j(t){return S(t)&&("[object Error]"===_(t)||t instanceof Error)}function x(t){return"function"==typeof t}function _(t){return Object.prototype.toString.call(t)}function M(t){return t<10?"0"+t.toString(10):t.toString(10)}r.debuglog=function(e){if(g(i)&&(i=""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var n=t.pid;a[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else a[e]=function(){};return a[e]},r.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=m,r.isBoolean=y,r.isNull=h,r.isNullOrUndefined=function(t){return null==t},r.isNumber=d,r.isString=b,r.isSymbol=function(t){return"symbol"==typeof t},r.isUndefined=g,r.isRegExp=v,r.isObject=S,r.isDate=w,r.isError=j,r.isFunction=x,r.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},r.isBuffer=e("./node_modules/webpack-stream/node_modules/util/support/isBufferBrowser.js");var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(t,r){return Object.prototype.hasOwnProperty.call(t,r)}r.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":"),[t.getDate(),E[t.getMonth()],e].join(" ")),r.format.apply(r,arguments))},r.inherits=e("./node_modules/inherits/inherits_browser.js"),r._extend=function(t,r){if(!r||!S(r))return t;for(var e=Object.keys(r),n=e.length;n--;)t[e[n]]=r[e[n]];return t};var T="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(t,r){if(!t){var e=new Error("Promise was rejected with a falsy value");e.reason=t,t=e}return r(t)}r.promisify=function(t){if("function"!=typeof t)throw new TypeError("The \"original\" argument must be of type Function");if(T&&t[T]){var r;if("function"!=typeof(r=t[T]))throw new TypeError("The \"util.promisify.custom\" argument must be of type Function");return Object.defineProperty(r,T,{value:r,enumerable:!1,writable:!1,configurable:!0}),r}function r(){for(var r,e,n=new Promise(function(t,n){r=t,e=n}),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push(function(t,n){t?e(t):r(n)});try{t.apply(this,o)}catch(a){e(a)}return n}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),T&&Object.defineProperty(r,T,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,n(t))},r.promisify.custom=T,r.callbackify=function(r){if("function"!=typeof r)throw new TypeError("The \"original\" argument must be of type Function");function e(){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n]);var o=e.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};r.apply(this,e).then(function(r){t.nextTick(a,null,r)},function(r){t.nextTick(A,r,a)})}return Object.setPrototypeOf(e,Object.getPrototypeOf(r)),Object.defineProperties(e,n(r)),e}}).call(this,e("./node_modules/process/browser.js"))},"./node_modules/webpack-stream/node_modules/webpack/buildin/global.js":function(t,r){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(n){"object"==typeof window&&(e=window)}t.exports=e},"./src/extractors/chroma.js":function(t,r,e){function n(t){return function(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError("Valid ampSpectrum is required to generate chroma");if("object"!==o(t.chromaFilterBank))throw new TypeError("Valid chromaFilterBank is required to generate chroma");var r=t.chromaFilterBank.map(function(r,e){return t.ampSpectrum.reduce(function(t,e,n){return t+e*r[n]},0)}),e=Math.max.apply(Math,n(r));return e?r.map(function(t){return t/e}):r}},"./src/extractors/energy.js":function(t,r,e){e.r(r);e("./node_modules/assert/assert.js");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(){if("object"!==n(arguments[0].signal))throw new TypeError;for(var t=0,r=0;r<arguments[0].signal.length;r++)t+=Math.pow(Math.abs(arguments[0].signal[r]),2);return t}},"./src/extractors/extractorUtilities.js":function(t,r,e){function n(t,r){for(var e=0,n=0,o=0;o<r.length;o++)e+=Math.pow(o,t)*Math.abs(r[o]),n+=r[o];return e/n}e.r(r),e.d(r,"mu",function(){return n})},"./src/extractors/loudness.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(t){if("object"!==n(t.ampSpectrum)||"object"!==n(t.barkScale))throw new TypeError;var r=new Float32Array(24),e=0,o=t.ampSpectrum,i=new Int32Array(25);i[0]=0;for(var a=t.barkScale[o.length-1]/24,u=1,c=0;c<o.length;c++)for(;t.barkScale[c]>a;)i[u++]=c,a=u*t.barkScale[o.length-1]/24;i[24]=o.length-1;for(var f=0;f<24;f++){for(var s=0,l=i[f];l<i[f+1];l++)s+=o[l];r[f]=Math.pow(s,.23)}for(var p=0;p<r.length;p++)e+=r[p];return{specific:r,total:e}}},"./src/extractors/mfcc.js":function(t,r,e){e.r(r);var n=e("./src/extractors/powerSpectrum.js");e("./src/utilities.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=e("./node_modules/dct/index.js");r.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError("Valid ampSpectrum is required to generate MFCC");if("object"!==o(t.melFilterBank))throw new TypeError("Valid melFilterBank is required to generate MFCC");var r=Math.min(40,Math.max(1,t.numberOfMFCCCoefficients||13)),e=Object(n.default)(t),a=t.melFilterBank.length,u=Array(a);if(a<r)throw new Error("Insufficient filter bank for requested number of coefficients");for(var c=new Float32Array(a),f=0;f<c.length;f++){u[f]=new Float32Array(t.bufferSize/2),c[f]=0;for(var s=0;s<t.bufferSize/2;s++)u[f][s]=t.melFilterBank[f][s]*e[s],c[f]+=u[f][s];c[f]=Math.log(c[f]+1)}var l=Array.prototype.slice.call(c);return i(l).slice(0,r)}},"./src/extractors/perceptualSharpness.js":function(t,r,e){e.r(r);var n=e("./src/extractors/loudness.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(){if("object"!==o(arguments[0].signal))throw new TypeError;for(var t=Object(n.default)(arguments[0]),r=t.specific,e=0,i=0;i<r.length;i++)e+=i<15?(i+1)*r[i+1]:.066*Math.exp(.171*(i+1));return e*=.11/t.total}},"./src/extractors/perceptualSpread.js":function(t,r,e){e.r(r);var n=e("./src/extractors/loudness.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(){if("object"!==o(arguments[0].signal))throw new TypeError;for(var t=Object(n.default)(arguments[0]),r=0,e=0;e<t.specific.length;e++)t.specific[e]>r&&(r=t.specific[e]);return Math.pow((t.total-r)/t.total,2)}},"./src/extractors/powerSpectrum.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(){if("object"!==n(arguments[0].ampSpectrum))throw new TypeError;for(var t=new Float32Array(arguments[0].ampSpectrum.length),r=0;r<t.length;r++)t[r]=Math.pow(arguments[0].ampSpectrum[r],2);return t}},"./src/extractors/rms.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(t){if("object"!==n(t.signal))throw new TypeError;for(var r=0,e=0;e<t.signal.length;e++)r+=Math.pow(t.signal[e],2);return r/=t.signal.length,r=Math.sqrt(r)}},"./src/extractors/spectralCentroid.js":function(t,r,e){e.r(r);var n=e("./src/extractors/extractorUtilities.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(){if("object"!==o(arguments[0].ampSpectrum))throw new TypeError;return Object(n.mu)(1,arguments[0].ampSpectrum)}},"./src/extractors/spectralFlatness.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(){if("object"!==n(arguments[0].ampSpectrum))throw new TypeError;for(var t=0,r=0,e=0;e<arguments[0].ampSpectrum.length;e++)t+=Math.log(arguments[0].ampSpectrum[e]),r+=arguments[0].ampSpectrum[e];return Math.exp(t/arguments[0].ampSpectrum.length)*arguments[0].ampSpectrum.length/r}},"./src/extractors/spectralFlux.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(t){if("object"!==n(t.signal)||"object"!=n(t.previousSignal))throw new TypeError;for(var r=0,e=-t.bufferSize/2;e<signal.length/2-1;e++)x=Math.abs(t.signal[e])-Math.abs(t.previousSignal[e]),r+=(x+Math.abs(x))/2;return r}},"./src/extractors/spectralKurtosis.js":function(t,r,e){e.r(r);var n=e("./src/extractors/extractorUtilities.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(){if("object"!==o(arguments[0].ampSpectrum))throw new TypeError;var t=arguments[0].ampSpectrum,r=Object(n.mu)(1,t),e=Object(n.mu)(2,t),i=Object(n.mu)(3,t),a=Object(n.mu)(4,t);return(-3*Math.pow(r,4)+6*r*e-4*r*i+a)/Math.pow(Math.sqrt(e-Math.pow(r,2)),4)}},"./src/extractors/spectralRolloff.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(){if("object"!==n(arguments[0].ampSpectrum))throw new TypeError;for(var t=arguments[0].ampSpectrum,r=arguments[0].sampleRate/(2*(t.length-1)),e=0,o=0;o<t.length;o++)e+=t[o];for(var i=.99*e,a=t.length-1;e>i&&a>=0;)e-=t[a],--a;return(a+1)*r}},"./src/extractors/spectralSkewness.js":function(t,r,e){e.r(r);var n=e("./src/extractors/extractorUtilities.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError;var r=Object(n.mu)(1,t.ampSpectrum),e=Object(n.mu)(2,t.ampSpectrum),i=Object(n.mu)(3,t.ampSpectrum);return(2*Math.pow(r,3)-3*r*e+i)/Math.pow(Math.sqrt(e-Math.pow(r,2)),3)}},"./src/extractors/spectralSlope.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(t){if("object"!==n(t.ampSpectrum))throw new TypeError;for(var r=0,e=0,o=new Float32Array(t.ampSpectrum.length),i=0,a=0,u=0;u<t.ampSpectrum.length;u++){r+=t.ampSpectrum[u];var c=u*t.sampleRate/t.bufferSize;o[u]=c,i+=c*c,e+=c,a+=c*t.ampSpectrum[u]}return(t.ampSpectrum.length*a-e*r)/(r*(i-Math.pow(e,2)))}},"./src/extractors/spectralSpread.js":function(t,r,e){e.r(r);var n=e("./src/extractors/extractorUtilities.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError;return Math.sqrt(Object(n.mu)(2,t.ampSpectrum)-Math.pow(Object(n.mu)(1,t.ampSpectrum),2))}},"./src/extractors/zcr.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(){if("object"!==n(arguments[0].signal))throw new TypeError;for(var t=0,r=1;r<arguments[0].signal.length;r++)(arguments[0].signal[r-1]>=0&&arguments[0].signal[r]<0||arguments[0].signal[r-1]<0&&arguments[0].signal[r]>=0)&&t++;return t}},"./src/featureExtractors.js":function(t,r,e){e.r(r),e.d(r,"buffer",function(){return S}),e.d(r,"complexSpectrum",function(){return w}),e.d(r,"amplitudeSpectrum",function(){return j});var n=e("./src/extractors/rms.js");e.d(r,"rms",function(){return n.default});var o=e("./src/extractors/energy.js");e.d(r,"energy",function(){return o.default});var i=e("./src/extractors/spectralSlope.js");e.d(r,"spectralSlope",function(){return i.default});var a=e("./src/extractors/spectralCentroid.js");e.d(r,"spectralCentroid",function(){return a.default});var u=e("./src/extractors/spectralRolloff.js");e.d(r,"spectralRolloff",function(){return u.default});var c=e("./src/extractors/spectralFlatness.js");e.d(r,"spectralFlatness",function(){return c.default});var f=e("./src/extractors/spectralSpread.js");e.d(r,"spectralSpread",function(){return f.default});var s=e("./src/extractors/spectralSkewness.js");e.d(r,"spectralSkewness",function(){return s.default});var l=e("./src/extractors/spectralKurtosis.js");e.d(r,"spectralKurtosis",function(){return l.default});var p=e("./src/extractors/zcr.js");e.d(r,"zcr",function(){return p.default});var m=e("./src/extractors/loudness.js");e.d(r,"loudness",function(){return m.default});var y=e("./src/extractors/perceptualSpread.js");e.d(r,"perceptualSpread",function(){return y.default});var h=e("./src/extractors/perceptualSharpness.js");e.d(r,"perceptualSharpness",function(){return h.default});var d=e("./src/extractors/mfcc.js");e.d(r,"mfcc",function(){return d.default});var b=e("./src/extractors/chroma.js");e.d(r,"chroma",function(){return b.default});var g=e("./src/extractors/powerSpectrum.js");e.d(r,"powerSpectrum",function(){return g.default});var v=e("./src/extractors/spectralFlux.js");e.d(r,"spectralFlux",function(){return v.default});var S=function(t){return t.signal},w=function(t){return t.complexSpectrum},j=function(t){return t.ampSpectrum}},"./src/index.js":function(t,r,e){t.exports=e("./src/main.js").default},"./src/main.js":function(t,r,e){e.r(r);var n=e("./src/utilities.js"),o=e("./src/featureExtractors.js"),i=e("./node_modules/fftjs/dist/fft.js"),a=e("./src/meyda-wa.js");function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:o,EXTRACTION_STARTED:!1,numberOfMFCCCoefficients:13,_featuresToExtract:[],windowing:n.applyWindow,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(t){return new a.MeydaAnalyzer(t,Object.assign({},c))},extract:function(t,r,e){var o=this;if(!r)throw this._errors.invalidInput;if("object"!=u(r))throw this._errors.invalidInput;if(!t)throw this._errors.featureUndef;if(!n.isPowerOfTwo(r.length))throw this._errors.notPow2;void 0!==this.barkScale&&this.barkScale.length==this.bufferSize||(this.barkScale=n.createBarkScale(this.bufferSize,this.sampleRate,this.bufferSize)),void 0!==this.melFilterBank&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=n.createMelFilterBank(Math.max(this.melBands,this.numberOfMFCCCoefficients),this.sampleRate,this.bufferSize)),void 0!==this.chromaFilterBank&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=n.createChromaFilterBank(this.chromaBands,this.sampleRate,this.bufferSize)),void 0===r.buffer?this.signal=n.arrayToTyped(r):this.signal=r;var i=f(r,this.windowingFunction,this.bufferSize);if(this.signal=i.windowedSignal,this.complexSpectrum=i.complexSpectrum,this.ampSpectrum=i.ampSpectrum,e){var a=f(e,this.windowingFunction,this.bufferSize);this.previousSignal=a.windowedSignal,this.previousComplexSpectrum=a.complexSpectrum,this.previousAmpSpectrum=a.ampSpectrum}var c=function(t){return o.featureExtractors[t]({ampSpectrum:o.ampSpectrum,chromaFilterBank:o.chromaFilterBank,complexSpectrum:o.complexSpectrum,signal:o.signal,bufferSize:o.bufferSize,sampleRate:o.sampleRate,barkScale:o.barkScale,melFilterBank:o.melFilterBank,previousSignal:o.previousSignal,previousAmpSpectrum:o.previousAmpSpectrum,previousComplexSpectrum:o.previousComplexSpectrum,numberOfMFCCCoefficients:o.numberOfMFCCCoefficients})};if("object"===u(t))return t.reduce(function(t,r){return Object.assign({},t,(e={},n=r,o=c(r),n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e));var e,n,o},{});if("string"==typeof t)return c(t);throw this._errors.invalidFeatureFmt}},f=function(t,r,e){var o={};void 0===t.buffer?o.signal=n.arrayToTyped(t):o.signal=t,o.windowedSignal=n.applyWindow(o.signal,r),o.complexSpectrum=Object(i.fft)(o.windowedSignal),o.ampSpectrum=new Float32Array(e/2);for(var a=0;a<e/2;a++)o.ampSpectrum[a]=Math.sqrt(Math.pow(o.complexSpectrum.real[a],2)+Math.pow(o.complexSpectrum.imag[a],2));return o};r.default=c,"undefined"!=typeof window&&(window.Meyda=c)},"./src/meyda-wa.js":function(t,r,e){e.r(r),e.d(r,"MeydaAnalyzer",function(){return a});var n=e("./src/utilities.js"),o=e("./src/featureExtractors.js");function i(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(r,e){var i=this;if(function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this._m=e,!r.audioContext)throw this._m.errors.noAC;if(r.bufferSize&&!n.isPowerOfTwo(r.bufferSize))throw this._m._errors.notPow2;if(!r.source)throw this._m._errors.noSource;this._m.audioContext=r.audioContext,this._m.bufferSize=r.bufferSize||this._m.bufferSize||256,this._m.hopSize=r.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=r.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=r.callback,this._m.windowingFunction=r.windowingFunction||"hanning",this._m.featureExtractors=o,this._m.EXTRACTION_STARTED=r.startImmediately||!1,this._m.channel="number"==typeof r.channel?r.channel:0,this._m.inputs=r.inputs||1,this._m.outputs=r.outputs||1,this._m.numberOfMFCCCoefficients=r.numberOfMFCCCoefficients||this._m.numberOfMFCCCoefficients||13,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,this._m.inputs,this._m.outputs),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=r.featureExtractors||[],this._m.barkScale=n.createBarkScale(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=n.createMelFilterBank(Math.max(this._m.melBands,this._m.numberOfMFCCCoefficients),this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(r.source),this._m.spn.onaudioprocess=function(t){if(null!==i._m.inputData&&(i._m.previousInputData=i._m.inputData),i._m.inputData=t.inputBuffer.getChannelData(i._m.channel),i._m.previousInputData)(r=new Float32Array(i._m.previousInputData.length+i._m.inputData.length-i._m.hopSize)).set(i._m.previousInputData.slice(i._m.hopSize)),r.set(i._m.inputData,i._m.previousInputData.length-i._m.hopSize);else var r=i._m.inputData;n.frame(r,i._m.bufferSize,i._m.hopSize).forEach(function(t){i._m.frame=t;var r=i._m.extract(i._m._featuresToExtract,i._m.frame,i._m.previousFrame);"function"==typeof i._m.callback&&i._m.EXTRACTION_STARTED&&i._m.callback(r),i._m.previousFrame=i._m.frame})}}var r,e,a;return r=t,(e=[{key:"start",value:function(t){this._m._featuresToExtract=t||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0}},{key:"stop",value:function(){this._m.EXTRACTION_STARTED=!1}},{key:"setSource",value:function(t){this._m.source&&this._m.source.disconnect(this._m.spn),this._m.source=t,this._m.source.connect(this._m.spn)}},{key:"setChannel",value:function(t){t<=this._m.inputs?this._m.channel=t:console.error("Channel ".concat(t," does not exist. Make sure you've provided a value for 'inputs' that is greater than ").concat(t," when instantiating the MeydaAnalyzer"))}},{key:"get",value:function(t){return this._m.inputData?this._m.extract(t||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null}}])&&i(r.prototype,e),a&&i(r,a),t}()},"./src/utilities.js":function(t,r,e){e.r(r),e.d(r,"isPowerOfTwo",function(){return a}),e.d(r,"error",function(){return u}),e.d(r,"pointwiseBufferMult",function(){return c}),e.d(r,"applyWindow",function(){return f}),e.d(r,"createBarkScale",function(){return s}),e.d(r,"typedToArray",function(){return l}),e.d(r,"arrayToTyped",function(){return p}),e.d(r,"_normalize",function(){return m}),e.d(r,"normalize",function(){return y}),e.d(r,"normalizeToOne",function(){return h}),e.d(r,"mean",function(){return d}),e.d(r,"melToFreq",function(){return v}),e.d(r,"freqToMel",function(){return S}),e.d(r,"createMelFilterBank",function(){return w}),e.d(r,"hzToOctaves",function(){return j}),e.d(r,"normalizeByColumn",function(){return x}),e.d(r,"createChromaFilterBank",function(){return _}),e.d(r,"frame",function(){return M});var n=e("./src/windowing.js");function o(t){return function(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i={};function a(t){for(;t%2==0&&t>1;)t/=2;return 1===t}function u(t){throw new Error("Meyda: "+t)}function c(t,r){for(var e=[],n=0;n<Math.min(t.length,r.length);n++)e[n]=t[n]*r[n];return e}function f(t,r){if("rect"!==r){if(""!==r&&r||(r="hanning"),i[r]||(i[r]={}),!i[r][t.length])try{i[r][t.length]=n[r](t.length)}catch(e){throw new Error("Invalid windowing function")}t=c(t,i[r][t.length])}return t}function s(t,r,e){for(var n=new Float32Array(t),o=0;o<n.length;o++)n[o]=o*r/e,n[o]=13*Math.atan(n[o]/1315.8)+3.5*Math.atan(Math.pow(n[o]/7518,2));return n}function l(t){return Array.prototype.slice.call(t)}function p(t){return Float32Array.from(t)}function m(t,r){return t/r}function y(t,r){return t.map(function(t){return m(t,r)})}function h(t){var r=Math.max.apply(null,t);return t.map(function(t){return t/r})}function d(t){return t.reduce(function(t,r){return t+r})/t.length}function b(t){return 700*(Math.exp(t/1125)-1)}function g(t){return 1125*Math.log(1+t/700)}function v(t){return b(t)}function S(t){return g(t)}function w(t,r,e){for(var n=new Float32Array(t+2),o=new Float32Array(t+2),i=r/2,a=g(0),u=(g(i)-a)/(t+1),c=Array(t+2),f=0;f<n.length;f++)n[f]=f*u,o[f]=b(n[f]),c[f]=Math.floor((e+1)*o[f]/r);for(var s=Array(t),l=0;l<s.length;l++){s[l]=Array.apply(null,new Array(e/2+1)).map(Number.prototype.valueOf,0);for(var p=c[l];p<c[l+1];p++)s[l][p]=(p-c[l])/(c[l+1]-c[l]);for(var m=c[l+1];m<c[l+2];m++)s[l][m]=(c[l+2]-m)/(c[l+2]-c[l+1])}return s}function j(t,r){return Math.log2(16*t/r)}function x(t){var r=t[0].map(function(){return 0}),e=t.reduce(function(t,r){return r.forEach(function(r,e){t[e]+=Math.pow(r,2)}),t},r).map(Math.sqrt);return t.map(function(t,r){return t.map(function(t,r){return t/(e[r]||1)})})}function _(t,r,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:440,c=Math.floor(e/2)+1,f=new Array(e).fill(0).map(function(n,o){return t*j(r*o/e,u)});f[0]=f[1]-1.5*t;var s=f.slice(1).map(function(t,r){return Math.max(t-f[r])},1).concat([1]),l=Math.round(t/2),p=new Array(t).fill(0).map(function(r,e){return f.map(function(r){return(10*t+l+r-e)%t-l})}),m=p.map(function(t,r){return t.map(function(t,e){return Math.exp(-.5*Math.pow(2*p[r][e]/s[e],2))})});if(m=x(m),i){var y=f.map(function(r){return Math.exp(-.5*Math.pow((r/t-n)/i,2))});m=m.map(function(t){return t.map(function(t,r){return t*y[r]})})}return a&&(m=[].concat(o(m.slice(3)),o(m.slice(0,3)))),m.map(function(t){return t.slice(0,c)})}function M(t,r,e){if(t.length<r)throw new Error("Buffer is too short for frame length");if(e<1)throw new Error("Hop length cannot be less that 1");if(r<1)throw new Error("Frame length cannot be less that 1");var n=1+Math.floor((t.length-r)/e);return new Array(n).fill(0).map(function(n,o){return t.slice(o*e,o*e+r)})}},"./src/windowing.js":function(t,r,e){function n(t){for(var r=new Float32Array(t),e=2*Math.PI/(t-1),n=2*e,o=0;o<t/2;o++)r[o]=.42-.5*Math.cos(o*e)+.08*Math.cos(o*n);for(var i=t/2;i>0;i--)r[t-i]=r[i-1];return r}function o(t){for(var r=Math.PI/(t-1),e=new Float32Array(t),n=0;n<t;n++)e[n]=Math.sin(r*n);return e}function i(t){for(var r=new Float32Array(t),e=0;e<t;e++)r[e]=.5-.5*Math.cos(2*Math.PI*e/(t-1));return r}function a(t){for(var r=new Float32Array(t),e=0;e<t;e++)r[e]=.54-.46*Math.cos(2*Math.PI*(e/t-1));return r}e.r(r),e.d(r,"blackman",function(){return n}),e.d(r,"sine",function(){return o}),e.d(r,"hanning",function(){return i}),e.d(r,"hamming",function(){return a})}})});var td=ba&&ba.__awaiter||function($,t,r,e){return new(r||(r=Promise))(function(o,i){function d($){try{a(e.next($))}catch(t){i(t)}}function l($){try{a(e.throw($))}catch(t){i(t)}}function a($){var t;$.done?o($.value):(t=$.value,t instanceof r?t:new r(function($){$(t)})).then(d,l)}a((e=e.apply($,t||[])).next())})};const sh=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],th=L(q($=>Bg($)),H(),sh),Jb=L(nb({raw:q($=>$),tonicMidi:q($=>Uc($.tonic+"2")%12),majorKey:q($=>$.tonic),minorKey:q($=>ug($.minorRelative).toLowerCase()),normalizedMidis:q($=>L(q($=>Uc($+"2")%12),H(),$.scale))}),H(),th);ba.scales=Jb;const ud=$=>{const t=L(La(q(t=>$[t]?t:null),mb($=>null!==$)),H(),tc(12)),r=L(La(q($=>sb(new Set($.normalizedMidis),new Set(t))),q($=>Array.from($))),H(),Jb);let e=L(nb({majorKey:q($=>$[0].majorKey),minorKey:q($=>$[0].minorKey),normalizedMidis:q($=>$[0].normalizedMidis),common:q($=>$[1]),similarity:q($=>$[1].length/t.length+(t.includes($[0].tonicMidi)?.1:0))}),H(),yf(Jb,r));return e=e.sort(($,t)=>t.similarity-$.similarity)};ba.getComparisons=ud;const za=[...Cf(!1,12)];ba.defaultKeyState=za;const uh=[...Ma(12,vc([!0,!1],[.5,.5]))];ba.randomKeyState=uh;const vd=$=>{let t=new sd($).tracks;t.sort(($,t)=>t.notes.length-$.notes.length);const r=t[0],e=L(q($=>$[0]%12),H(),Ma(7,Gc(r.notes.map($=>$.midi))));return Array.from(new Set(e))};ba.parseMidiFile=vd;const vh=()=>{try{return new AudioContext}catch($){return new window.webkitAudioContext}},wh=($,t)=>td(void 0,void 0,void 0,function*(){try{return yield $.decodeAudioData(t)}catch(r){return new Promise((r,e)=>{$.decodeAudioData(t,r,e)})}}),xh=$=>Math.pow(2,Math.round(Math.log($)/Math.log(2))),wd=$=>td(void 0,void 0,void 0,function*(){var $visD$$interop$default=Aa(Ya);const t=vh(),r=yield wh(t,$),e=r.getChannelData(0),o=xh(r.sampleRate/1),i=Math.floor(e.length/o),d=L(q($=>$visD$$interop$default.d.extract("chroma",e.slice($*o,($+1)*o))),H(),tc(i)),l=L(q($=>$.indexOf(1)),H(),d);return L(q($=>$[0]),H(),L(q($=>$),H(),Gc(l)).sort(($,t)=>t[1]-$[1])).slice(0,7)});ba.parseAudioFile=wd;const yh=e=>{const t=e.views,i=t.size.deref(),r=Math.min(400*1.1,.9*i[0]),o=t.viewConfig.deref(),s=ud(t.keyState.deref()),a={width:r,height:r/35,rx:5,fill:"#e2e2e2"};return["div.dib",...s.map((t,i)=>["div.mv2.mr2",{onmouseover:i=>{i.preventDefault(),e.bus.dispatch([pb,t.normalizedMidis])},onmouseleave:t=>{t.preventDefault(),e.bus.dispatch([yc])}},["div.flex",["div",t.majorKey,o.showSmall?["small"," maj"]:[]],o.showMinor?["div",["span.red"," \u30FB "],t.minorKey,o.showSmall?["small"," min"]:[]]:[]],["div",["svg",{width:1.1*r,height:r/35},["g",["rect",a],t.common.length>0?["rect",Object.assign(Object.assign({},a),{width:(t.similarity-.1)*r,fill:"#000"})]:[]]]]])]};var Kb={};var zh=Kb&&Kb.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function($,o){function i(e){try{s(a.next(e))}catch(t){o(t)}}function n(e){try{s(a.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?$(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,n)}s((a=a.apply(e,t||[])).next())})};const Za=e=>{e.preventDefault()},Ah=(e,t)=>{Za(t);const r=t.dataTransfer.files;if(r&&r.length>0){const t=new FileReader,a=r[0];t.onload=t=>zh(void 0,void 0,void 0,function*(){if("audio/midi"===a.type){e.dispatch([ja,a.name]);const r=vd(t.target.result);e.dispatch([ua,za.map((e,t)=>!!r.includes(t))])}else if("audio/aac"===a.type||"audio/mpeg"===a.type||"audio/wav"===a.type){e.dispatch([ja,a.name]);const r=yield wd(t.target.result);e.dispatch([ua,za.map((e,t)=>!!r.includes(t))])}else e.dispatch([Cc])}),t.readAsArrayBuffer(a)}},xd=e=>{const t=e.bus,r=e.views,a=r.midiFile.deref(),$=r.size.deref();return["div.mt2.mb4.ba.b--dotted.bw1.dib.pa4.v-mid.tc",{ondrop:e=>{e.target.classList.remove("dragover"),Ah(t,e)},ondragenter:e=>{e.target.classList.add("dragover"),Za(e)},ondragleave:e=>{e.target.classList.remove("dragover"),Za(e)},ondragover:e=>Za(e),style:{width:`${Math.min(400*1.1,.9*$[0])}px`}},a]};Kb.fileDropZone=xd;const Bh={w:16,h:8,pad:2,margin:0},Ch=nf(Object.assign(Object.assign({},Bh),{vertical:!1})),Dh=e=>{const i=e.views.viewConfig.deref();return["div",Object.entries(i).map(([i,$])=>["div.mv2",[Ch,{class:"pointer mr2",onclick:()=>e.bus.dispatch([Ac,i])},$],i])]};const Eh=lf({element:"h2",attribs:{class:"#000"}}),Fh=e=>()=>["div",[Eh,"OP-Z KEY FINDER"],[If,e],[Kf,e],["div.mb2",[Pf,e],[yh,e]],[xd,e],["div.db",["details",["summary","View Config"],[Dh,e]]]];const Lb={id:"home",match:["home"]};const Gh={router:{useFragment:!0,defaultRouteID:Lb.id,routes:[Lb]},events:{[Ef]:_e("debug",$=>1^$),[Na]:[($,[o,i])=>({[F]:[Ja,["keyState",i]]})],[ua]:[($,[o,i])=>({[F]:[ea,["keyState",i]]})],[wc]:[()=>({[F]:[ua,za]})],[xc]:[()=>({[F]:[ua,[...Ma(12,vc([!0,!1],[.5,.5]))]]})],[pb]:[($,[o,i])=>({[F]:[ea,["highlights",i]]})],[yc]:[()=>({[F]:[pb,[]]})],[zc]:[()=>({[F]:[ea,["size",[window.innerWidth,window.innerHeight]]]})],[Ac]:[($,[o,i])=>({[F]:[Ja,["viewConfig",i]]})],[Bc]:[($,[o,i])=>({[F]:[[Ja,"enabledMidi"],[ea,["midiDevices",i]]]})],[ja]:[($,[o,i])=>({[F]:[[ea,["midiFile",i]]]})],[Cc]:[()=>({[F]:[ja,"INVALID MIDI FILE..."],[kc]:[lc,[500,"DROP MIDI/AUDIO FILE HERE..."],ja,ja]})],[Ff]:[($,[o,i])=>({[F]:[[ea,["comparison",i]]]})]},effects:{},components:{[Lb.id]:Fh},domRoot:"app",initialState:{enabledMidi:!1,midiDevices:[],midiFile:"DROP MIDI/AUDIO FILE HERE...",keyState:za,highlights:[],size:[window.innerWidth,window.innerHeight],viewConfig:{showMinor:!0,showSmall:!0},route:{},debug:1},views:{enabledMidi:"enabledMidi",midiDevices:"midiDevices",midiFile:"midiFile",keyState:"keyState",highlights:"highlights",size:"size",viewConfig:"viewConfig",json:["",$=>JSON.stringify($,null,2)],debug:"debug"},ui:{root:{class:"flex-ns sans-serif ma0"},toolbar:{button:{class:"mr3 pv2 ph2 bg-black white f4"}},code:{class:"ma0 ml4 pa2 f7 bg-light-gray code overflow-x-hidden"},column:{content:[{class:"w-90-ns ma2"},{class:"w-50-ns ma2"}],debug:[{class:"w-10-ns ma2 close"},{class:"w-50-ns ma2 open"}]},debugToggle:{class:"toggle pointer"}}};new Jf(Gh).start();return{"B6dB":{}};});