parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function I(a){return a&&a.__esModule?{d:a.default}:{d:a}}var Zc=function(){return Zc=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},Zc.apply(this,arguments)};function ga(t,e,r,o){var n,a=arguments.length,$=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)$=Reflect.decorate(t,e,r,o);else for(var i=t.length-1;i>=0;i--)(n=t[i])&&($=(a<3?n($):a>3?n(e,r,$):n(e,r))||$);return a>3&&$&&Object.defineProperty(e,r,$),$}function Va(t){return this instanceof Va?(this.v=t,this):new Va(t)}var $c=false;function ha(){if($c)return;$c=true}const _c=(e,o={})=>{const t=Reflect.ownKeys(e),r=Reflect.ownKeys(o),n=Symbol("isa");function p(o){for(let r of t){const t=Object.getOwnPropertyDescriptor(o.prototype,r);!t||t.configurable?Object.defineProperty(o.prototype,r,{value:e[r],writable:!0}):console.log(`not patching: ${o.name}.${r.toString()}`)}return Object.defineProperty(o.prototype,n,{value:!0}),o}for(let i of r)Object.defineProperty(p,i,{value:o[i],enumerable:o.propertyIsEnumerable(i)});return Object.defineProperty(p,Symbol.hasInstance,{value:e=>!!e[n]}),p};const ad=_c({addWatch(t,s){return this._watches=this._watches||{},!this._watches[t]&&(this._watches[t]=s,!0)},removeWatch(t){if(this._watches)return!!this._watches[t]&&(delete this._watches[t],!0)},notifyWatches(t,s){if(!this._watches)return;const e=this._watches;for(let i in e)e[i](i,t,s)}});const bd=(r,o=r=>void 0!==r?": "+r:"")=>class extends Error{constructor(e){super(r(e)+o(e))}};const cd=bd(()=>"illegal state");const dd=e=>{throw new cd(e)};const Wa=Array.isArray;const ed=t=>"string"==typeof t;const fd=r=>r&&(r instanceof Float32Array||r instanceof Float64Array||r instanceof Uint32Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Int8Array||r instanceof Uint16Array||r instanceof Int16Array||r instanceof Uint8ClampedArray);const ia=t=>Wa(t)?t:ed(t)?t.length>0?t.split("."):[]:null!=t?[t]:[];const gd=e=>Xa(e);function Xa(e){const t=ia(e),[r,l,n,$]=t;switch(t.length){case 0:return e=>e;case 1:return e=>null!=e?e[r]:void 0;case 2:return e=>null!=e&&null!=(e=e[r])?e[l]:void 0;case 3:return e=>null!=e&&null!=(e=e[r])&&null!=(e=e[l])?e[n]:void 0;case 4:return e=>null!=e&&null!=(e=e[r])&&null!=(e=e[l])&&null!=(e=e[n])?e[$]:void 0;default:return e=>{const r=t.length-1;let l=e;for(let n=0;null!=l&&n<=r;n++)l=l[t[n]];return l};}}function Ya($){const e=ia($),[t,r,o,p]=e;switch(e.length){case 0:return($,e)=>e;case 1:return($,e)=>($=i($),$[t]=e,$);case 2:return($,e)=>{let o;return($=i($))[t]=o=i($[t]),o[r]=e,$};case 3:return($,e)=>{let p,c;return($=i($))[t]=p=i($[t]),p[r]=c=i(p[r]),c[o]=e,$};case 4:return($,e)=>{let c,B,E;return($=i($))[t]=c=i($[t]),c[r]=B=i(c[r]),B[o]=E=i(B[o]),E[p]=e,$};default:let $;for(let t=e.length;--t>=0;)$=hd(e[t],$);return $;}}const i=$=>Wa($)||fd($)?$.slice():Object.assign({},$);const hd=($,e)=>(t,r)=>(t=i(t),t[$]=e?e(t[$],r):r,t);const Za=(e,p,$,...t)=>id(e,p,$,...t);function id(e,p,$,...t){return Ya(p)(e,$.apply(null,(t.unshift(Xa(p)(e)),t)))}const $a=(e,$,t)=>Ya($)(e,t);let _a=class{constructor(e,t){t&&!t(e)&&dd("initial state value did not validate"),this._value=e,this.valid=t}get value(){return this._value}set value(e){this.reset(e)}deref(){return this._value}equiv(e){return this===e}reset(e){const t=this._value;return this.valid&&!this.valid(e)?t:(this._value=e,this.notifyWatches(t,e),e)}resetIn(e,t){return this.reset($a(this._value,e,t))}resetInUnsafe(e,t){return this.reset($a(this._value,e,t))}swap(e,...t){return this.reset(e.apply(null,[this._value,...t]))}swapIn(e,t,...r){return this.reset(Za(this._value,e,t,...r))}swapInUnsafe(e,t,...r){return this.reset(Za(this._value,e,t,...r))}addWatch(e,t){}removeWatch(e){}notifyWatches(e,t){}release(){return delete this._watches,delete this._value,!0}};_a=ga([ad],_a);let jd=0;const kd=()=>jd++;const ab=Object.getPrototypeOf({}),w=(e,t)=>{let $;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=($=Object.getPrototypeOf(e))&&$!==ab||null!=($=Object.getPrototypeOf(t))&&$!==ab?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?ld(e,t):e instanceof Set&&t instanceof Set?md(e,t):e instanceof Map&&t instanceof Map?nd(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:od(e,t)))};const ld=(e,t,$=w)=>{let o=e.length;if(o===t.length)for(;--o>=0&&$(e[o],t[o]););return o<0};const md=(e,t,$=w)=>e.size===t.size&&$([...e.keys()].sort(),[...t.keys()].sort());const nd=(e,t,$=w)=>e.size===t.size&&$([...e].sort(),[...t].sort());const od=(e,t,$=w)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let o in e)if(!t.hasOwnProperty(o)||!$(e[o],t[o]))return!1;return!0};function bb(t,e,i,s,r){return new pd(t,e,i,s,r)}class pd{constructor(t,e,i,s=!0,r=w){this.parent=t,this.id=`view-${kd()}`,this.tx=i||(t=>t),this.path=ia(e),this.isDirty=!0,this.isLazy=s;const $=gd(this.path),h=this.parent.deref();this.unprocessed=h?$(h):void 0,s||(this.state=this.tx(this.unprocessed),this.unprocessed=void 0),t.addWatch(this.id,(t,e,i)=>{const h=e?$(e):e,o=i?$(i):i;r(o,h)||(s?this.unprocessed=o:this.state=this.tx(o),this.isDirty=!0)})}get value(){return this.deref()}deref(){return this.isDirty&&(this.isLazy&&(this.state=this.tx(this.unprocessed),this.unprocessed=void 0),this.isDirty=!1),this.state}changed(){return this.isDirty}view(){return this.isDirty&&this.isLazy?this.tx(this.unprocessed):this.state}release(){return this.unprocessed=void 0,this.isLazy||(this.state=this.tx(void 0)),this.isDirty=!0,this.parent.removeWatch(this.id)}}const qd=o=>"function"==typeof o;const ja=(n,t)=>null!=n&&"function"==typeof n[t];const x=Array.isArray;const rd=t=>null!=t&&"function"!=typeof t&&void 0!==t.length;const sd=t=>"string"==typeof t;const td=e=>null!=e&&"function"==typeof e[Symbol.iterator];const cb=t=>null!=t&&"string"!=typeof t&&"function"==typeof t[Symbol.iterator];const db=Object.getPrototypeOf,ud=$=>{let r;return null!=$&&"object"==typeof $&&(null===(r=db($))||null===db(r))};const eb=Symbol();let ka,la;const fb=Object.getPrototypeOf({}),m=(e,t)=>{let $;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=($=Object.getPrototypeOf(e))&&$!==fb||null!=($=Object.getPrototypeOf(t))&&$!==fb?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?gb(e,t):e instanceof Set&&t instanceof Set?hb(e,t):e instanceof Map&&t instanceof Map?ib(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:jb(e,t)))};const gb=(e,t,$=m)=>{let o=e.length;if(o===t.length)for(;--o>=0&&$(e[o],t[o]););return o<0};const hb=(e,t,$=m)=>e.size===t.size&&$([...e.keys()].sort(),[...t.keys()].sort());const ib=(e,t,$=m)=>e.size===t.size&&$([...e].sort(),[...t].sort());const jb=(e,t,$=m)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let o in e)if(!t.hasOwnProperty(o)||!$(e[o],t[o]))return!1;return!0};let vd=[],wd=[];const xd=r=>ka&&ka.length>=r?ka:ka=new Int32Array(r),yd=r=>la&&la.length>=r?la:la=new Int32Array(r),kb=(r,$,e,a,t)=>{const c=$.length,l=r.linear;if(r.distance=c,0!==t){for(let r=0,e=0;r<c;r++,e+=3)l[e]=a,l[e+1]=r,l[e+2]=$[r];if(3===t){const a=r[e];for(let r=0;r<c;r++)a[r]=$[r]}}return r},zd=(r,$,e=3,a=m)=>{const t={distance:0,adds:{},dels:{},const:{},linear:[]};if(r===$||null==r&&null==$)return t;if(null==r||0===r.length)return kb(t,$,"adds",1,e);if(null==$||0===$.length)return kb(t,r,"dels",-1,e);const c=r.length>=$.length;let l,n,h,s;c?(l=$,n=r):(l=r,n=$),h=l.length,s=n.length;const d=h+1,o=s-h,i=o+d,z=h+s+3,J=yd(z).fill(-1,0,z),f=xd(z).fill(-1,0,z),v=vd,u=wd;v.length=0,u.length=0;const P=(r,$,e)=>{const t=r+d;let c,o;$>e?(c=J[t-1],o=$):(c=J[t+1],o=e);let i=o-r;for(;i<h&&o<s&&a(l[i],n[o]);)i++,o++;return J[t]=u.length/3,u.push(i,o,c),o};let g,p,_=-1;do{for(p=(g=-++_)+d;g<o;g++,p++)f[p]=P(g,f[p-1]+1,f[p+1]);for(p=(g=o+_)+d;g>o;g--,p--)f[p]=P(g,f[p-1]+1,f[p+1]);f[i]=P(o,f[i-1]+1,f[i+1])}while(f[i]!==s);if(t.distance=o+2*_,0!==e){for(_=3*J[i];_>=0;)v.push(_),_=3*u[_+2];3===e?Ad(v,u,t,l,n,c):Bd(v,u,t,l,n,c,1===e)}return t};const Ad=(r,$,e,a,t,c)=>{const l=e.linear,n=e.const;let h,s,d,o,i=r.length,z=0,J=0;for(c?(h=e.dels,s=e.adds,d=-1,o=1):(h=e.adds,s=e.dels,d=1,o=-1);--i>=0;){const e=r[i],c=$[e],f=$[e+1],v=f-c;for(;z<c||J<f;){const r=J-z;v>r?(l.push(d,J,h[J]=t[J]),J++):v<r?(l.push(o,z,s[z]=a[z]),z++):(l.push(0,z,n[z]=a[z]),z++,J++)}}},Bd=(r,$,e,a,t,c,l)=>{const n=e.linear,h=c?-1:1,s=c?1:-1;let d=r.length,o=0,i=0;for(;--d>=0;){const e=r[d],c=$[e],z=$[e+1],J=z-c;for(;o<c||i<z;){const r=i-o;J>r?(n.push(h,i,t[i]),i++):J<r?(n.push(s,o,a[o]),o++):(l&&n.push(0,o,a[o]),o++,i++)}}};const Cd=(t,e,$=3,i=m)=>t===e?{distance:0}:0===$?Dd(t,e,i):Ed(t,e,i);const Dd=(t,e,$)=>{t||(t={}),e||(e={});let i=0;for(let r in t){const f=e[r];(void 0===f||!$(t[r],f))&&i++}for(let r in e)!(r in t)&&i++;return{distance:i}},Ed=(t,e,$)=>{t||(t={}),e||(e={});let i=0;const r=[],f=[],s=[];for(let n in t){const r=e[n];void 0===r?(f.push(n),i++):$(t[n],r)||(s.push(n,r),i++)}for(let n in e)n in t||(r.push(n),i++);return{distance:i,adds:r,dels:f,edits:s}};const J=Array.isArray,Fd=Math.max,lb=Object.getPrototypeOf({}),mb=(()=>{const e=new Array(2048);for(let t=2,r=e.length;t<r;t++)e[t]=t-2;return e})(),Gd=e=>{if(e<=mb.length)return mb.slice(0,e);const t=new Array(e);for(;--e>=2;)t[e]=e-2;return t},nb=(e,t,r,$,i,o=0)=>{const n=i[1];if(n.__skip)return;if(!1===n.__diff)return y($),void t.replaceChild(e,r,o,i);const f=$[1];if(f&&f.__skip)return void t.replaceChild(e,r,o,i,!1);let s=n.__impl;if(s&&s!==t)return s.diffTree(e,s,r,$,i,o);const a=zd($,i,1,z);if(0===a.distance)return;const h=a.linear,T=t.getChild(r,o);let l,p,v,K;if(0!==h[0]||$[1].key!==n.key)return y($),void t.replaceChild(e,r,o,i);if((K=$.__release)&&K!==i.__release&&y($),0!==h[3]&&(Ld(t,T,$[1],i[1]),2===a.distance))return;const Q=h.length,d=$.length-1,u=Md(h),c=Gd(d+1);for(l=2,p=6;p<Q;l++,p+=3)(v=h[p])&&(-1===v?Hd(e,t,T,$,i,h,p,u,c,d):Id(e,t,T,h,p,u,c,d));(K=i.__init)&&K!=$.__init&&K.apply(i,[T,...i.__args])};const Hd=(e,t,r,$,i,o,n,f,s,a)=>{const h=o[n+2];if(J(h)){let T=h[1].key;if(void 0!==T&&void 0!==f[T][2]){const o=f[T];T=o[0],nb(e,t,r,$[T],i[o[2]],s[T])}else{const e=o[n+1];y(h),t.removeChild(r,s[e]),Jd(s,a,e)}}else"string"==typeof h&&t.setContent(r,"")},Id=(e,t,r,$,i,o,n,f)=>{const s=$[i+2];if("string"==typeof s)t.setContent(r,s);else if(J(s)){const a=s[1].key;if(void 0===a||void 0===o[a][0]){const o=$[i+1];t.createTree(e,r,s,n[o]),Kd(n,f,o)}}},Jd=(e,t,r)=>{for(;t>r;t--)e[t]=Fd(e[t]-1,0)},Kd=(e,t,r)=>{for(;t>=r;t--)e[t]++},Ld=(e,t,r,$)=>{const i=Cd(r,$,3,m);e.removeAttribs(t,i.dels,r);let o,n,f,s=eb;for(o=(f=i.edits).length;(o-=2)>=0;)0===(n=f[o]).indexOf("on")&&e.removeAttribs(t,[n],r),"value"!==n?e.setAttrib(t,n,f[o+1],$):s=f[o+1];for(o=(f=i.adds).length;--o>=0;)"value"!==(n=f[o])?e.setAttrib(t,n,$[n],$):s=$[n];s!==eb&&e.setAttrib(t,"value",s,$)};const y=e=>{if(J(e)){let t;if((t=e[1])&&!1===t.__release)return;for(e.__release&&(e.__release.apply(e.__this,e.__args),delete e.__release),t=e.length;--t>=2;)y(e[t])}};const Md=e=>{let t,r,$;const i={};for(let o=e.length;(o-=3)>=0;)r=e[o+2],J(r)&&void 0!==(t=r[1].key)&&(!($=i[t])&&(i[t]=$=[,,]),$[e[o]+1]=e[o+1]);return i},z=(e,t)=>{let r;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=(r=Object.getPrototypeOf(e))&&r!==lb||null!=(r=Object.getPrototypeOf(t))&&r!==lb?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?gb(e,t,z):e instanceof Set&&t instanceof Set?hb(e,t,z):e instanceof Map&&t instanceof Map?ib(e,t,z):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:!(!1===e.__diff||!1===t.__diff)&&jb(e,t,z)))};const Nd="http://www.w3.org/2000/svg";const Od={"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&apos;"};const Pd=/^([^\s\.#]+)(?:#([^\s\.#]+))?(?:\.([^\s#]+))?$/;const r=new RegExp(`[${Object.keys(Od).join("")}]`,"g");const Qd={button:1,option:1,text:1,textarea:1};const ob=e=>e.split(" ").reduce((e,t)=>(e[t]=!0,e),{}),Rd=ob("animate animateColor animateMotion animateTransform circle clipPath color-profile defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font foreignObject g image line linearGradient marker mask metadata mpath path pattern polygon polyline radialGradient rect set stop style svg switch symbol text textPath title tref tspan use view");const Lh=ob("area base br circle col command ellipse embed hr img input keygen line link meta param path polygon polyline rect source stop track use wbr ?xml");const Sd=t=>{let $,r="";for(let e in t)$=t[e],qd($)&&($=$(t)),null!=$&&(r+=`${e}:${$};`);return r};const Td=(e,t)=>{if(null==e||!t||!t.length)return e;const r=Object.assign({},e);for(let n of t){const e=r[n];ja(e,"deref")&&(r[n]=e.deref())}return r};const K=x,pb=cb,qb=(e,t)=>t.__init&&t.__init.apply(t.__this,[e,...t.__args]),L=(e,t,r,s,$,n=!0)=>{if(K(s)){const o=s[0];if("function"==typeof o)return L(e,t,r,o.apply(null,[e.ctx,...s.slice(1)]),$);const a=s[1];if(a.__impl)return a.__impl.createTree(e,r,s,$,n);const i=t.createElement(r,o,a,$);if(s.length>2){const r=s.length;for(let $=2;$<r;$++)L(e,t,i,s[$],void 0,n)}return n&&qb(i,s),i}if(pb(s)){const o=[];for(let a of s)o.push(L(e,t,r,a,$,n));return o}return null==s?r:t.createTextElement(r,s)};const M=(e,t,r,s,$=0)=>{if(K(s)){const n=t.getChild(r,$);"function"==typeof s[0]&&M(e,t,r,s[0].apply(null,[e.ctx,...s.slice(1)]),$);const o=s[1];if(o.__impl)return o.__impl.hydrateTree(e,r,s,$);qb(n,s);for(let e in o)0===e.indexOf("on")&&t.setAttrib(n,e,o[e]);for(let r=s.length,$=2;$<r;$++)M(e,t,n,s[$],$-2)}else if(pb(s))for(let n of s)M(e,t,r,n,$),$++};const Ud=(e,t,r,s)=>{const $=Rd[t]?document.createElementNS(Nd,t):document.createElement(t);return r&&Zd($,r),rb(e,$,s)};const Vd=(e,t,r)=>rb(e,document.createTextNode(t),r);const rb=(e,t,r)=>e?void 0===r?e.appendChild(t):e.insertBefore(t,e.children[r]):t;const Wd=(e,t)=>e.children[t];const Xd=(e,t,r,s,$,n=!0)=>(t.removeChild(r,s),t.createTree(e,r,$,s,n));const Yd=(e,t)=>e.textContent=t;const Zd=(e,t)=>{for(let r in t)sb(e,r,t[r],t);return e};const sb=(e,t,r,s)=>{if(t.startsWith("__"))return;const $=0===t.indexOf("on");if($||"function"!=typeof r||(r=r(s)),void 0!==r&&!1!==r)switch(t){case"style":ae(e,r);break;case"value":$d(e,r);break;case"accesskey":e.accessKey=r;break;case"contenteditable":e.contentEditable=r;break;case"tabindex":e.tabIndex=r;break;case"align":case"autocapitalize":case"checked":case"dir":case"draggable":case"hidden":case"id":case"lang":case"namespaceURI":case"scrollTop":case"scrollLeft":case"title":e[t]=r;break;default:$?be(e,t.substr(2),r):e.setAttribute(t,!0===r?"":r);}else null!=e[t]?e[t]=null:e.removeAttribute(t);return e};const $d=(e,t)=>{let r;switch(e.type){case"text":case"textarea":case"password":case"search":case"number":case"email":case"url":case"tel":case"date":case"datetime-local":case"time":case"week":case"month":if(void 0!==(r=e.value)&&"string"==typeof t){const s=t.length-(r.length-(e.selectionStart||0));e.value=t,e.selectionStart=e.selectionEnd=s;break}default:e.value=t;}};const _d=(e,t,r)=>{for(let s=t.length;--s>=0;){const $=t[s];0===$.indexOf("on")?ce(e,$.substr(2),r[$]):e.hasAttribute($)?e.removeAttribute($):e[$]=null}};const ae=(e,t)=>(e.setAttribute("style",Sd(t)),e);const be=(e,t,r)=>K(r)?e.addEventListener(t,...r):e.addEventListener(t,r);const ce=(e,t,r)=>K(r)?e.removeEventListener(t,...r):e.removeEventListener(t,r);const de=(e,t)=>{const r=e.children[t];void 0!==r&&e.removeChild(r)};const ee=(r,o=r=>void 0!==r?": "+r:"")=>class extends Error{constructor(e){super(r(e)+o(e))}};const fe=ee(()=>"illegal argument(s)");const ge=r=>{throw new fe(r)};const N=x,he=cb,ie=ud,je=(e,r)=>{let $,i,t,n,a,o=e[0],l=ie(e[1]);return"string"==typeof o&&($=Pd.exec(o))||ge(`${o} is not a valid tag name`),o!==(i=$[1])||!l||r&&!e[1].key?(a=l?Object.assign({},e[1]):{},t=$[2],n=$[3],t&&(a.id=t),n&&(n=n.replace(/\./g," "),a.class?a.class+=" "+n:a.class=n),a.__skip&&e.length<3?[i,a]:[i,a,...e.slice(l?2:1)]):e};const ke=(e,r)=>k(r,e,e.ctx,[0],!1!==e.keys,!1!==e.span);const k=(e,r,$,i,t,n)=>{if(null!=e){if(N(e)){if(0===e.length)return;let a,o,l=e[1];if(l&&(o=l.__impl)&&(o=o.normalizeTree))return o(r,e);const s=e[0];if("function"==typeof s)return k(s.apply(null,[$,...e.slice(1)]),r,$,i,t,n);if("function"==typeof s.render){const o=[$,...e.slice(1)];return a=k(s.render.apply(s,o),r,$,i,t,n),N(a)&&(a.__this=s,a.__init=s.init,a.__release=s.release,a.__args=o),a}if(!1===(l=(a=je(e,t))[1]).__normalize)return a;if(t&&void 0===l.key&&(l.key=i.join("-")),a.length>2){const e=a[0],o=[e,l];n=n&&!Qd[e];for(let l=2,s=2,x=0,c=a.length;l<c;l++){let e=a[l];if(null!=e){const a=N(e);if(a&&N(e[0])||!a&&he(e))for(let l of e)void 0!==(l=k(l,r,$,i.concat(x),t,n))&&(o[s++]=l),x++;else void 0!==(e=k(e,r,$,i.concat(x),t,n))&&(o[s++]=e),x++}}return o}return a}return"function"==typeof e?k(e($),r,$,i,t,n):"function"==typeof e.toHiccup?k(e.toHiccup(r.ctx),r,$,i,t,n):"function"==typeof e.deref?k(e.deref(),r,$,i,t,n):n?["span",t?{key:i.join("-")}:{},e.toString()]:e.toString()}};const le={createTree(e,t,r,$,i){return L(e,this,t,r,$,i)},hydrateTree(e,t,r,$){return M(e,this,t,r,$)},diffTree(e,t,r,$,i){nb(e,this,t,r,$,i)},normalizeTree:ke,getElementById:e=>document.getElementById(e),getChild:Wd,createElement:Ud,createTextElement:Vd,replaceChild(e,t,r,$,i){Xd(e,this,t,r,$,i)},removeChild:de,setContent:Yd,removeAttribs:_d,setAttrib:sb};const me=(e,o)=>sd(e)?o.getElementById(e):e;const ne=(e,r={},t=le)=>{const a=Object.assign({root:"app"},r);let $=[],n=!0;const o=me(a.root,t),i=()=>{if(n){a.ctx=Td(r.ctx,a.autoDerefKeys);const f=t.normalizeTree(a,e);null!=f&&(a.hydrate?(t.hydrateTree(a,o,f),a.hydrate=!1):t.diffTree(a,o,$,f),$=f),n&&requestAnimationFrame(i)}};return requestAnimationFrame(i),()=>n=!1};var oe,tb;(function($){$[$.FINE=0]="FINE",$[$.DEBUG=1]="DEBUG",$[$.INFO=2]="INFO",$[$.WARN=3]="WARN",$[$.SEVERE=4]="SEVERE",$[$.NONE=5]="NONE"})(tb||(oe=tb={},oe));var pe=(ha(),{});const Mh=Symbol();const qe=()=>{};const re="*";const ma=void 0===pe?(r,$="assertion failed")=>{if("function"==typeof r&&!r()||!r)throw new Error("function"==typeof $?$():$)}:qe;const se=Object.freeze({level:tb.NONE,fine(){},debug(){},info(){},warn(){},severe(){}});const ub=(e,t={})=>{const o=Reflect.ownKeys(e),r=Reflect.ownKeys(t),n=Symbol("isa");function i(t){for(let r of o){const o=Object.getOwnPropertyDescriptor(t.prototype,r);!o||o.configurable?Object.defineProperty(t.prototype,r,{value:e[r],writable:!0}):console.log(`not patching: ${t.name}.${r.toString()}`)}return Object.defineProperty(t.prototype,n,{value:!0}),t}for(let p of r)Object.defineProperty(i,p,{value:t[p],enumerable:t.propertyIsEnumerable(p)});return Object.defineProperty(i,Symbol.hasInstance,{value:e=>!!e[n]}),i};const vb=(e,t)=>{if(e)for(let i,r=0,s=e.length;r<s;r++)if((i=e[r])[0].call(i[1],t),t.canceled)return};const te=ub({addListener(e,t,i){let r=(this._listeners=this._listeners||{})[e];return!r&&(r=this._listeners[e]=[]),-1===this.__listener(r,t,i)&&(r.push([t,i]),!0)},removeListener(e,t,i){let r;if(!(r=this._listeners))return!1;const s=r[e];if(s){const n=this.__listener(s,t,i);if(-1!==n)return s.splice(n,1),!s.length&&delete r[e],!0}return!1},notify(e){let t;if(!(t=this._listeners))return!1;void 0===e.target&&(e.target=this),vb(t[e.id],e),vb(t[re],e)},__listener(e,t,i){let r=e.length;for(;--r>=0;){const s=e[r];if(s[0]===t&&s[1]===i)break}return r}});const ue=ub({addWatch(t,e){return this._watches=this._watches||{},!this._watches[t]&&(this._watches[t]=e,!0)},removeWatch(t){if(this._watches)return!!this._watches[t]&&(delete this._watches[t],!0)},notifyWatches(t,e){if(!this._watches)return;const i=this._watches;for(let h in i)i[h](h,t,e)}});const n="--set-value";const ve="--update-value";const O="--toggle-value";const na="--cancel";const we="--dispatch";const wb="--dispatch-async";const d="--dispatch-now";const xb="--delay";const xe="--fetch";const h="--state";const ye="--redo";const ze="--undo";let p=se;const oa=(r,o=r=>void 0!==r?": "+r:"")=>class extends Error{constructor(s){super(r(s)+o(s))}};const Ae=oa(()=>"illegal argument(s)");const yb=r=>{throw new Ae(r)};const Be=oa(()=>"illegal arity");const zb=r=>{throw new Be(r)};const Ce=oa(()=>"illegal state");const De=r=>{throw new Ce(r)};const Ab=Array.isArray;const Ee=t=>"string"==typeof t;const Fe=r=>r&&(r instanceof Float32Array||r instanceof Float64Array||r instanceof Uint32Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Int8Array||r instanceof Uint16Array||r instanceof Int16Array||r instanceof Uint8ClampedArray);const Bb=t=>Ab(t)?t:Ee(t)?t.length>0?t.split("."):[]:null!=t?[t]:[];function Cb(e){const t=Bb(e),[r,l,n,$]=t;switch(t.length){case 0:return e=>e;case 1:return e=>null!=e?e[r]:void 0;case 2:return e=>null!=e&&null!=(e=e[r])?e[l]:void 0;case 3:return e=>null!=e&&null!=(e=e[r])&&null!=(e=e[l])?e[n]:void 0;case 4:return e=>null!=e&&null!=(e=e[r])&&null!=(e=e[l])&&null!=(e=e[n])?e[$]:void 0;default:return e=>{const r=t.length-1;let l=e;for(let n=0;null!=l&&n<=r;n++)l=l[t[n]];return l};}}const Ge=$=>P($);function P($){const e=Bb($),[t,r,o,p]=e;switch(e.length){case 0:return($,e)=>e;case 1:return($,e)=>($=j($),$[t]=e,$);case 2:return($,e)=>{let o;return($=j($))[t]=o=j($[t]),o[r]=e,$};case 3:return($,e)=>{let p,c;return($=j($))[t]=p=j($[t]),p[r]=c=j(p[r]),c[o]=e,$};case 4:return($,e)=>{let c,C,G;return($=j($))[t]=c=j($[t]),c[r]=C=j(c[r]),C[o]=G=j(C[o]),G[p]=e,$};default:let $;for(let t=e.length;--t>=0;)$=He(e[t],$);return $;}}const j=$=>Ab($)||Fe($)?$.slice():Object.assign({},$);const He=($,e)=>(t,r)=>(t=j(t),t[$]=e?e(t[$],r):r,t);const Q=(e,$,t,...r)=>Ie(e,$,t,...r);function Ie(e,$,t,...r){return P($)(e,t.apply(null,(r.unshift(Cb($)(e)),r)))}const pa=(e,$,t)=>P($)(e,t);const Je=(e,$)=>Ke(e,$);function Ke(e,$){const r=Cb(e),t=P(e);return(e,...a)=>t(e,$.apply(null,(a.unshift(r(e)),a)))}let Db=class{constructor(e,t){t&&!t(e)&&De("initial state value did not validate"),this._value=e,this.valid=t}get value(){return this._value}set value(e){this.reset(e)}deref(){return this._value}equiv(e){return this===e}reset(e){const t=this._value;return this.valid&&!this.valid(e)?t:(this._value=e,this.notifyWatches(t,e),e)}resetIn(e,t){return this.reset(pa(this._value,e,t))}resetInUnsafe(e,t){return this.reset(pa(this._value,e,t))}swap(e,...t){return this.reset(e.apply(null,[this._value,...t]))}swapIn(e,t,...r){return this.reset(Q(this._value,e,t,...r))}swapInUnsafe(e,t,...r){return this.reset(Q(this._value,e,t,...r))}addWatch(e,t){}removeWatch(e){}notifyWatches(e,t){}release(){return delete this._watches,delete this._value,!0}};Db=ga([ue],Db);const Eb=o=>"function"==typeof o;const Le=(n,t)=>null!=n&&"function"==typeof n[t];const R=Array.isArray;const Me=i=>i instanceof Promise;class Ne{constructor(t,e){this.handlers={},this.effects={},this.eventQueue=[],this.priorities=[],this.addBuiltIns(),t&&this.addHandlers(t),e&&this.addEffects(e)}addBuiltIns(){this.addEffects({[we]:[t=>this.dispatch(t),-999],[wb]:[([t,e,r,s],i,$)=>{const o=this.effects[t];if(o){const t=o(e,i,$);Me(t)?t.then(t=>this.dispatch([r,t])).catch(t=>this.dispatch([s,t])):p.warn("async effect did not return Promise")}else p.warn(`skipping invalid async effect: ${t}`)},-999],[xb]:[([t,e])=>new Promise(r=>setTimeout(()=>r(e),t)),1e3],[xe]:[t=>fetch(t).then(t=>{if(!t.ok)throw new Error(t.statusText);return t}),1e3]})}addHandler(t,e){const r=this.interceptorsFromSpec(e);r.length>0?(this.handlers[t]&&(this.removeHandler(t),p.warn(`overriding handler for ID: ${t}`)),this.handlers[t]=r):yb(`no handlers in spec for ID: ${t}`)}addHandlers(t){for(let e in t)this.addHandler(e,t[e])}addEffect(t,e,r=1){this.effects[t]&&(this.removeEffect(t),p.warn(`overriding effect for ID: ${t}`)),this.effects[t]=e;const s=[t,r],i=this.priorities;for(let $=0;$<i.length;$++)if(s[1]<i[$][1])return void i.splice($,0,s);i.push(s)}addEffects(t){for(let e in t){const r=t[e];R(r)?this.addEffect(e,r[0],r[1]):this.addEffect(e,r)}}instrumentWith(t,e){const r=t.map(Fb),s=this.handlers;for(let i of e||Object.keys(s)){const t=s[i];t&&(s[i]=r.concat(t))}}removeHandler(t){delete this.handlers[t]}removeHandlers(t){for(let e of t)this.removeHandler(e)}removeEffect(t){delete this.effects[t];const e=this.priorities;for(let r=e.length-1;r>=0;r--)if(t===e[r][0])return void e.splice(r,1)}removeEffects(t){for(let e of t)this.removeEffect(e)}context(){return this.currCtx}dispatch(...t){this.eventQueue.push(...t)}dispatchNow(...t){(this.currQueue||this.eventQueue).push(...t)}dispatchLater(t,e=17){setTimeout(()=>this.dispatch(t),e)}processQueue(t){if(this.eventQueue.length>0){this.currQueue=[...this.eventQueue],this.eventQueue.length=0,t=this.currCtx=t||{};for(let e of this.currQueue)this.processEvent(t,e);return this.currQueue=this.currCtx=void 0,this.processEffects(t),!0}return!1}processEvent(t,e){const r=this.handlers[e[0]];r?this.processForward(t,r,e)&&this.processReverse(t,r,e):p.warn(`missing handler for event type: ${e[0].toString()}`)}processForward(t,e,r){let s=!1;for(let i=0,$=e.length;i<$&&!t[na];i++){const $=e[i];$.pre&&this.mergeEffects(t,$.pre(t[h],r,this,t)),s=s||!!$.post}return s}processReverse(t,e,r){for(let s=e.length;--s>=0&&!t[na];){const i=e[s];i.post&&this.mergeEffects(t,i.post(t[h],r,this,t))}}processEffects(t){const e=this.effects;for(let r of this.priorities){const s=r[0],i=t[s];void 0!==i&&this.processEffect(t,e,s,i)}}processEffect(t,e,r,s){const i=e[r];if(r!==h)for(let $ of s)i($,this,t);else i(s,this,t)}mergeEffects(t,e){if(e)for(let r in e){const s=e[r];if(null!=s)if(r===h||r===na)t[r]=s;else if(r===d){if(R(s[0]))for(let t of s)t&&this.dispatchNow(t);else this.dispatchNow(s);}else if(t[r]||(t[r]=[]),R(s[0]))for(let e of s)void 0!==e&&t[r].push(e);else t[r].push(s)}}interceptorsFromSpec(t){return R(t)?t.map(Fb):Eb(t)?[{pre:t}]:[t]}}class Oe extends Ne{constructor(t,e,r){super(e,r),this.state=t||new Db({})}deref(){return this.state.deref()}addBuiltIns(){super.addBuiltIns(),this.addHandlers({[n]:(t,[e,[r,s]])=>({[h]:pa(t,r,s)}),[ve]:(t,[e,[r,s,...i]])=>({[h]:Q(t,r,s,...i)}),[O]:(t,[e,r])=>({[h]:Q(t,r,t=>!t)}),[ze]:Gb("undo"),[ye]:Gb("redo")}),this.addEffects({[h]:[t=>this.state.reset(t),-1e3]})}processQueue(t){if(this.eventQueue.length>0){const e=this.state.deref();this.currQueue=[...this.eventQueue],this.eventQueue.length=0,t=this.currCtx=Object.assign(Object.assign({},t),{[h]:e});for(let r of this.currQueue)this.processEvent(t,r);return this.currQueue=this.currCtx=void 0,this.processEffects(t),this.state.deref()!==e}return!1}}const Fb=t=>Eb(t)?{pre:t}:t,Gb=t=>(e,[r,s],i,$)=>{const o=s?s[0]:"history";if(Le($[o],t)){const e=$[o][t]();return{[h]:i.state.deref(),[d]:s?void 0!==e?s[1]:s[2]:void 0}}p.warn("no history in context")};const Pe=(e,$)=>{const t=Ge(e);return(e,[r,o])=>({[h]:t(e,$?$(o):o)})};const Qe=(e,$)=>{const t=Je(e,$);return(e,[$,...r])=>({[h]:t(e,...r)})};const A="route-changed";const qa=t=>"string"==typeof t;const Hb=Object.getPrototypeOf({}),s=(e,t)=>{let $;return e===t||(null==e?e==t:"function"==typeof e.equiv?e.equiv(t):null==t?e==t:"function"==typeof t.equiv?t.equiv(e):"string"!=typeof e&&"string"!=typeof t&&(null!=($=Object.getPrototypeOf(e))&&$!==Hb||null!=($=Object.getPrototypeOf(t))&&$!==Hb?"function"!=typeof e&&void 0!==e.length&&"function"!=typeof t&&void 0!==t.length?Re(e,t):e instanceof Set&&t instanceof Set?Se(e,t):e instanceof Map&&t instanceof Map?Te(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:Ue(e,t)))};const Re=(e,t,$=s)=>{let o=e.length;if(o===t.length)for(;--o>=0&&$(e[o],t[o]););return o<0};const Se=(e,t,$=s)=>e.size===t.size&&$([...e.keys()].sort(),[...t.keys()].sort());const Te=(e,t,$=s)=>e.size===t.size&&$([...e].sort(),[...t].sort());const Ue=(e,t,$=s)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let o in e)if(!t.hasOwnProperty(o)||!$(e[o],t[o]))return!1;return!0};let Ib=class{constructor(t){if(t.authenticator=t.authenticator||((t,i,r)=>({id:t.id,title:t.title,params:r})),t.prefix=void 0===t.prefix?"/":t.prefix,t.separator=t.separator||"/",this.config=t,ma(void 0!==this.routeForID(this.config.defaultRouteID),`missing config for default route: '${this.config.defaultRouteID}'`),t.initialRouteID){const i=this.routeForID(t.initialRouteID);ma(void 0!==i,`missing config for initial route: ${this.config.initialRouteID}`),ma(!Ve(i),"initial route MUST not be parametric")}}addListener(t,i,r){}removeListener(t,i,r){}notify(t){}start(){if(this.config.initialRouteID){const t=this.routeForID(this.config.initialRouteID);this.current={id:t.id,title:t.title,params:{}},this.notify({id:A,value:this.current})}}route(t){"#"===t.charAt(0)&&(t=t.substr(1)),t=t.substr(this.config.prefix.length);const i=this.config.routes,r=t.split(this.config.separator);let e;for(let o=0,a=i.length;o<a;o++){const t=i[o],a=this.matchRoute(r,t);if(a){e=a;break}}if(!e){if(!this.handleRouteFailure())return;const t=this.routeForID(this.config.defaultRouteID);e={id:t.id,title:t.title,params:{}}}return s(e,this.current)||(this.current=e,this.notify({id:A,value:e})),e}format(...t){let i,[r,e,o]=t;switch(t.length){case 3:i={id:r,params:e};break;case 2:qa(r)?i={id:r,params:e}:(o=e,i=r);break;case 1:i=qa(r)?{id:r}:r;break;default:zb(t.length);}const a=this.routeForID(i.id);if(a){const t=i.params||{};return(o?"#":"")+this.config.prefix+a.match.map(i=>"?"===i.charAt(0)?null!=(i=t[i.substr(1)])?i:"NULL":i).join(this.config.separator)}yb(`invalid route ID: ${i.id}`)}routeForID(t){return this.config.routes.find(i=>i.id===t)}matchRoute(t,i){const r=i.match,e=r.length;if(t.length===e){const o={};for(let i=0;i<e;i++){const e=r[i];if("?"===e.charAt(0))o[e.substr(1)]=t[i];else if(t[i]!==e)return}if(i.validate&&!this.validateRouteParams(o,i.validate))return;return i.auth?this.config.authenticator(i,t,o):{id:i.id,title:i.title,params:o}}}validateRouteParams(t,i){for(let r in i)if(void 0!==t[r]){const e=i[r];if(e.coerce&&(t[r]=e.coerce(t[r])),e.check&&!e.check(t[r]))return!1}return!0}handleRouteFailure(){return!0}};Ib=ga([te],Ib);const Ve=t=>t.match.some(t=>"?"===t.charAt(0));class We extends Ib{constructor(t){super(t),this.useFragment=!1!==t.useFragment,this.ignoreHashChange=!1}start(){if(window.addEventListener("popstate",this.handlePopChange()),this.useFragment&&window.addEventListener("hashchange",this.handleHashChange()),this.config.initialRouteID){const t=this.routeForID(this.config.initialRouteID);this.route(this.format({id:t.id,title:t.title}))}else this.route(this.useFragment?location.hash:location.pathname)}release(){window.removeEventListener("popstate",this.popHandler),this.useFragment&&window.removeEventListener("hashchange",this.hashHandler)}route(t,e=!0){const i=this.current,r=super.route(t);return r&&!s(r,i)&&(this.currentPath=this.format(r),e&&history.pushState(this.currentPath,r.title||window.document.title||"",this.currentPath)),r}routeTo(t){this.useFragment&&(location.hash=t),this.route(t)}format(...t){let e;switch(t.length){case 2:e={id:t[0],params:t[1]};break;case 1:e=qa(t[0])?{id:t[0]}:t[0];break;default:zb(t.length);}return super.format(e,this.useFragment)}handlePopChange(){return this.popHandler=this.popHandler||(t=>{this.route(t.state||(this.useFragment?location.hash:location.pathname),!1)}).bind(this)}handleHashChange(){return this.hashHandler=this.hashHandler||(t=>{if(!this.ignoreHashChange){const e=t.newURL.substr(t.newURL.indexOf("#"));e!==this.currentPath&&this.route(e,!1)}}).bind(this)}handleRouteFailure(){return this.ignoreHashChange=!0,location.hash=this.format({id:this.routeForID(this.config.defaultRouteID).id}),this.ignoreHashChange=!1,!0}}const Xe=([o,p,$],t)=>["option",{value:o,disabled:!!$,selected:o===t},p];const Ye=(o,p,$,t)=>["select",p,...$.map(o=>Xe(o,t))];function*Ze($,r){const e=B($)(f()),t=e[1],s=e[2];for(let i of r){const $=s([],i);if(q($))return void(yield*S(t($.deref())));$.length&&(yield*$)}yield*S(t([]))}function*ra($,r){const e=B($)([Jb,Jb,($,r)=>r])[2];for(let t of r){let $=e(sa,t);if(q($))return void(($=S($.deref()))!==sa&&(yield $));$!==sa&&(yield $)}}const sa=Symbol();const Jb=()=>{};const B=r=>ja(r,"xform")?r.xform():r;class C{constructor(e){this.value=e}deref(){return this.value}}const $e=e=>new C(e);const q=e=>e instanceof C;const _e=e=>e instanceof C?e:new C(e);const S=e=>e instanceof C?e.deref():e;function f($){return $?[...$]:gf(()=>[],($,r)=>($.push(r),$))}const af=(r,e=r=>void 0!==r?": "+r:"")=>class extends Error{constructor(o){super(r(o)+e(o))}};const bf=af(()=>"illegal arity");const Kb=r=>{throw new bf(r)};const cf=e=>2===e.length?[void 0,e[1]]:3===e.length?[e[1],e[2]]:Kb(e.length);function df(...e){const r=e[0],$=r[0],u=r[1],t=r[2],c=null==(e=cf(e))[0]?$():e[0],o=e[1];return S(u(ja(o,"$reduce")?o.$reduce(t,c):rd(o)?ef(t,c,o):ff(t,c,o)))}const ef=(e,r,$)=>{for(let u=0,t=$.length;u<t;u++)if(r=e(r,$[u]),q(r)){r=r.deref();break}return r},ff=(e,r,$)=>{for(let u of $)if(r=e(r,u),q(r)){r=r.deref();break}return r},gf=(e,r)=>[e,e=>e,r];const Lb=($,r,e=ra)=>{const t=r.length-1;return td(r[t])?r.length>1?e($.apply(null,r.slice(0,t)),r[t]):e($(),r[0]):void 0};function g(...e){let r,$;switch(e.length){case 4:$=e[3],r=e[2];break;case 3:$=e[2];break;case 2:return a(r=>g(e[0],e[1],r));default:Kb(e.length);}return df(B(e[0])(e[1]),r,$)}function a(t,r){return r?ra(a(t),r):r=>{const $=r[2];return ta(r,(r,e)=>$(r,t(e)))}}const ta=($,o)=>[$[0],$[1],o];const hf=e=>{const{1:r,2:$}=B(e)(f());let t=!1;return e=>{if(!t){let p=$([],e);return(t=q(p))&&(p=r(p.deref())),1===p.length?p[0]:p.length>0?p:void 0}}};function Mb(...e){let[r,$,t,o,u,c,p,n,s,a]=e;switch(e.length){case 0:lf(0);case 1:return r;case 2:return(...e)=>r($(...e));case 3:return(...e)=>r($(t(...e)));case 4:return(...e)=>r($(t(o(...e))));case 5:return(...e)=>r($(t(o(u(...e)))));case 6:return(...e)=>r($(t(o(u(c(...e))))));case 7:return(...e)=>r($(t(o(u(c(p(...e)))))));case 8:return(...e)=>r($(t(o(u(c(p(n(...e))))))));case 9:return(...e)=>r($(t(o(u(c(p(n(s(...e)))))))));case 10:default:const G=(...e)=>r($(t(o(u(c(p(n(s(a(...e))))))))));return 10===e.length?G:Mb(G,...e.slice(10));}}const jf=(r,o=r=>void 0!==r?": "+r:"")=>class extends Error{constructor(e){super(r(e)+o(e))}};const kf=jf(()=>"illegal arity");const lf=r=>{throw new kf(r)};function mf(...e){const[r,t,n,u,s,a,c,$]=e;switch(e.length){case 1:return e=>[r(e)];case 2:return e=>[r(e),t(e)];case 3:return e=>[r(e),t(e),n(e)];case 4:return e=>[r(e),t(e),n(e),u(e)];case 5:return e=>[r(e),t(e),n(e),u(e),s(e)];case 6:return e=>[r(e),t(e),n(e),u(e),s(e),a(e)];case 7:return e=>[r(e),t(e),n(e),u(e),s(e),a(e),c(e)];case 8:return e=>[r(e),t(e),n(e),u(e),s(e),a(e),c(e),$(e)];default:return r=>{let t=new Array(e.length);for(let n=e.length;--n>=0;)t[n]=e[n](r);return t};}}function Nb(e,t,r){return new nf(e,t,r)}class nf{constructor(e,t,r){void 0===e?(e=0,t=1/0):void 0===t&&(t=e,e=0),r=void 0===r?e<t?1:-1:r,this.from=e,this.to=t,this.step=r}*[Symbol.iterator](){const e=this.step,t=this.to;let r=this.from;if(e>0)for(;r<t;)yield r,r+=e;else if(e<0)for(;r>t;)yield r,r+=e}$reduce(e,t){const r=this.step;if(r>0)for(let o=this.from,$=this.to;o<$&&!q(t);o+=r)t=e(t,o);else for(let o=this.from,$=this.to;o>$&&!q(t);o+=r)t=e(t,o);return t}}function*of(...o){const t=o.map(o=>o[Symbol.iterator]());for(;;){const o=[];for(let e of t){let t=e.next();if(t.done)return;o.push(t.value)}yield o}}function ua(r,$){return $?ra(ua(r),$):$=>{const e=$[2];return ta($,($,t)=>r(t)?e($,t):$)}}const pf=(r,o=r=>void 0!==r?": "+r:"")=>class extends Error{constructor(e){super(r(e)+o(e))}};const qf=pf(()=>"illegal argument(s)");const rf=r=>{throw new qf(r)};const sf=e=>((null==e||!e[Symbol.iterator])&&rf(`value is not iterable: ${e}`),e);const tf=r=>x(r)?r:[...sf(r)];const Ob=1/4294967295;class uf{float(t=1){return this.int()*Ob*t}norm(t=1){return 2*(this.int()*Ob-.5)*t}minmax(t,$){return this.float()*($-t)+t}gaussian(t=10,$=-.5,r=1){let a=0,n=t;for(;n-->0;)a+=this.float(r);return a/t+$}}const va=Math.random;class vf extends uf{int(){return 4294967295*va()>>>0}float($=1){return va()*$}norm($=1){return 2*(va()-.5)*$}}const Pb=new vf;var wf=(ha(),{});const Nh=Symbol();const xf=()=>{};const Qb=void 0===wf?(r,$="assertion failed")=>{if("function"==typeof r&&!r()||!r)throw new Error("function"==typeof $?$():$)}:xf;const yf=(e,t,r=Pb)=>{const $=e.length;Qb($>0,"no choices given");const o=e.map(t?(e,r)=>[e,t[r]]:e=>[e,1]).sort((e,t)=>t[1]-e[1]),m=o.reduce((e,t)=>e+t[1],0);return Qb(m>0,"no choices given"),()=>{const e=r.float(m);let t=m;for(let r=0;r<$;r++)if((t-=o[r][1])<=e)return o[r][0]}};function T(...e){return e=e.map(B),Mb.apply(null,e)}function U(e,r){return r?Ze(U(e),r):r=>{const $=r[2];let g=e;return ta(r,(e,r)=>--g>0?$(e,r):0===g?_e($(e,r)):$e(e))}}function zf(...$){return a(mf.apply(null,$.map(hf)))}function wa(...$){const e=Lb(wa,$);if(e)return e;const[r,p]=$,t=Object.keys(r);return T(zf.apply(null,t.map($=>r[$])),Rb(t,p))}function Rb(...r){const $=r.length>2&&Lb(Rb,r);if($)return $;let e=r[0];if(x(e)&&(e=e.reduce((r,$,e)=>(r[$]=e,r),{})),r[1]){const $=Object.keys(e);return a(t=>g(T(a(r=>[r,t[e[r]]]),ua(r=>void 0!==r[1])),r[1],$))}return a(Af(e))}const Af=e=>{const r=Object.keys(e),[t,n,o]=r,[s,c,$]=r.map(r=>e[r]);switch(r.length){case 3:return e=>{const r={};let a;return void 0!==(a=e[$])&&(r[o]=a),void 0!==(a=e[c])&&(r[n]=a),void 0!==(a=e[s])&&(r[t]=a),r};case 2:return e=>{const r={};let o;return void 0!==(o=e[c])&&(r[n]=o),void 0!==(o=e[s])&&(r[t]=o),r};case 1:return e=>{const r={};let n=e[s];return void 0!==n&&(r[t]=n),r};default:return t=>{let n,o;const s={};for(let c=r.length-1;c>=0;c--)n=r[c],void 0!==(o=t[e[n]])&&(s[n]=o);return s};}};function*Bf(e,$=1/0){for(;$-->0;)yield e()}const Sb=($,e,r=Pb)=>Bf(e?yf(tf($),e,r):()=>$[0|r.float($.length)]);function*Cf(e,o=1/0){for(;o-->0;)yield e}const Df=t=>{const e=Object.assign({element:"h1",attribs:{},subElement:"small",subAttribs:{}},t);return(t,s,r)=>[e.element,e.attribs,s,r?[e.subElement,e.subAttribs,r]:void 0]};const Ef={anim:100,pad:1,margin:0,vertical:!1,bgOn:{fill:"#000"},bgOff:{fill:"#999"},fgOn:{fill:"#fff"},fgOff:{fill:"#fff"}};const Ff=(s={})=>{const t=Object.assign(Object.assign({w:10,h:10},Ef),s),{w:e,h:i,pad:g,margin:a,vertical:n}=t,c=2*a,b=g+a,O=n?e+2*g:2*(e+g),f=n?2*(i+g):i+2*g,r={width:O+c,height:f+c},l={transition:`all ${t.anim}ms ease-out`},$=Object.assign(Object.assign({},t.bgOn),{width:O,height:f,x:a,y:a}),j=Object.assign(Object.assign({},$),t.bgOff),o=Object.assign(Object.assign(Object.assign({},n?{x:b,y:b}:{x:O+a-g-e,y:b}),t.fgOn),{style:l,width:e,height:i}),h=Object.assign(Object.assign(Object.assign({},o),n?{y:f+a-g-i}:{x:b}),t.fgOff);return(s,t,e)=>["svg",Object.assign(Object.assign({},r),t),["rect",e?$:j],["rect",e?o:h]]};var xa,D={};!function(e){function t(){if(t.prototype._singleton)throw new Error("WebMidi is a singleton, it cannot be instantiated directly.");(t.prototype._singleton=this)._inputs=[],this._outputs=[],this._userHandlers={},this._stateChangeQueue=[],this._processingStateChange=!1,this._midiInterfaceEvents=["connected","disconnected"],this._nrpnBuffer=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],this._nrpnEventsEnabled=!0,this._nrpnTypes=["entry","increment","decrement"],this._notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this._semitones={C:0,D:2,E:4,F:5,G:7,A:9,B:11},Object.defineProperties(this,{MIDI_SYSTEM_MESSAGES:{value:{sysex:240,timecode:241,songposition:242,songselect:243,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MESSAGES:{value:{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,channelmode:11,nrpn:11,programchange:12,channelaftertouch:13,pitchbend:14},writable:!1,enumerable:!0,configurable:!1},MIDI_REGISTERED_PARAMETER:{value:{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]},writable:!1,enumerable:!0,configurable:!1},MIDI_CONTROL_CHANGE_MESSAGES:{value:{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101},writable:!1,enumerable:!0,configurable:!1},MIDI_NRPN_MESSAGES:{value:{entrymsb:6,entrylsb:38,increment:96,decrement:97,paramlsb:98,parammsb:99,nullactiveparameter:127},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MODE_MESSAGES:{value:{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127},writable:!1,enumerable:!0,configurable:!1},octaveOffset:{value:0,writable:!0,enumerable:!0,configurable:!1}}),Object.defineProperties(this,{supported:{enumerable:!0,get:function(){return"requestMIDIAccess"in navigator}},enabled:{enumerable:!0,get:function(){return void 0!==this.interface}.bind(this)},inputs:{enumerable:!0,get:function(){return this._inputs}.bind(this)},outputs:{enumerable:!0,get:function(){return this._outputs}.bind(this)},sysexEnabled:{enumerable:!0,get:function(){return!(!this.interface||!this.interface.sysexEnabled)}.bind(this)},nrpnEventsEnabled:{enumerable:!0,get:function(){return!!this._nrpnEventsEnabled}.bind(this),set:function(e){return this._nrpnEventsEnabled=e,this._nrpnEventsEnabled}},nrpnTypes:{enumerable:!0,get:function(){return this._nrpnTypes}.bind(this)},time:{enumerable:!0,get:function(){return performance.now()}}})}var n=new t;function r(e){var t=this;this._userHandlers={channel:{},system:{}},this._midiInput=e,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return t._midiInput.connection}},id:{enumerable:!0,get:function(){return t._midiInput.id}},manufacturer:{enumerable:!0,get:function(){return t._midiInput.manufacturer}},name:{enumerable:!0,get:function(){return t._midiInput.name}},state:{enumerable:!0,get:function(){return t._midiInput.state}},type:{enumerable:!0,get:function(){return t._midiInput.type}}}),this._initializeUserHandlers(),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}function i(e){var t=this;this._midiOutput=e,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return t._midiOutput.connection}},id:{enumerable:!0,get:function(){return t._midiOutput.id}},manufacturer:{enumerable:!0,get:function(){return t._midiOutput.manufacturer}},name:{enumerable:!0,get:function(){return t._midiOutput.name}},state:{enumerable:!0,get:function(){return t._midiOutput.state}},type:{enumerable:!0,get:function(){return t._midiOutput.type}}})}t.prototype.enable=function(e,t){this.enabled||(this.supported?navigator.requestMIDIAccess({sysex:t}).then(function(t){var n,r=[],i=[];this.interface=t,this._resetInterfaceUserHandlers(),this.interface.onstatechange=function(e){r.push(e)};for(var o=t.inputs.values(),a=o.next();a&&!a.done;a=o.next())i.push(a.value.open());for(var s=t.outputs.values(),u=s.next();u&&!u.done;u=s.next())i.push(u.value.open());function h(){clearTimeout(n),this._updateInputsAndOutputs(),this.interface.onstatechange=this._onInterfaceStateChange.bind(this),"function"==typeof e&&e.call(this),r.forEach(function(e){this._onInterfaceStateChange(e)}.bind(this))}n=setTimeout(h.bind(this),200),Promise&&Promise.all(i).catch(function(e){}).then(h.bind(this))}.bind(this),function(t){"function"==typeof e&&e.call(this,t)}.bind(this)):"function"==typeof e&&e(new Error("The Web MIDI API is not supported by your browser.")))},t.prototype.disable=function(){if(!this.supported)throw new Error("The Web MIDI API is not supported by your browser.");this.interface&&(this.interface.onstatechange=void 0),this.interface=void 0,this._inputs=[],this._outputs=[],this._nrpnEventsEnabled=!0,this._resetInterfaceUserHandlers()},t.prototype.addListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before adding event listeners.");if("function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(e)))throw new TypeError("The specified event type is not supported.");return this._userHandlers[e].push(t),this},t.prototype.hasListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before checking event listeners.");if("function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(e)))throw new TypeError("The specified event type is not supported.");for(var n=0;n<this._userHandlers[e].length;n++)if(this._userHandlers[e][n]===t)return!0;return!1},t.prototype.removeListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before removing event listeners.");if(void 0!==t&&"function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(0<=this._midiInterfaceEvents.indexOf(e)){if(t)for(var n=0;n<this._userHandlers[e].length;n++)this._userHandlers[e][n]===t&&this._userHandlers[e].splice(n,1);else this._userHandlers[e]=[];}else{if(void 0!==e)throw new TypeError("The specified event type is not supported.");this._resetInterfaceUserHandlers()}return this},t.prototype.toMIDIChannels=function(e){var t;if("all"===e||void 0===e)t=["all"];else{if("none"===e)return[];t=Array.isArray(e)?e:[e]}return-1<t.indexOf("all")&&(t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),t.map(function(e){return parseInt(e)}).filter(function(e){return 1<=e&&e<=16})},t.prototype.getInputById=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");e=String(e);for(var t=0;t<this.inputs.length;t++)if(this.inputs[t].id===e)return this.inputs[t];return!1},t.prototype.getOutputById=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");e=String(e);for(var t=0;t<this.outputs.length;t++)if(this.outputs[t].id===e)return this.outputs[t];return!1},t.prototype.getInputByName=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var t=0;t<this.inputs.length;t++)if(~this.inputs[t].name.indexOf(e))return this.inputs[t];return!1},t.prototype.getOctave=function(e){if(null!=e&&0<=e&&e<=127)return Math.floor(Math.floor(e)/12-1)+Math.floor(n.octaveOffset)},t.prototype.getOutputByName=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var t=0;t<this.outputs.length;t++)if(~this.outputs[t].name.indexOf(e))return this.outputs[t];return!1},t.prototype.guessNoteNumber=function(e){var t=!1;if(e&&e.toFixed&&0<=e&&e<=127?t=Math.round(e):0<=parseInt(e)&&parseInt(e)<=127?t=parseInt(e):("string"==typeof e||e instanceof String)&&(t=this.noteNameToNumber(e)),!1===t)throw new Error("Invalid input value ("+e+").");return t},t.prototype.noteNameToNumber=function(e){"string"!=typeof e&&(e="");var t=e.match(/([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)/i);if(!t)throw new RangeError("Invalid note name.");var r=n._semitones[t[1].toUpperCase()],i=12*(parseInt(t[3])+1-Math.floor(n.octaveOffset))+r;if(-1<t[2].toLowerCase().indexOf("b")?i-=t[2].length:-1<t[2].toLowerCase().indexOf("#")&&(i+=t[2].length),i<0||127<i)throw new RangeError("Invalid note name or note outside valid range.");return i},t.prototype._updateInputsAndOutputs=function(){this._updateInputs(),this._updateOutputs()},t.prototype._updateInputs=function(){for(var e=0;e<this._inputs.length;e++){for(var t=!0,n=this.interface.inputs.values(),i=n.next();i&&!i.done;i=n.next())if(this._inputs[e]._midiInput===i.value){t=!1;break}t&&this._inputs.splice(e,1)}this.interface&&this.interface.inputs.forEach(function(e){for(var t=!0,n=0;n<this._inputs.length;n++)this._inputs[n]._midiInput===e&&(t=!1);t&&this._inputs.push(new r(e))}.bind(this))},t.prototype._updateOutputs=function(){for(var e=0;e<this._outputs.length;e++){for(var t=!0,n=this.interface.outputs.values(),r=n.next();r&&!r.done;r=n.next())if(this._outputs[e]._midiOutput===r.value){t=!1;break}t&&this._outputs.splice(e,1)}this.interface&&this.interface.outputs.forEach(function(e){for(var t=!0,n=0;n<this._outputs.length;n++)this._outputs[n]._midiOutput===e&&(t=!1);t&&this._outputs.push(new i(e))}.bind(this))},t.prototype._onInterfaceStateChange=function(e){this._updateInputsAndOutputs();var t={timestamp:e.timeStamp,type:e.port.state};this.interface&&"connected"===e.port.state?"output"===e.port.type?t.port=this.getOutputById(e.port.id):"input"===e.port.type&&(t.port=this.getInputById(e.port.id)):t.port={connection:"closed",id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this._userHandlers[e.port.state].forEach(function(e){e(t)})},t.prototype._resetInterfaceUserHandlers=function(){for(var e=0;e<this._midiInterfaceEvents.length;e++)this._userHandlers[this._midiInterfaceEvents[e]]=[]},r.prototype.on=r.prototype.addListener=function(e,t,r){var i=this;if(void 0===t&&(t="all"),Array.isArray(t)||(t=[t]),t.forEach(function(e){if("all"!==e&&!(1<=e&&e<=16))throw new RangeError("The 'channel' parameter is invalid.")}),"function"!=typeof r)throw new TypeError("The 'listener' parameter must be a function.");if(void 0!==n.MIDI_SYSTEM_MESSAGES[e])this._userHandlers.system[e]||(this._userHandlers.system[e]=[]),this._userHandlers.system[e].push(r);else{if(void 0===n.MIDI_CHANNEL_MESSAGES[e])throw new TypeError("The specified event type is not supported.");if(-1<t.indexOf("all")){t=[];for(var o=1;o<=16;o++)t.push(o)}this._userHandlers.channel[e]||(this._userHandlers.channel[e]=[]),t.forEach(function(t){i._userHandlers.channel[e][t]||(i._userHandlers.channel[e][t]=[]),i._userHandlers.channel[e][t].push(r)})}return this},r.prototype.hasListener=function(e,t,r){var i=this;if("function"!=typeof r)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===t&&(t="all"),t.constructor!==Array&&(t=[t]),void 0!==n.MIDI_SYSTEM_MESSAGES[e]){for(var o=0;o<this._userHandlers.system[e].length;o++)if(this._userHandlers.system[e][o]===r)return!0}else if(void 0!==n.MIDI_CHANNEL_MESSAGES[e]){if(-1<t.indexOf("all")){t=[];for(var a=1;a<=16;a++)t.push(a)}return!!this._userHandlers.channel[e]&&t.every(function(t){var n=i._userHandlers.channel[e][t];return n&&-1<n.indexOf(r)})}return!1},r.prototype.removeListener=function(e,t,r){var i=this;if(void 0!==r&&"function"!=typeof r)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===t&&(t="all"),t.constructor!==Array&&(t=[t]),void 0!==n.MIDI_SYSTEM_MESSAGES[e]){if(void 0===r)this._userHandlers.system[e]=[];else for(var o=0;o<this._userHandlers.system[e].length;o++)this._userHandlers.system[e][o]===r&&this._userHandlers.system[e].splice(o,1);}else if(void 0!==n.MIDI_CHANNEL_MESSAGES[e]){if(-1<t.indexOf("all")){t=[];for(var a=1;a<=16;a++)t.push(a)}if(!this._userHandlers.channel[e])return this;t.forEach(function(t){var n=i._userHandlers.channel[e][t];if(n)if(void 0===r)i._userHandlers.channel[e][t]=[];else for(var o=0;o<n.length;o++)n[o]===r&&n.splice(o,1)})}else{if(void 0!==e)throw new TypeError("The specified event type is not supported.");this._initializeUserHandlers()}return this},r.prototype._initializeUserHandlers=function(){for(var e in n.MIDI_CHANNEL_MESSAGES)n.MIDI_CHANNEL_MESSAGES.hasOwnProperty(e)&&(this._userHandlers.channel[e]={});for(var t in n.MIDI_SYSTEM_MESSAGES)n.MIDI_SYSTEM_MESSAGES.hasOwnProperty(t)&&(this._userHandlers.system[t]=[])},r.prototype._onMidiMessage=function(e){if(0<this._userHandlers.system.midimessage.length){var t={target:this,data:e.data,timestamp:e.timeStamp,type:"midimessage"};this._userHandlers.system.midimessage.forEach(function(e){e(t)})}e.data[0]<240?(this._parseChannelEvent(e),this._parseNrpnEvent(e)):e.data[0]<=255&&this._parseSystemEvent(e)},r.prototype._parseNrpnEvent=function(e){var t,r,i=e.data[0]>>4,o=15&e.data[0],a=1+o;if(1<e.data.length&&(t=e.data[1],r=2<e.data.length?e.data[2]:void 0),n.nrpnEventsEnabled&&i===n.MIDI_CHANNEL_MESSAGES.controlchange&&(t>=n.MIDI_NRPN_MESSAGES.increment&&t<=n.MIDI_NRPN_MESSAGES.parammsb||t===n.MIDI_NRPN_MESSAGES.entrymsb||t===n.MIDI_NRPN_MESSAGES.entrylsb)){var s={target:this,type:"controlchange",data:e.data,timestamp:e.timeStamp,channel:a,controller:{number:t,name:this.getCcNameByNumber(t)},value:r};if(s.controller.number===n.MIDI_NRPN_MESSAGES.parammsb&&s.value!=n.MIDI_NRPN_MESSAGES.nullactiveparameter)n._nrpnBuffer[o]=[],n._nrpnBuffer[o][0]=s;else if(1===n._nrpnBuffer[o].length&&s.controller.number===n.MIDI_NRPN_MESSAGES.paramlsb)n._nrpnBuffer[o].push(s);else if(2!==n._nrpnBuffer[o].length||s.controller.number!==n.MIDI_NRPN_MESSAGES.increment&&s.controller.number!==n.MIDI_NRPN_MESSAGES.decrement&&s.controller.number!==n.MIDI_NRPN_MESSAGES.entrymsb){if(3===n._nrpnBuffer[o].length&&n._nrpnBuffer[o][2].number===n.MIDI_NRPN_MESSAGES.entrymsb&&s.controller.number===n.MIDI_NRPN_MESSAGES.entrylsb)n._nrpnBuffer[o].push(s);else if(3<=n._nrpnBuffer[o].length&&n._nrpnBuffer[o].length<=4&&s.controller.number===n.MIDI_NRPN_MESSAGES.parammsb&&s.value===n.MIDI_NRPN_MESSAGES.nullactiveparameter)n._nrpnBuffer[o].push(s);else if(4<=n._nrpnBuffer[o].length&&n._nrpnBuffer[o].length<=5&&s.controller.number===n.MIDI_NRPN_MESSAGES.paramlsb&&s.value===n.MIDI_NRPN_MESSAGES.nullactiveparameter){n._nrpnBuffer[o].push(s);var u=[];n._nrpnBuffer[o].forEach(function(e){u.push(e.data)});var h=n._nrpnBuffer[o][0].value<<7|n._nrpnBuffer[o][1].value,l=n._nrpnBuffer[o][2].value;6===n._nrpnBuffer[o].length&&(l=n._nrpnBuffer[o][2].value<<7|n._nrpnBuffer[o][3].value);var p="";switch(n._nrpnBuffer[o][2].controller.number){case n.MIDI_NRPN_MESSAGES.entrymsb:p=n._nrpnTypes[0];break;case n.MIDI_NRPN_MESSAGES.increment:p=n._nrpnTypes[1];break;case n.MIDI_NRPN_MESSAGES.decrement:p=n._nrpnTypes[2];break;default:throw new Error("The NPRN type was unidentifiable.");}var c={timestamp:s.timestamp,channel:s.channel,type:"nrpn",data:u,controller:{number:h,type:p,name:"Non-Registered Parameter "+h},value:l};n._nrpnBuffer[o]=[],this._userHandlers.channel[c.type]&&this._userHandlers.channel[c.type][c.channel]&&this._userHandlers.channel[c.type][c.channel].forEach(function(e){e(c)})}else n._nrpnBuffer[o]=[];}else n._nrpnBuffer[o].push(s)}},r.prototype._parseChannelEvent=function(e){var t,r,i=e.data[0]>>4,o=1+(15&e.data[0]);1<e.data.length&&(t=e.data[1],r=2<e.data.length?e.data[2]:void 0);var a={target:this,data:e.data,timestamp:e.timeStamp,channel:o};i===n.MIDI_CHANNEL_MESSAGES.noteoff||i===n.MIDI_CHANNEL_MESSAGES.noteon&&0===r?(a.type="noteoff",a.note={number:t,name:n._notes[t%12],octave:n.getOctave(t)},a.velocity=r/127,a.rawVelocity=r):i===n.MIDI_CHANNEL_MESSAGES.noteon?(a.type="noteon",a.note={number:t,name:n._notes[t%12],octave:n.getOctave(t)},a.velocity=r/127,a.rawVelocity=r):i===n.MIDI_CHANNEL_MESSAGES.keyaftertouch?(a.type="keyaftertouch",a.note={number:t,name:n._notes[t%12],octave:n.getOctave(t)},a.value=r/127):i===n.MIDI_CHANNEL_MESSAGES.controlchange&&0<=t&&t<=119?(a.type="controlchange",a.controller={number:t,name:this.getCcNameByNumber(t)},a.value=r):i===n.MIDI_CHANNEL_MESSAGES.channelmode&&120<=t&&t<=127?(a.type="channelmode",a.controller={number:t,name:this.getChannelModeByNumber(t)},a.value=r):i===n.MIDI_CHANNEL_MESSAGES.programchange?(a.type="programchange",a.value=t):i===n.MIDI_CHANNEL_MESSAGES.channelaftertouch?(a.type="channelaftertouch",a.value=t/127):i===n.MIDI_CHANNEL_MESSAGES.pitchbend?(a.type="pitchbend",a.value=((r<<7)+t-8192)/8192):a.type="unknownchannelmessage",this._userHandlers.channel[a.type]&&this._userHandlers.channel[a.type][o]&&this._userHandlers.channel[a.type][o].forEach(function(e){e(a)})},r.prototype.getCcNameByNumber=function(e){if(!(0<=(e=Math.floor(e))&&e<=119))throw new RangeError("The control change number must be between 0 and 119.");for(var t in n.MIDI_CONTROL_CHANGE_MESSAGES)if(n.MIDI_CONTROL_CHANGE_MESSAGES.hasOwnProperty(t)&&e===n.MIDI_CONTROL_CHANGE_MESSAGES[t])return t},r.prototype.getChannelModeByNumber=function(e){if(!(120<=(e=Math.floor(e))&&status<=127))throw new RangeError("The control change number must be between 120 and 127.");for(var t in n.MIDI_CHANNEL_MODE_MESSAGES)if(n.MIDI_CHANNEL_MODE_MESSAGES.hasOwnProperty(t)&&e===n.MIDI_CHANNEL_MODE_MESSAGES[t])return t},r.prototype._parseSystemEvent=function(e){var t=e.data[0],r={target:this,data:e.data,timestamp:e.timeStamp};t===n.MIDI_SYSTEM_MESSAGES.sysex?r.type="sysex":t===n.MIDI_SYSTEM_MESSAGES.timecode?r.type="timecode":t===n.MIDI_SYSTEM_MESSAGES.songposition?r.type="songposition":t===n.MIDI_SYSTEM_MESSAGES.songselect?(r.type="songselect",r.song=e.data[1]):t===n.MIDI_SYSTEM_MESSAGES.tuningrequest?r.type="tuningrequest":t===n.MIDI_SYSTEM_MESSAGES.clock?r.type="clock":t===n.MIDI_SYSTEM_MESSAGES.start?r.type="start":t===n.MIDI_SYSTEM_MESSAGES.continue?r.type="continue":t===n.MIDI_SYSTEM_MESSAGES.stop?r.type="stop":t===n.MIDI_SYSTEM_MESSAGES.activesensing?r.type="activesensing":t===n.MIDI_SYSTEM_MESSAGES.reset?r.type="reset":r.type="unknownsystemmessage",this._userHandlers.system[r.type]&&this._userHandlers.system[r.type].forEach(function(e){e(r)})},i.prototype.send=function(e,t,n){if(!(128<=e&&e<=255))throw new RangeError("The status byte must be an integer between 128 (0x80) and 255 (0xFF).");void 0===t&&(t=[]),Array.isArray(t)||(t=[t]);var r=[];return t.forEach(function(e){var t=Math.floor(e);if(!(0<=t&&t<=255))throw new RangeError("Data bytes must be integers between 0 (0x00) and 255 (0xFF).");r.push(t)}),this._midiOutput.send([e].concat(r),parseFloat(n)||0),this},i.prototype.sendSysex=function(e,t,r){if(!n.sysexEnabled)throw new Error("Sysex message support must first be activated.");return r=r||{},e=[].concat(e),t.forEach(function(e){if(e<0||127<e)throw new RangeError("The data bytes of a sysex message must be integers between 0 (0x00) and 127 (0x7F).")}),t=e.concat(t,n.MIDI_SYSTEM_MESSAGES.sysexend),this.send(n.MIDI_SYSTEM_MESSAGES.sysex,t,this._parseTimeParameter(r.time)),this},i.prototype.sendTimecodeQuarterFrame=function(e,t){return t=t||{},this.send(n.MIDI_SYSTEM_MESSAGES.timecode,e,this._parseTimeParameter(t.time)),this},i.prototype.sendSongPosition=function(e,t){t=t||{};var r=(e=Math.floor(e)||0)>>7&127,i=127&e;return this.send(n.MIDI_SYSTEM_MESSAGES.songposition,[r,i],this._parseTimeParameter(t.time)),this},i.prototype.sendSongSelect=function(e,t){if(t=t||{},!(0<=(e=Math.floor(e))&&e<=127))throw new RangeError("The song number must be between 0 and 127.");return this.send(n.MIDI_SYSTEM_MESSAGES.songselect,[e],this._parseTimeParameter(t.time)),this},i.prototype.sendTuningRequest=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.tuningrequest,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendClock=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.clock,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendStart=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.start,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendContinue=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.continue,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendStop=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.stop,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendActiveSensing=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.activesensing,[],this._parseTimeParameter(e.time)),this},i.prototype.sendReset=function(e){return e=e||{},this.send(n.MIDI_SYSTEM_MESSAGES.reset,void 0,this._parseTimeParameter(e.time)),this},i.prototype.stopNote=function(e,t,r){if("all"===e)return this.sendChannelMode("allnotesoff",0,t,r);var i=64;return(r=r||{}).rawVelocity?!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=127&&(i=r.velocity):!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=1&&(i=127*r.velocity),this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){this.send((n.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(t-1),[e,Math.round(i)],this._parseTimeParameter(r.time))}.bind(this))}.bind(this)),this},i.prototype.playNote=function(e,t,r){var i,o=64;if((r=r||{}).rawVelocity?!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=127&&(o=r.velocity):!isNaN(r.velocity)&&0<=r.velocity&&r.velocity<=1&&(o=127*r.velocity),i=this._parseTimeParameter(r.time),this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){this.send((n.MIDI_CHANNEL_MESSAGES.noteon<<4)+(t-1),[e,Math.round(o)],i)}.bind(this))}.bind(this)),!isNaN(r.duration)){r.duration<=0&&(r.duration=0);var a=64;r.rawVelocity?!isNaN(r.release)&&0<=r.release&&r.release<=127&&(a=r.release):!isNaN(r.release)&&0<=r.release&&r.release<=1&&(a=127*r.release),this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){this.send((n.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(t-1),[e,Math.round(a)],(i||n.time)+r.duration)}.bind(this))}.bind(this))}return this},i.prototype.sendKeyAftertouch=function(e,t,r,i){var o=this;if(i=i||{},t<1||16<t)throw new RangeError("The channel must be between 1 and 16.");(isNaN(r)||r<0||1<r)&&(r=.5);var a=Math.round(127*r);return this._convertNoteToArray(e).forEach(function(e){n.toMIDIChannels(t).forEach(function(t){o.send((n.MIDI_CHANNEL_MESSAGES.keyaftertouch<<4)+(t-1),[e,a],o._parseTimeParameter(i.time))})}),this},i.prototype.sendControlChange=function(e,t,r,i){if(i=i||{},"string"==typeof e){if(void 0===(e=n.MIDI_CONTROL_CHANGE_MESSAGES[e]))throw new TypeError("Invalid controller name.")}else if(!(0<=(e=Math.floor(e))&&e<=119))throw new RangeError("Controller numbers must be between 0 and 119.");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("Controller value must be between 0 and 127.");return n.toMIDIChannels(r).forEach(function(r){this.send((n.MIDI_CHANNEL_MESSAGES.controlchange<<4)+(r-1),[e,t],this._parseTimeParameter(i.time))}.bind(this)),this},i.prototype._selectRegisteredParameter=function(e,t,r){var i=this;if(e[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The control65 value must be between 0 and 127");if(e[1]=Math.floor(e[1]),!(0<=e[1]&&e[1]<=127))throw new RangeError("The control64 value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.sendControlChange(101,e[0],t,{time:r}),i.sendControlChange(100,e[1],t,{time:r})}),this},i.prototype._selectNonRegisteredParameter=function(e,t,r){var i=this;if(e[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The control63 value must be between 0 and 127");if(e[1]=Math.floor(e[1]),!(0<=e[1]&&e[1]<=127))throw new RangeError("The control62 value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.sendControlChange(99,e[0],t,{time:r}),i.sendControlChange(98,e[1],t,{time:r})}),this},i.prototype._setCurrentRegisteredParameter=function(e,t,r){var i=this;if((e=[].concat(e))[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The msb value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.sendControlChange(6,e[0],t,{time:r})}),e[1]=Math.floor(e[1]),0<=e[1]&&e[1]<=127&&n.toMIDIChannels(t).forEach(function(){i.sendControlChange(38,e[1],t,{time:r})}),this},i.prototype._deselectRegisteredParameter=function(e,t){var r=this;return n.toMIDIChannels(e).forEach(function(){r.sendControlChange(101,127,e,{time:t}),r.sendControlChange(100,127,e,{time:t})}),this},i.prototype.setRegisteredParameter=function(e,t,r,i){var o=this;if(i=i||{},!Array.isArray(e)){if(!n.MIDI_REGISTERED_PARAMETER[e])throw new Error("The specified parameter is not available.");e=n.MIDI_REGISTERED_PARAMETER[e]}return n.toMIDIChannels(r).forEach(function(){o._selectRegisteredParameter(e,r,i.time),o._setCurrentRegisteredParameter(t,r,i.time),o._deselectRegisteredParameter(r,i.time)}),this},i.prototype.setNonRegisteredParameter=function(e,t,r,i){var o=this;if(i=i||{},!(0<=e[0]&&e[0]<=127&&0<=e[1]&&e[1]<=127))throw new Error("Position 0 and 1 of the 2-position parameter array must both be between 0 and 127.");return t=[].concat(t),n.toMIDIChannels(r).forEach(function(){o._selectNonRegisteredParameter(e,r,i.time),o._setCurrentRegisteredParameter(t,r,i.time),o._deselectRegisteredParameter(r,i.time)}),this},i.prototype.incrementRegisteredParameter=function(e,t,r){var i=this;if(r=r||{},!Array.isArray(e)){if(!n.MIDI_REGISTERED_PARAMETER[e])throw new Error("The specified parameter is not available.");e=n.MIDI_REGISTERED_PARAMETER[e]}return n.toMIDIChannels(t).forEach(function(){i._selectRegisteredParameter(e,t,r.time),i.sendControlChange(96,0,t,{time:r.time}),i._deselectRegisteredParameter(t,r.time)}),this},i.prototype.decrementRegisteredParameter=function(e,t,r){if(r=r||{},!Array.isArray(e)){if(!n.MIDI_REGISTERED_PARAMETER[e])throw new TypeError("The specified parameter is not available.");e=n.MIDI_REGISTERED_PARAMETER[e]}return n.toMIDIChannels(t).forEach(function(){this._selectRegisteredParameter(e,t,r.time),this.sendControlChange(97,0,t,{time:r.time}),this._deselectRegisteredParameter(t,r.time)}.bind(this)),this},i.prototype.setPitchBendRange=function(e,t,r,i){var o=this;if(i=i||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The cents value must be between 0 and 127");return n.toMIDIChannels(r).forEach(function(){o.setRegisteredParameter("pitchbendrange",[e,t],r,{time:i.time})}),this},i.prototype.setModulationRange=function(e,t,r,i){var o=this;if(i=i||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The cents value must be between 0 and 127");return n.toMIDIChannels(r).forEach(function(){o.setRegisteredParameter("modulationrange",[e,t],r,{time:i.time})}),this},i.prototype.setMasterTuning=function(e,t,r){var i=this;if(r=r||{},(e=parseFloat(e)||0)<=-65||64<=e)throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");var o=Math.floor(e)+64,a=e-Math.floor(e),s=(a=Math.round((a+1)/2*16383))>>7&127,u=127&a;return n.toMIDIChannels(t).forEach(function(){i.setRegisteredParameter("channelcoarsetuning",o,t,{time:r.time}),i.setRegisteredParameter("channelfinetuning",[s,u],t,{time:r.time})}),this},i.prototype.setTuningProgram=function(e,t,r){var i=this;if(r=r||{},!(0<=(e=Math.floor(e))&&e<=127))throw new RangeError("The program value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.setRegisteredParameter("tuningprogram",e,t,{time:r.time})}),this},i.prototype.setTuningBank=function(e,t,r){var i=this;if(r=r||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The bank value must be between 0 and 127");return n.toMIDIChannels(t).forEach(function(){i.setRegisteredParameter("tuningbank",e,t,{time:r.time})}),this},i.prototype.sendChannelMode=function(e,t,r,i){if(i=i||{},"string"==typeof e){if(!(e=n.MIDI_CHANNEL_MODE_MESSAGES[e]))throw new TypeError("Invalid channel mode message name.")}else if(!(120<=(e=Math.floor(e))&&e<=127))throw new RangeError("Channel mode numerical identifiers must be between 120 and 127.");if((t=Math.floor(t)||0)<0||127<t)throw new RangeError("Value must be an integer between 0 and 127.");return n.toMIDIChannels(r).forEach(function(r){this.send((n.MIDI_CHANNEL_MESSAGES.channelmode<<4)+(r-1),[e,t],this._parseTimeParameter(i.time))}.bind(this)),this},i.prototype.sendProgramChange=function(e,t,r){var i=this;if(r=r||{},e=Math.floor(e),isNaN(e)||e<0||127<e)throw new RangeError("Program numbers must be between 0 and 127.");return n.toMIDIChannels(t).forEach(function(t){i.send((n.MIDI_CHANNEL_MESSAGES.programchange<<4)+(t-1),[e],i._parseTimeParameter(r.time))}),this},i.prototype.sendChannelAftertouch=function(e,t,r){var i=this;r=r||{},e=parseFloat(e),(isNaN(e)||e<0||1<e)&&(e=.5);var o=Math.round(127*e);return n.toMIDIChannels(t).forEach(function(e){i.send((n.MIDI_CHANNEL_MESSAGES.channelaftertouch<<4)+(e-1),[o],i._parseTimeParameter(r.time))}),this},i.prototype.sendPitchBend=function(e,t,r){var i=this;if(r=r||{},isNaN(e)||e<-1||1<e)throw new RangeError("Pitch bend value must be between -1 and 1.");var o=Math.round((e+1)/2*16383),a=o>>7&127,s=127&o;return n.toMIDIChannels(t).forEach(function(e){i.send((n.MIDI_CHANNEL_MESSAGES.pitchbend<<4)+(e-1),[s,a],i._parseTimeParameter(r.time))}),this},i.prototype._parseTimeParameter=function(e){var t,r=parseFloat(e);return"string"==typeof e&&"+"===e.substring(0,1)?r&&0<r&&(t=n.time+r):r>n.time&&(t=r),t},i.prototype._convertNoteToArray=function(e){var t=[];return Array.isArray(e)||(e=[e]),e.forEach(function(e){t.push(n.guessNoteNumber(e))}),t},"function"==typeof xa&&"object"==typeof xa.amd?xa([],function(){return n}):D?D=n:e.WebMidi||(e.WebMidi=n)}(D);const Gf="route-to";const Hf="toggle-debug";const V="toggle-key-state";const E="set-key-state";const Tb="reset-key-state";const Ub="set-random-key-state";const ya="set-highlights";const Vb="reset-highlights";const Wb="set-size";const Xb="toggle-view-config";const Yb="set-midi-devices";const o="set-midi-file";const Zb="set-midi-file-error";const If="set-comparison";const $b=e=>{var $iFCn$$interop$default=I(D);$iFCn$$interop$default.d.inputs.forEach(i=>i.addListener("noteon","all",$=>{e.dispatch([V,$.note.number%12]),console.log(`Received 'noteon' message (${$.note.name+$.note.octave}) from ${i.name}`)}))},Jf=e=>{var $iFCn$$interop$default=I(D);$iFCn$$interop$default.d.enable(i=>{i?console.log("WebMidi could not be enabled.",i):(console.log("WebMidi enabled!"),e.dispatch([Yb,$iFCn$$interop$default.d.inputs.map(e=>e.name)]),$b(e))})};const Kf=(e,i)=>{var $iFCn$$interop$default=I(D);$iFCn$$interop$default.d.inputs.forEach(e=>e.removeListener()),"All Devices"!==i?$iFCn$$interop$default.d.getInputByName(i).addListener("noteon","all",$=>{e.dispatch([V,$.note.number%12]),console.log(`Received 'noteon' message (${$.note.name+$.note.octave}) from ${i}`)}):$b(e)},Lf=e=>{const i=e.views,$=e.bus;return()=>{const e=i.enabledMidi.deref();let n=i.midiDevices.deref();return["div",e?["span.mid-gray.bg-washed-green.pa1","Web MIDI is available"]:["span.mid-gray.bg-washed-red.pa1","Web MIDI is unavailable"],["span.ml2",n.length>=1?[Ye,{onchange:e=>Kf($,e.target.value)},g(a(e=>[e,e]),f(),["All Devices",...n])]:[]]]}};const _b="route-to";class Mf{constructor(t){this.config=t,this.state=new _a(t.initialState||{}),this.ctx={bus:new Oe(this.state,t.events,t.effects),views:{},ui:t.ui},this.addViews(this.config.views),this.router=new We(t.router),this.router.addListener(A,t=>this.ctx.bus.dispatch([A,t.value])),this.ctx.bus.addHandlers({[A]:Pe("route"),[Gf]:(t,[e,i])=>({[_b]:i})}),this.ctx.bus.addEffect(_b,([t,e])=>this.router.routeTo(this.router.format(t,e))),this.addViews({route:"route",routeComponent:["route.id",t=>(this.config.components[t]||(()=>["div",`missing component for route: ${t}`]))(this.ctx)]})}addViews(t){const e=this.ctx.views;for(let i in t){const r=t[i];e[i]=x(r)?bb(this.state,r[0],r[1]):bb(this.state,r)}}start(){Jf(this.ctx.bus),window.addEventListener("resize",()=>{this.ctx.bus.dispatch([Wb])}),this.router.start(),ne(()=>{if(this.ctx.bus.processQueue())return this.rootComponent()},{root:this.config.domRoot,ctx:this.ctx})}rootComponent(){this.ctx.views.debug.deref(),this.ctx.ui;return["div",["div",this.ctx.views.routeComponent]]}}const ac=(t,n,$={})=>(o,s)=>["a",Object.assign(Object.assign({},$),{onclick:t,disabled:s}),n];const Nf=t=>{const o=t.ui,$=ac(o=>{o.preventDefault(),t.bus.dispatch([Tb])},"Clear",o.toolbar.button),r=ac(o=>{o.preventDefault(),t.bus.dispatch([Ub])},"Random",o.toolbar.button);return()=>["div.mv4",[$],[r]]};const Of={anim:100,pad:1,margin:0,hlOn:{fill:"#E83015"},bgOn:{fill:"#CCCCCC"},bgOff:{fill:"#CCCCCC"},fgOn:{fill:"#E83015"},fgOff:{fill:"#fff"},floor:1},Pf=["filter",{id:"blur"},["feGaussianBlur",{in:"SourceGraphic",stdDeviation:".25"}]],za=(s={})=>{const i=Object.assign(Object.assign({r:5},Of),s),{r:e,pad:t,margin:n,glyph:a,floor:g}=i,c=e*Math.pow(.5,2),l=e+t,O=l+n,r=2*l+2*n,f={width:r,height:r*g},b={transition:`all ${i.anim}ms ease-out`},o={cx:O,cy:O},$=Object.assign(Object.assign(Object.assign({},i.hlOn),o),{r:l}),j=Object.assign(Object.assign(Object.assign({},i.bgOn),o),{style:b,r:e}),C=Object.assign(Object.assign({},j),i.bgOff),E=Object.assign(Object.assign(Object.assign({},i.fgOn),o),{style:b,r:c}),G=Object.assign(Object.assign({},E),i.fgOff),h=Object.assign(Object.assign({},i.fgOn),{x:"50%",y:"50%","text-anchor":"middle","alignment-baseline":"central",font:"bold sans-serif","font-size":.5*r,style:b}),p=Object.assign(Object.assign({},h),i.fgOff);return(s,i,e,t)=>["svg",Object.assign(Object.assign({},f),i),Pf,["g",["circle",t?$:{}],["circle",e?j:C],a?["text",e?h:p,a]:["circle",e?E:G]]]};const Aa={anim:0,r:16,pad:2},Qf=Object.assign(Object.assign({},Aa),{glyph:"C"}),Rf=Object.assign(Object.assign({},Aa),{bgOn:{fill:"#000"},bgOff:{fill:"#000"},floor:2}),Sf=i=>{const t=i.views,$=t.size.deref(),e=Math.min(36,.9*$[0]/13),s={r:e/2*(8/9),pad:e/2*(1/9)},r=t.highlights.deref();return["div.mb4",...t.keyState.deref().map((t,$)=>[4===$?"div.dib.mr4":"div.dib",[0===$?za(Object.assign(Object.assign({},Qf),s)):[2,4,5,7,9,11].includes($)?za(Object.assign(Object.assign({},Aa),s)):za(Object.assign(Object.assign({},Rf),s)),{class:"pointer mr0",onclick:t=>{t.preventDefault(),i.bus.dispatch([V,$])}},t,r.includes($)]])]};var e={};const Tf=t=>t[Symbol.iterator]();function*bc(e,r){let t,$={},i=Tf(e);for(;!(t=i.next()).done;){let e=r?r(t.value):t.value,i=JSON.stringify(e),o=$[i];o?o[1]++:$[i]=[e,1]}yield*Object.keys($).map(e=>$[e])}const cc=(n,t)=>null!=n&&"function"==typeof n[t];const Uf=r=>null!=r&&"function"!=typeof r&&void 0!==r.length;const Vf=s=>s instanceof Map;const Wf=t=>t instanceof Set;class dc{constructor(e){this.value=e}deref(){return this.value}}const ec=e=>e instanceof dc;const Xf=e=>e instanceof dc?e.deref():e;const Yf=(r,o=r=>void 0!==r?": "+r:"")=>class extends Error{constructor(e){super(r(e)+o(e))}};const Zf=Yf(()=>"illegal arity");const $f=r=>{throw new Zf(r)};const _f=e=>2===e.length?[void 0,e[1]]:3===e.length?[e[1],e[2]]:$f(e.length);function ag(...e){const r=e[0],$=r[0],t=r[1],c=r[2],u=null==(e=_f(e))[0]?$():e[0],o=e[1];return Xf(t(cc(o,"$reduce")?o.$reduce(c,u):Uf(o)?bg(c,u,o):cg(c,u,o)))}const bg=(e,r,$)=>{for(let t=0,c=$.length;t<c;t++)if(r=e(r,$[t]),ec(r)){r=r.deref();break}return r},cg=(e,r,$)=>{for(let t of $)if(r=e(r,t),ec(r)){r=r.deref();break}return r};function dg($,e){if(Vf($))for(let t of e)$.set(t[0],t[1]);else for(let t of e)$.add(t);return $}const eg=(e,$)=>cc(e,"empty")?e.empty():new(e[Symbol.species]||$);const fc=e=>Wf(e)?e:new Set(e);const fg=(e,$,r)=>r?ag(e(),r):[()=>null,e=>e||new Set,(e,r)=>e?$(e,fc(r)):fc(r)];const Ba=(e,t,r)=>{if(r=r||eg(e,Set),e===t)return dg(r,e);if(t.size<e.size)return Ba(t,e,r);for(let $ of t)e.has($)&&r.add($);return r};function gg(e){return fg(gg,Ba,e)}function Ca($){return"object"==typeof $&&"string"==typeof $.name}function Da($){return"object"==typeof $&&"number"==typeof $.step&&"number"==typeof $.alt}const gc=[0,2,4,-1,1,3,5],hc=gc.map($=>Math.floor(7*$/12));function ic($){const{step:t,alt:e,oct:r,dir:o=1}=$,p=gc[t]+7*e;return void 0===r?[o*p]:[o*p,o*(r-hc[t]-4*e)]}const hg=[3,0,4,1,5,2,6];function ig($){const[t,e,r]=$,o=hg[jg(t)],p=Math.floor((t+1)/7);return void 0===e?{step:o,alt:p,dir:r}:{step:o,alt:p,oct:e+4*p+hc[o],dir:r}}function jg($){const t=($+1)%7;return t<0?7+t:t}const jc={empty:!0,name:"",pc:"",acc:""},kc={},lc=($,t)=>Array(t+1).join($),kg=$=>"CDEFGAB".charAt($),Ea=$=>$<0?lc("b",-$):lc("#",$),mc=$=>"b"===$[0]?-$.length:$.length;function l($){return"string"==typeof $?kc[$]||(kc[$]=og($)):Da($)?l(pg($)):Ca($)?l($.name):jc}const lg=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function mg($){const t=lg.exec($);return[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]}function ng($){return l(ig($))}const nc=[0,2,4,5,7,9,11];function og($){const t=mg($);if(""===t[0]||""!==t[3])return jc;const e=t[0],r=t[1],o=t[2],p=(e.charCodeAt(0)+3)%7,u=mc(r),a=o.length?+o:void 0,n=ic({step:p,alt:u,oct:a}),c=e+r+o,z=e+r,V=(nc[p]+u+120)%12,s=void 0===a?-100:a,i=nc[p]+u+12*(s+1),l=i>=0&&i<=127?i:null;return{empty:!1,acc:r,alt:u,chroma:V,coord:n,freq:void 0===a?null:440*Math.pow(2,(i-69)/12),height:i,letter:e,midi:l,name:c,oct:a,pc:z,step:p}}function pg($){const{step:t,alt:e,oct:r}=$,o=kg(t);if(!o)return"";const p=o+Ea(e);return r||0===r?p+r:p}const Fa={empty:!0,name:"",acc:""},qg=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$");function rg($){const t=qg.exec(`${$}`);return null===t?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}const oc={};function W($){return"string"==typeof $?oc[$]||(oc[$]=sg($)):Da($)?W(ug($)):Ca($)?W($.name):Fa}const pc=[0,2,4,5,7,9,11],qc="PMMPPMM";function sg($){const t=rg($);if(""===t[0])return Fa;const e=+t[0],r=t[1],o=(Math.abs(e)-1)%7,p=qc[o];if("M"===p&&"P"===r)return Fa;const u="M"===p?"majorable":"perfectable",a=""+e+r,n=e<0?-1:1,c=8===e||-8===e?e:n*(o+1),z=tg(u,r),V=Math.floor((Math.abs(e)-1)/7);return{empty:!1,name:a,num:e,q:r,step:o,alt:z,dir:n,type:u,simple:c,semitones:n*(pc[o]+z+12*V),chroma:(n*(pc[o]+z)%12+12)%12,coord:ic({step:o,alt:z,oct:V,dir:n}),oct:V}}function tg($,t){return"M"===t&&"majorable"===$||"P"===t&&"perfectable"===$?0:"m"===t&&"majorable"===$?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*("perfectable"===$?t.length:t.length+1):0}function ug($){const{step:t,alt:e,oct:r=0,dir:o}=$;return o?(o<0?"-":"")+(t+1+7*r)+vg("M"===qc[t]?"majorable":"perfectable",e):""}const rc=($,t)=>Array(Math.abs(t)+1).join($);function vg($,t){return 0===t?"majorable"===$?"M":"P":-1===t&&"majorable"===$?"m":t>0?rc("A",t):rc("d","perfectable"===$?t:t+1)}function sc($,t){const e=l($),r=W(t);if(e.empty||r.empty)return"";const o=e.coord,p=r.coord;return ng(1===o.length?[o[0]+p[0]]:[o[0]+p[0],o[1]+p[1]]).name}function wg($){return+$>=0&&+$<=127}function tc($){if(wg($))return+$;const o=l($);return o.empty?null:o.midi}const Oh=Math.log(2),Ph=Math.log(440);const xg="C C# D D# E F F# G G# A A# B".split(" "),yg="C Db D Eb E F Gb G Ab A Bb B".split(" ");function zg($,o={}){$=Math.round($);const r=(!0===o.sharps?xg:yg)[$%12];return o.pitchClass?r:r+(Math.floor($/12)-1)}const uc=$=>o=>{const r=l(o);if(r.empty)return"";const t=$?r.alt>0:r.alt<0,v=null===r.midi;return zg(r.midi||r.chroma,{sharps:t,pitchClass:v})},Ag=uc(!0),Qh=uc(!1);const vc={empty:!0,name:"",chordType:""},wc={};function X($){return"string"==typeof $?wc[$]||(wc[$]=Eg($)):"number"==typeof $?X(Ga[$]||""):Da($)?Bg($):Ca($)?X($.name):vc}function Bg($){return X(Ea($.alt)+Ga[$.step])}const Cg=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function Dg($){return Cg.exec($)||["","","",""]}const xc="I II III IV V VI VII",Ga=xc.split(" "),Rh=xc.toLowerCase().split(" ");function Eg($){const[r,e,a,t]=Dg($);if(!a)return vc;const o=a.toUpperCase(),R=Ga.indexOf(o),n=mc(e);return{empty:!1,name:r,roman:a,interval:W({step:R,alt:n,dir:1}).name,acc:e,chordType:t,alt:n,step:R,major:a===o,oct:0,dir:1}}const yc=t=>(i,a="")=>i.map((i,r)=>"-"!==i?t[r]+a+i:"");function Y(t,i,a,r){return o=>{const $=t.split(" "),e=$.map(t=>X(t).interval||""),n=e.map(t=>sc(o,t)),m=yc(n);return{tonic:o,grades:$,intervals:e,scale:n,chords:m(i.split(" ")),chordsHarmonicFunction:a.split(" "),chordScales:m(r.split(",")," ")}}}const Fg=(t,i)=>{const a=l(t),r=l(i);return a.empty||r.empty?0:r.coord[0]-a.coord[0]},Gg=Y("I II III IV V VI VII","maj7 m7 m7 maj7 7 m7 m7b5","T SD T SD D T D","major,dorian,phrygian,lydian,mixolydian,minor,locrian"),Sh=Y("I II bIII IV V bVI bVII","m7 m7b5 maj7 m7 m7 maj7 7","T SD T SD D SD SD","minor,locrian,major,dorian,phrygian,lydian,mixolydian"),Th=Y("I II bIII IV V bVI VII","mmaj7 m7b5 +maj7 m7 7 maj7 mo7","T SD T SD D SD D","harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian"),Uh=Y("I II bIII IV V VI VII","m6 m7 +maj7 7 7 m7b5 m7b5","T SD T SD D - -","melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered");function Hg(t){const i=Gg(t),a=Fg("C",t),r=yc(i.scale);return{...i,type:"major",minorRelative:sc(t,"-3m"),alteration:a,keySignature:Ea(a),secondaryDominants:r("- VI7 VII7 I7 II7 III7 -".split(" ")),secondaryDominantsMinorRelative:r("- IIIm7b5 IV#m7 Vm7 VIm7 VIIm7b5 -".split(" ")),substituteDominants:r("- bIII7 IV7 bV7 bVI7 bVII7 -".split(" ")),substituteDominantsMinorRelative:r("- IIIm7 Im7 IIbm7 VIm7 IVm7 -".split(" "))}}var Ig={};function Jg(e){var r=new c(e),t=r.readChunk();if("MThd"!=t.id)throw"Bad MIDI file.  Expected 'MHdr', got: '"+t.id+"'";for(var a=Kg(t.data),n=[],s=0;!r.eof()&&s<a.numTracks;s++){var o=r.readChunk();if("MTrk"!=o.id)throw"Bad MIDI file.  Expected 'MTrk', got: '"+o.id+"'";var i=Lg(o.data);n.push(i)}return{header:a,tracks:n}}function Kg(e){var r=new c(e),t={format:r.readUInt16(),numTracks:r.readUInt16()},a=r.readUInt16();return 32768&a?(t.framesPerSecond=256-(a>>8),t.ticksPerFrame=255&a):t.ticksPerBeat=a,t}function Lg(e){for(var r,t=new c(e),a=[];!t.eof();){var n=s();a.push(n)}return a;function s(){var e={};e.deltaTime=t.readVarInt();var a=t.readUInt8();if(240==(240&a)){if(255!==a){if(240==a){e.type="sysEx";s=t.readVarInt();return e.data=t.readBytes(s),e}if(247==a){e.type="endSysEx";s=t.readVarInt();return e.data=t.readBytes(s),e}throw"Unrecognised MIDI event type byte: "+a}e.meta=!0;var n=t.readUInt8(),s=t.readVarInt();switch(n){case 0:if(e.type="sequenceNumber",2!==s)throw"Expected length for sequenceNumber event is 2, got "+s;return e.number=t.readUInt16(),e;case 1:return e.type="text",e.text=t.readString(s),e;case 2:return e.type="copyrightNotice",e.text=t.readString(s),e;case 3:return e.type="trackName",e.text=t.readString(s),e;case 4:return e.type="instrumentName",e.text=t.readString(s),e;case 5:return e.type="lyrics",e.text=t.readString(s),e;case 6:return e.type="marker",e.text=t.readString(s),e;case 7:return e.type="cuePoint",e.text=t.readString(s),e;case 32:if(e.type="channelPrefix",1!=s)throw"Expected length for channelPrefix event is 1, got "+s;return e.channel=t.readUInt8(),e;case 33:if(e.type="portPrefix",1!=s)throw"Expected length for portPrefix event is 1, got "+s;return e.port=t.readUInt8(),e;case 47:if(e.type="endOfTrack",0!=s)throw"Expected length for endOfTrack event is 0, got "+s;return e;case 81:if(e.type="setTempo",3!=s)throw"Expected length for setTempo event is 3, got "+s;return e.microsecondsPerBeat=t.readUInt24(),e;case 84:if(e.type="smpteOffset",5!=s)throw"Expected length for smpteOffset event is 5, got "+s;var o=t.readUInt8();return e.frameRate={0:24,32:25,64:29,96:30}[96&o],e.hour=31&o,e.min=t.readUInt8(),e.sec=t.readUInt8(),e.frame=t.readUInt8(),e.subFrame=t.readUInt8(),e;case 88:if(e.type="timeSignature",4!=s)throw"Expected length for timeSignature event is 4, got "+s;return e.numerator=t.readUInt8(),e.denominator=1<<t.readUInt8(),e.metronome=t.readUInt8(),e.thirtyseconds=t.readUInt8(),e;case 89:if(e.type="keySignature",2!=s)throw"Expected length for keySignature event is 2, got "+s;return e.key=t.readInt8(),e.scale=t.readUInt8(),e;case 127:return e.type="sequencerSpecific",e.data=t.readBytes(s),e;default:return e.type="unknownMeta",e.data=t.readBytes(s),e.metatypeByte=n,e;}}else{var i;if(0==(128&a)){if(null===r)throw"Running status byte encountered before status byte";i=a,a=r,e.running=!0}else i=t.readUInt8(),r=a;var d=a>>4;switch(e.channel=15&a,d){case 8:return e.type="noteOff",e.noteNumber=i,e.velocity=t.readUInt8(),e;case 9:var u=t.readUInt8();return e.type=0===u?"noteOff":"noteOn",e.noteNumber=i,e.velocity=u,0===u&&(e.byte9=!0),e;case 10:return e.type="noteAftertouch",e.noteNumber=i,e.amount=t.readUInt8(),e;case 11:return e.type="controller",e.controllerType=i,e.value=t.readUInt8(),e;case 12:return e.type="programChange",e.programNumber=i,e;case 13:return e.type="channelAftertouch",e.amount=i,e;case 14:return e.type="pitchBend",e.value=i+(t.readUInt8()<<7)-8192,e;default:throw"Unrecognised MIDI event type: "+d;}}}}function c(e){this.buffer=e,this.bufferLen=this.buffer.length,this.pos=0}c.prototype.eof=function(){return this.pos>=this.bufferLen},c.prototype.readUInt8=function(){var e=this.buffer[this.pos];return this.pos+=1,e},c.prototype.readInt8=function(){var e=this.readUInt8();return 128&e?e-256:e},c.prototype.readUInt16=function(){return(this.readUInt8()<<8)+this.readUInt8()},c.prototype.readInt16=function(){var e=this.readUInt16();return 32768&e?e-65536:e},c.prototype.readUInt24=function(){return(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},c.prototype.readInt24=function(){var e=this.readUInt24();return 8388608&e?e-16777216:e},c.prototype.readUInt32=function(){return(this.readUInt8()<<24)+(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},c.prototype.readBytes=function(e){var r=this.buffer.slice(this.pos,this.pos+e);return this.pos+=e,r},c.prototype.readString=function(e){var r=this.readBytes(e);return String.fromCharCode.apply(null,r)},c.prototype.readVarInt=function(){for(var e=0;!this.eof();){var r=this.readUInt8();if(!(128&r))return e+r;e+=127&r,e<<=7}return e},c.prototype.readChunk=function(){var e=this.readString(4),r=this.readUInt32();return{id:e,length:r,data:this.readBytes(r)}},Ig=Jg;var Mg={};function Ng(t,e){if("object"!=typeof t)throw"Invalid MIDI data";e=e||{};var r,n=t.header||{},i=t.tracks||[],a=i.length,w=new b;for(Og(w,n,a),r=0;r<a;r++)Pg(w,i[r],e);return w.buffer}function Og(t,e,r){var n=null==e.format?1:e.format,i=128;e.timeDivision?i=e.timeDivision:e.ticksPerFrame&&e.framesPerSecond?i=-(255&e.framesPerSecond)<<8|255&e.ticksPerFrame:e.ticksPerBeat&&(i=32767&e.ticksPerBeat);var a=new b;a.writeUInt16(n),a.writeUInt16(r),a.writeUInt16(i),t.writeChunk("MThd",a.buffer)}function Pg(t,e,r){var n,i=new b,a=e.length,w=null;for(n=0;n<a;n++)!1!==r.running&&(r.running||e[n].running)||(w=null),w=Qg(i,e[n],w,r.useByte9ForNoteOff);t.writeChunk("MTrk",i.buffer)}function Qg(t,e,r,n){var i=e.type,a=e.deltaTime,w=e.text||"",I=e.data||[],o=null;switch(t.writeVarInt(a),i){case"sequenceNumber":t.writeUInt8(255),t.writeUInt8(0),t.writeVarInt(2),t.writeUInt16(e.number);break;case"text":t.writeUInt8(255),t.writeUInt8(1),t.writeVarInt(w.length),t.writeString(w);break;case"copyrightNotice":t.writeUInt8(255),t.writeUInt8(2),t.writeVarInt(w.length),t.writeString(w);break;case"trackName":t.writeUInt8(255),t.writeUInt8(3),t.writeVarInt(w.length),t.writeString(w);break;case"instrumentName":t.writeUInt8(255),t.writeUInt8(4),t.writeVarInt(w.length),t.writeString(w);break;case"lyrics":t.writeUInt8(255),t.writeUInt8(5),t.writeVarInt(w.length),t.writeString(w);break;case"marker":t.writeUInt8(255),t.writeUInt8(6),t.writeVarInt(w.length),t.writeString(w);break;case"cuePoint":t.writeUInt8(255),t.writeUInt8(7),t.writeVarInt(w.length),t.writeString(w);break;case"channelPrefix":t.writeUInt8(255),t.writeUInt8(32),t.writeVarInt(1),t.writeUInt8(e.channel);break;case"portPrefix":t.writeUInt8(255),t.writeUInt8(33),t.writeVarInt(1),t.writeUInt8(e.port);break;case"endOfTrack":t.writeUInt8(255),t.writeUInt8(47),t.writeVarInt(0);break;case"setTempo":t.writeUInt8(255),t.writeUInt8(81),t.writeVarInt(3),t.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":t.writeUInt8(255),t.writeUInt8(84),t.writeVarInt(5);var U=31&e.hour|{24:0,25:32,29:64,30:96}[e.frameRate];t.writeUInt8(U),t.writeUInt8(e.min),t.writeUInt8(e.sec),t.writeUInt8(e.frame),t.writeUInt8(e.subFrame);break;case"timeSignature":t.writeUInt8(255),t.writeUInt8(88),t.writeVarInt(4),t.writeUInt8(e.numerator);var s=255&Math.floor(Math.log(e.denominator)/Math.LN2);t.writeUInt8(s),t.writeUInt8(e.metronome),t.writeUInt8(e.thirtyseconds||8);break;case"keySignature":t.writeUInt8(255),t.writeUInt8(89),t.writeVarInt(2),t.writeInt8(e.key),t.writeUInt8(e.scale);break;case"sequencerSpecific":t.writeUInt8(255),t.writeUInt8(127),t.writeVarInt(I.length),t.writeBytes(I);break;case"unknownMeta":null!=e.metatypeByte&&(t.writeUInt8(255),t.writeUInt8(e.metatypeByte),t.writeVarInt(I.length),t.writeBytes(I));break;case"sysEx":t.writeUInt8(240),t.writeVarInt(I.length),t.writeBytes(I);break;case"endSysEx":t.writeUInt8(247),t.writeVarInt(I.length),t.writeBytes(I);break;case"noteOff":(o=(!1!==n&&e.byte9||n&&0==e.velocity?144:128)|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteOn":(o=144|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteAftertouch":(o=160|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.noteNumber),t.writeUInt8(e.amount);break;case"controller":(o=176|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.controllerType),t.writeUInt8(e.value);break;case"programChange":(o=192|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.programNumber);break;case"channelAftertouch":(o=208|e.channel)!==r&&t.writeUInt8(o),t.writeUInt8(e.amount);break;case"pitchBend":(o=224|e.channel)!==r&&t.writeUInt8(o);var c=8192+e.value,$=127&c,l=c>>7&127;t.writeUInt8($),t.writeUInt8(l);break;default:throw"Unrecognized event type: "+i;}return o}function b(){this.buffer=[]}b.prototype.writeUInt8=function(t){this.buffer.push(255&t)},b.prototype.writeInt8=b.prototype.writeUInt8,b.prototype.writeUInt16=function(t){var e=t>>8&255,r=255&t;this.writeUInt8(e),this.writeUInt8(r)},b.prototype.writeInt16=b.prototype.writeUInt16,b.prototype.writeUInt24=function(t){var e=t>>16&255,r=t>>8&255,n=255&t;this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(n)},b.prototype.writeInt24=b.prototype.writeUInt24,b.prototype.writeUInt32=function(t){var e=t>>24&255,r=t>>16&255,n=t>>8&255,i=255&t;this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(n),this.writeUInt8(i)},b.prototype.writeInt32=b.prototype.writeUInt32,b.prototype.writeBytes=function(t){this.buffer=this.buffer.concat(Array.prototype.slice.call(t,0))},b.prototype.writeString=function(t){var e,r=t.length,n=[];for(e=0;e<r;e++)n.push(t.codePointAt(e));this.writeBytes(n)},b.prototype.writeVarInt=function(t){if(t<0)throw"Cannot write negative variable-length integer";if(t<=127)this.writeUInt8(t);else{var e=t,r=[];for(r.push(127&e),e>>=7;e;){var n=127&e|128;r.push(n),e>>=7}this.writeBytes(r.reverse())}},b.prototype.writeChunk=function(t,e){this.writeString(t),this.writeUInt32(e.length),this.writeBytes(e)},Mg=Ng;var Ha={};function zc(r,e,$){void 0===$&&($="ticks");var o=0,t=r.length,s=t;if(t>0&&r[t-1][$]<=e)return t-1;for(;o<s;){var a=Math.floor(o+(s-o)/2),i=r[a],n=r[a+1];if(i[$]===e){for(var v=a;v<r.length;v++){r[v][$]===e&&(a=v)}return a}if(i[$]<e&&n[$]>e)return a;i[$]>e?s=a:i[$]<e&&(o=a+1)}return-1}Object.defineProperty(Ha,"__esModule",{value:!0});var Z=zc;function Rg(r,e,$){if(void 0===$&&($="ticks"),r.length){var o=zc(r,e[$],$);r.splice(o+1,0,e)}else r.push(e)}Ha.search=Z;var $=Rg;Ha.insert=$;var Ia={};Object.defineProperty(Ia,"__esModule",{value:!0});var _=new WeakMap,Ja=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];Ia.keySignatureKeys=Ja;var Sg=function(){function t(t){var e=this;this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",_.set(this,480),t&&(_.set(this,t.header.ticksPerBeat),t.tracks[0].forEach(function(t){t.meta&&("timeSignature"===t.type?e.timeSignatures.push({ticks:t.absoluteTime,timeSignature:[t.numerator,t.denominator]}):"setTempo"===t.type?e.tempos.push({bpm:6e7/t.microsecondsPerBeat,ticks:t.absoluteTime}):"keySignature"===t.type?e.keySignatures.push({key:Ja[t.key+7],scale:0===t.scale?"major":"minor",ticks:t.absoluteTime}):"trackName"===t.type?e.name=t.text:"endOfTrack"!==t.type&&e.meta.push({text:t.text,ticks:t.absoluteTime,type:t.type}))}),this.update())}return t.prototype.update=function(){var t=this,e=0,i=0;this.tempos.sort(function(t,e){return t.ticks-e.ticks}),this.tempos.forEach(function(r,s){var a=s>0?t.tempos[s-1].bpm:t.tempos[0].bpm,n=r.ticks/t.ppq-i,p=60/a*n;r.time=p+e,e=r.time,i+=n}),this.timeSignatures.sort(function(t,e){return t.ticks-e.ticks}),this.timeSignatures.forEach(function(e,i){var r=i>0?t.timeSignatures[i-1]:t.timeSignatures[0],s=(e.ticks-r.ticks)/t.ppq/r.timeSignature[0]/(r.timeSignature[1]/4);r.measures=r.measures||0,e.measures=s+r.measures})},t.prototype.ticksToSeconds=function(t){var e=Z(this.tempos,t);if(-1!==e){var i=this.tempos[e],r=i.time,s=(t-i.ticks)/this.ppq;return r+60/i.bpm*s}return .5*(t/this.ppq)},t.prototype.ticksToMeasures=function(t){var e=Z(this.timeSignatures,t);if(-1!==e){var i=this.timeSignatures[e],r=(t-i.ticks)/this.ppq;return i.measures+r/(i.timeSignature[0]/i.timeSignature[1])/4}return t/this.ppq/4},Object.defineProperty(t.prototype,"ppq",{get:function(){return _.get(this)},enumerable:!0,configurable:!0}),t.prototype.secondsToTicks=function(t){var e=Z(this.tempos,t,"time");if(-1!==e){var i=this.tempos[e],r=(t-i.time)/(60/i.bpm);return Math.round(i.ticks+r*this.ppq)}var s=t/.5;return Math.round(s*this.ppq)},t.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(t){return{bpm:t.bpm,ticks:t.ticks}}),timeSignatures:this.timeSignatures}},t.prototype.fromJSON=function(t){this.name=t.name,this.tempos=t.tempos.map(function(t){return Object.assign({},t)}),this.timeSignatures=t.timeSignatures.map(function(t){return Object.assign({},t)}),this.keySignatures=t.keySignatures.map(function(t){return Object.assign({},t)}),this.meta=t.meta.map(function(t){return Object.assign({},t)}),_.set(this,t.ppq),this.update()},t.prototype.setTempo=function(t){this.tempos=[{bpm:t,ticks:0}],this.update()},t}(),Ka=Sg;Ia.Header=Ka;var La={};function Tg(r){if(!Array.isArray(r))throw new TypeError("Expected value to be an array");return Ac(r)}function Ac(r){return Cc(r,[])}function Ug(r,t){if(!Array.isArray(r))throw new TypeError("Expected value to be an array");return Bc(r,t)}function Bc(r,t){if("number"!=typeof t)throw new TypeError("Expected the depth to be a number");return Dc(r,[],t)}function Cc(r,t){for(var e=0;e<r.length;e++){var $=r[e];Array.isArray($)?Cc($,t):t.push($)}return t}function Dc(r,t,e){e--;for(var $=0;$<r.length;$++){var a=r[$];e>-1&&Array.isArray(a)?Dc(a,t,e):t.push(a)}return t}(La=Tg).from=Ac,La.depth=Ug,La.fromDepth=Bc;var t={},Ma=t&&t.__spreadArrays||function(){for(var e=0,a=0,r=arguments.length;a<r;a++)e+=arguments[a].length;var t=Array(e),o=0;for(a=0;a<r;a++)for(var n=arguments[a],$=0,i=n.length;$<i;$++,o++)t[o]=n[$];return t},Vg=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var Wg=Vg(La);function Xg(e,a){return[{absoluteTime:e.ticks,channel:a,deltaTime:0,noteNumber:e.midi,type:"noteOn",velocity:Math.floor(127*e.velocity)},{absoluteTime:e.ticks+e.durationTicks,channel:a,deltaTime:0,noteNumber:e.midi,type:"noteOff",velocity:Math.floor(127*e.noteOffVelocity)}]}function Yg(e){return Wg.default(e.notes.map(function(a){return Xg(a,e.channel)}))}function Zg(e,a){return{absoluteTime:e.ticks,channel:a,controllerType:e.number,deltaTime:0,type:"controller",value:e.value}}function $g(e){for(var a=[],r=0;r<127;r++)e.controlChanges.hasOwnProperty(r)&&e.controlChanges[r].forEach(function(r){a.push(Zg(r,e.channel))});return a}function _g(e,a){return{absoluteTime:e.ticks,channel:a,deltaTime:0,type:"pitchBend",value:e.value}}function ah(e){var a=[];return e.pitchBends.forEach(function(r){a.push(_g(r,e.channel))}),a}function bh(e){return{absoluteTime:0,channel:e.channel,deltaTime:0,programNumber:e.instrument.number,type:"programChange"}}function ch(e){return{absoluteTime:0,deltaTime:0,meta:!0,text:e,type:"trackName"}}function dh(e){return{absoluteTime:e.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/e.bpm),type:"setTempo"}}function eh(e){return{absoluteTime:e.ticks,deltaTime:0,denominator:e.timeSignature[1],meta:!0,metronome:24,numerator:e.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function fh(e){var a=Ja.indexOf(e.key);return{absoluteTime:e.ticks,deltaTime:0,key:a+7,meta:!0,scale:"major"===e.scale?0:1,type:"keySignature"}}function gh(e){return{absoluteTime:e.ticks,deltaTime:0,meta:!0,text:e.text,type:e.type}}function hh(e){var a={header:{format:1,numTracks:e.tracks.length+1,ticksPerBeat:e.header.ppq},tracks:Ma([Ma([{absoluteTime:0,deltaTime:0,meta:!0,text:e.header.name,type:"trackName"}],e.header.keySignatures.map(function(e){return fh(e)}),e.header.meta.map(function(e){return gh(e)}),e.header.tempos.map(function(e){return dh(e)}),e.header.timeSignatures.map(function(e){return eh(e)}))],e.tracks.map(function(e){return Ma([ch(e.name),bh(e)],Yg(e),$g(e),ah(e))}))};return a.tracks=a.tracks.map(function(e){e=e.sort(function(e,a){return e.absoluteTime-a.absoluteTime});var a=0;return e.forEach(function(e){e.deltaTime=e.absoluteTime-a,a=e.absoluteTime,delete e.absoluteTime}),e.push({deltaTime:0,meta:!0,type:"endOfTrack"}),e}),new Uint8Array(Mg(a))}var Ec=hh;t.encode=Ec;var aa={};Object.defineProperty(aa,"__esModule",{value:!0});var F={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"};aa.controlChangeNames=F;var G=Object.keys(F).reduce(function(e,t){return e[F[t]]=t,e},{});aa.controlChangeIds=G;var Na=new WeakMap,Fc=new WeakMap,ih=function(){function e(e,t){Na.set(this,t),Fc.set(this,e.controllerType),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(e.prototype,"number",{get:function(){return Fc.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return F[this.number]?F[this.number]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return Na.get(this).ticksToSeconds(this.ticks)},set:function(e){var t=Na.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},e}(),Gc=ih;aa.ControlChange=Gc;var Hc={};Object.defineProperty(Hc,"__esModule",{value:!0});function jh(){return new Proxy({},{get:function(r,e){return r[e]?r[e]:G.hasOwnProperty(e)?r[G[e]]:void 0},set:function(r,e,o){return G.hasOwnProperty(e)?r[G[e]]=o:r[e]=o,!0}})}var Ic=jh;Hc.createControlChanges=Ic;var Jc={};Object.defineProperty(Jc,"__esModule",{value:!0});var Oa=new WeakMap,kh=function(){function e(e,t){Oa.set(this,t),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(e.prototype,"time",{get:function(){return Oa.get(this).ticksToSeconds(this.ticks)},set:function(e){var t=Oa.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},e}(),Kc=kh;Jc.PitchBend=Kc;var ba={};Object.defineProperty(ba,"__esModule",{value:!0});var Pa=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"];ba.instrumentByPatchID=Pa;var Lc=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"];ba.InstrumentFamilyByID=Lc;var Mc={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"};ba.DrumKitByPatchID=Mc;var Nc={};Object.defineProperty(Nc,"__esModule",{value:!0});var Oc=new WeakMap,lh=function(){function e(e,t){if(this.number=0,Oc.set(this,t),this.number=0,e){var r=e.find(function(e){return"programChange"===e.type});r&&(this.number=r.programNumber)}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.percussion?Mc[this.number]:Pa[this.number]},set:function(e){var t=Pa.indexOf(e);-1!==t&&(this.number=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"family",{get:function(){return this.percussion?"drums":Lc[Math.floor(this.number/8)]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"percussion",{get:function(){return 9===Oc.get(this).channel},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{family:this.family,name:this.name,number:this.number}},e.prototype.fromJSON=function(e){this.number=e.number},e}(),Qa=lh;Nc.Instrument=Qa;var Pc={};function mh(t){var i=Math.floor(t/12)-1;return Qc(t)+i.toString()}function Qc(t){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t%12]}function nh(t){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].indexOf(t)}Object.defineProperty(Pc,"__esModule",{value:!0});var oh=function(){var t=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,i={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(e){var r=t.exec(e),o=r[1],a=r[2];return i[o.toLowerCase()]+12*(parseInt(a,10)+1)}}(),u=new WeakMap,ph=function(){function t(t,i,e){u.set(this,e),this.midi=t.midi,this.velocity=t.velocity,this.noteOffVelocity=i.velocity,this.ticks=t.ticks,this.durationTicks=i.ticks-t.ticks}return Object.defineProperty(t.prototype,"name",{get:function(){return mh(this.midi)},set:function(t){this.midi=oh(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(t){var i=t-this.octave;this.midi+=12*i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return Qc(this.midi)},set:function(t){this.midi=12*(this.octave+1)+nh(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var t=u.get(this);return t.ticksToSeconds(this.ticks+this.durationTicks)-t.ticksToSeconds(this.ticks)},set:function(t){var i=u.get(this).secondsToTicks(this.time+t);this.durationTicks=i-this.ticks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return u.get(this).ticksToSeconds(this.ticks)},set:function(t){var i=u.get(this);this.ticks=i.secondsToTicks(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bars",{get:function(){return u.get(this).ticksToMeasures(this.ticks)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},t}(),Rc=ph;Pc.Note=Rc;var Sc={};Object.defineProperty(Sc,"__esModule",{value:!0});var ca=new WeakMap,qh=function(){function e(e,t){var n=this;if(this.name="",this.notes=[],this.controlChanges=Ic(),this.pitchBends=[],ca.set(this,t),e){var r=e.find(function(e){return"trackName"===e.type});this.name=r?r.text:""}if(this.instrument=new Qa(e,this),this.channel=0,e){for(var i=e.filter(function(e){return"noteOn"===e.type}),a=e.filter(function(e){return"noteOff"===e.type}),o=function(){var e=i.shift();s.channel=e.channel;var t=a.findIndex(function(t){return t.noteNumber===e.noteNumber&&t.absoluteTime>=e.absoluteTime});if(-1!==t){var n=a.splice(t,1)[0];s.addNote({durationTicks:n.absoluteTime-e.absoluteTime,midi:e.noteNumber,noteOffVelocity:n.velocity/127,ticks:e.absoluteTime,velocity:e.velocity/127})}},s=this;i.length;)o();e.filter(function(e){return"controller"===e.type}).forEach(function(e){n.addCC({number:e.controllerType,ticks:e.absoluteTime,value:e.value/127})}),e.filter(function(e){return"pitchBend"===e.type}).forEach(function(e){n.addPitchBend({ticks:e.absoluteTime,value:e.value/Math.pow(2,13)})})}}return e.prototype.addNote=function(e){var t=ca.get(this),n=new Rc({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},t);return Object.assign(n,e),$(this.notes,n,"ticks"),this},e.prototype.addCC=function(e){var t=ca.get(this),n=new Gc({controllerType:e.number},t);return delete e.number,Object.assign(n,e),Array.isArray(this.controlChanges[n.number])||(this.controlChanges[n.number]=[]),$(this.controlChanges[n.number],n,"ticks"),this},e.prototype.addPitchBend=function(e){var t=ca.get(this),n=new Kc({},t);return Object.assign(n,e),$(this.pitchBends,n,"ticks"),this},Object.defineProperty(e.prototype,"duration",{get:function(){var e=this.notes[this.notes.length-1];return e?e.time+e.duration:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"durationTicks",{get:function(){var e=this.notes[this.notes.length-1];return e?e.ticks+e.durationTicks:0},enumerable:!0,configurable:!0}),e.prototype.fromJSON=function(e){var t=this;for(var n in this.name=e.name,this.channel=e.channel,this.instrument=new Qa(void 0,this),this.instrument.fromJSON(e.instrument),e.controlChanges)e.controlChanges[n]&&e.controlChanges[n].forEach(function(e){t.addCC({number:e.number,ticks:e.ticks,value:e.value})});e.notes.forEach(function(e){t.addNote({durationTicks:e.durationTicks,midi:e.midi,ticks:e.ticks,velocity:e.velocity})})},e.prototype.toJSON=function(){for(var e={},t=0;t<127;t++)this.controlChanges.hasOwnProperty(t)&&(e[t]=this.controlChanges[t].map(function(e){return e.toJSON()}));return{channel:this.channel,controlChanges:e,pitchBends:this.pitchBends.map(function(e){return e.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(e){return e.toJSON()})}},e}(),da=qh;Sc.Track=da;var v={},rh=v&&v.__awaiter||function(r,e,t,a){return new(t||(t=Promise))(function(n,o){function i(r){try{u(a.next(r))}catch(e){o(e)}}function c(r){try{u(a.throw(r))}catch(e){o(e)}}function u(r){var e;r.done?n(r.value):(e=r.value,e instanceof t?e:new t(function(r){r(e)})).then(i,c)}u((a=a.apply(r,e||[])).next())})},sh=v&&v.__generator||function(r,e){var t,a,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,a&&(n=2&o[0]?a.return:o[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue;}o=e.call(r,i)}catch(c){o=[6,c],a=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};Object.defineProperty(v,"__esModule",{value:!0});var th=function(){function r(r){var e=this,t=null;r&&(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),(t=Ig(r)).tracks.forEach(function(r){var e=0;r.forEach(function(r){e+=r.deltaTime,r.absoluteTime=e})}),t.tracks=uh(t.tracks)),this.header=new Ka(t),this.tracks=[],r&&(this.tracks=t.tracks.map(function(r){return new da(r,e.header)}),1===t.header.format&&0===this.tracks[0].duration&&this.tracks.shift())}return r.fromUrl=function(e){return rh(this,void 0,void 0,function(){var t;return sh(this,function(a){switch(a.label){case 0:return[4,fetch(e)];case 1:return(t=a.sent()).ok?[4,t.arrayBuffer()]:[3,3];case 2:return[2,new r(a.sent())];case 3:throw new Error("could not load "+e);}})})},Object.defineProperty(r.prototype,"name",{get:function(){return this.header.name},set:function(r){this.header.name=r},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"duration",{get:function(){var r=this.tracks.map(function(r){return r.duration});return Math.max.apply(Math,r)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"durationTicks",{get:function(){var r=this.tracks.map(function(r){return r.durationTicks});return Math.max.apply(Math,r)},enumerable:!0,configurable:!0}),r.prototype.addTrack=function(){var r=new da(void 0,this.header);return this.tracks.push(r),r},r.prototype.toArray=function(){return Ec(this)},r.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(r){return r.toJSON()})}},r.prototype.fromJSON=function(r){var e=this;this.header=new Ka,this.header.fromJSON(r.header),this.tracks=r.tracks.map(function(r){var t=new da(void 0,e.header);return t.fromJSON(r),t})},r.prototype.clone=function(){var e=new r;return e.fromJSON(this.toJSON()),e},r}(),Tc=th;function uh(r){for(var e=[],t=0;t<r.length;t++)for(var a=e.length,n=new Map,o=Array(16).fill(0),i=0,c=r[t];i<c.length;i++){var u=c[i],s=a,$=u.channel;if(void 0!==$){"programChange"===u.type&&(o[$]=u.programNumber);var f=o[$]+" "+$;n.has(f)?s=n.get(f):(s=a+n.size,n.set(f,s))}e[s]||e.push([]),e[s].push(u)}return e}v.Midi=Tc;var vh,Ra,Vh=(ha(),{}),Wh=arguments[0],ea={};!function(t,r){"object"==typeof ea?ea=r():"function"==typeof Ra&&Ra.amd?Ra([],r):"object"==typeof ea?(vh=r(),ea.Meyda=vh):t.Meyda=r()}(window,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(r){return t[r]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s="./src/index.js")}({"./node_modules/assert/assert.js":function(t,r,e){(function(r){function n(t,r){if(t===r)return 0;for(var e=t.length,n=r.length,o=0,i=Math.min(e,n);o<i;++o)if(t[o]!==r[o]){e=t[o],n=r[o];break}return e<n?-1:n<e?1:0}function o(t){return r.Buffer&&"function"==typeof r.Buffer.isBuffer?r.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var i=e("./node_modules/webpack-stream/node_modules/util/util.js"),a=Object.prototype.hasOwnProperty,u=Array.prototype.slice,c="foo"===function(){}.name;function f(t){return Object.prototype.toString.call(t)}function s(t){return!o(t)&&"function"==typeof r.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var l=t.exports=b,p=/\s*function\s+([^\(\s]*)\s*/;function m(t){if(i.isFunction(t)){if(c)return t.name;var r=t.toString().match(p);return r&&r[1]}}function y(t,r){return"string"==typeof t?t.length<r?t:t.slice(0,r):t}function h(t){if(c||!i.isFunction(t))return i.inspect(t);var r=m(t);return"[Function"+(r?": "+r:"")+"]"}function d(t,r,e,n,o){throw new l.AssertionError({message:e,actual:t,expected:r,operator:n,stackStartFunction:o})}function b(t,r){t||d(t,!0,r,"==",l.ok)}function g(t,r,e,a){if(t===r)return!0;if(o(t)&&o(r))return 0===n(t,r);if(i.isDate(t)&&i.isDate(r))return t.getTime()===r.getTime();if(i.isRegExp(t)&&i.isRegExp(r))return t.source===r.source&&t.global===r.global&&t.multiline===r.multiline&&t.lastIndex===r.lastIndex&&t.ignoreCase===r.ignoreCase;if(null!==t&&"object"==typeof t||null!==r&&"object"==typeof r){if(s(t)&&s(r)&&f(t)===f(r)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(r.buffer));if(o(t)!==o(r))return!1;var c=(a=a||{actual:[],expected:[]}).actual.indexOf(t);return-1!==c&&c===a.expected.indexOf(r)||(a.actual.push(t),a.expected.push(r),function(t,r,e,n){if(null==t||null==r)return!1;if(i.isPrimitive(t)||i.isPrimitive(r))return t===r;if(e&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(r))return!1;var o=v(t),a=v(r);if(o&&!a||!o&&a)return!1;if(o)return t=u.call(t),r=u.call(r),g(t,r,e);var c,f,s=j(t),l=j(r);if(s.length!==l.length)return!1;for(s.sort(),l.sort(),f=s.length-1;f>=0;f--)if(s[f]!==l[f])return!1;for(f=s.length-1;f>=0;f--)if(c=s[f],!g(t[c],r[c],e,n))return!1;return!0}(t,r,e,a))}return e?t===r:t==r}function v(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function S(t,r){if(!t||!r)return!1;if("[object RegExp]"==Object.prototype.toString.call(r))return r.test(t);try{if(t instanceof r)return!0}catch(e){}return!Error.isPrototypeOf(r)&&!0===r.call({},t)}function w(t,r,e,n){var o;if("function"!=typeof r)throw new TypeError("\"block\" argument must be a function");"string"==typeof e&&(n=e,e=null),o=function(t){var r;try{t()}catch(e){r=e}return r}(r),n=(e&&e.name?" ("+e.name+").":".")+(n?" "+n:"."),t&&!o&&d(o,e,"Missing expected exception"+n);var a="string"==typeof n,u=!t&&o&&!e;if((!t&&i.isError(o)&&a&&S(o,e)||u)&&d(o,e,"Got unwanted exception"+n),t&&o&&e&&!S(o,e)||!t&&o)throw o}l.AssertionError=function(t){var r;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=y(h((r=this).actual),128)+" "+r.operator+" "+y(h(r.expected),128),this.generatedMessage=!0);var e=t.stackStartFunction||d;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var o=n.stack,i=m(e),a=o.indexOf("\n"+i);if(a>=0){var u=o.indexOf("\n",a+1);o=o.substring(u+1)}this.stack=o}}},i.inherits(l.AssertionError,Error),l.fail=d,l.ok=b,l.equal=function(t,r,e){t!=r&&d(t,r,e,"==",l.equal)},l.notEqual=function(t,r,e){t==r&&d(t,r,e,"!=",l.notEqual)},l.deepEqual=function(t,r,e){g(t,r,!1)||d(t,r,e,"deepEqual",l.deepEqual)},l.deepStrictEqual=function(t,r,e){g(t,r,!0)||d(t,r,e,"deepStrictEqual",l.deepStrictEqual)},l.notDeepEqual=function(t,r,e){g(t,r,!1)&&d(t,r,e,"notDeepEqual",l.notDeepEqual)},l.notDeepStrictEqual=function t(r,e,n){g(r,e,!0)&&d(r,e,n,"notDeepStrictEqual",t)},l.strictEqual=function(t,r,e){t!==r&&d(t,r,e,"===",l.strictEqual)},l.notStrictEqual=function(t,r,e){t===r&&d(t,r,e,"!==",l.notStrictEqual)},l.throws=function(t,r,e){w(!0,t,r,e)},l.doesNotThrow=function(t,r,e){w(!1,t,r,e)},l.ifError=function(t){if(t)throw t};var j=Object.keys||function(t){var r=[];for(var e in t)a.call(t,e)&&r.push(e);return r}}).call(this,e("./node_modules/webpack-stream/node_modules/webpack/buildin/global.js"))},"./node_modules/dct/index.js":function(t,r,e){t.exports=e("./node_modules/dct/src/dct.js")},"./node_modules/dct/src/dct.js":function(t,r){var e=null,n=function(t){(e=e||{})[t]=new Array(t*t);for(var r=Math.PI/t,n=0;n<t;n++)for(var o=0;o<t;o++)e[t][o+n*t]=Math.cos(r*(o+.5)*n)};t.exports=function(t,r){var o=t.length;return r=r||2,e&&e[o]||n(o),t.map(function(){return 0}).map(function(n,i){return r*t.reduce(function(t,r,n,a){return t+r*e[o][n+i*o]},0)})}},"./node_modules/fftjs/dist/fft.js":function(t,r,e){var n=e("./node_modules/fftjs/dist/utils.js"),o=function(t){var r={};void 0===t.real||void 0===t.imag?r=n.constructComplexArray(t):(r.real=t.real.slice(),r.imag=t.imag.slice());var e=r.real.length,o=Math.log2(e);if(Math.round(o)!=o)throw new Error("Input size must be a power of 2.");if(r.real.length!=r.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var i=n.bitReverseArray(e),a={real:[],imag:[]},u=0;u<e;u++)a.real[i[u]]=r.real[u],a.imag[i[u]]=r.imag[u];for(var c=0;c<e;c++)r.real[c]=a.real[c],r.imag[c]=a.imag[c];for(var f=1;f<=o;f++)for(var s=Math.pow(2,f),l=0;l<s/2;l++)for(var p=n.euler(l,s),m=0;m<e/s;m++){var y=s*m+l,h=s*m+l+s/2,d={real:r.real[y],imag:r.imag[y]},b={real:r.real[h],imag:r.imag[h]},g=n.multiply(p,b),v=n.subtract(d,g);r.real[h]=v.real,r.imag[h]=v.imag;var S=n.add(g,d);r.real[y]=S.real,r.imag[y]=S.imag}return r};t.exports={fft:o,ifft:function(t){if(void 0===t.real||void 0===t.imag)throw new Error("IFFT only accepts a complex input.");for(var r=t.real.length,e={real:[],imag:[]},i=0;i<r;i++){var a={real:t.real[i],imag:t.imag[i]},u=n.conj(a);e.real[i]=u.real,e.imag[i]=u.imag}var c=o(e);return e.real=c.real.map(function(t){return t/r}),e.imag=c.imag.map(function(t){return t/r}),e}}},"./node_modules/fftjs/dist/utils.js":function(t,r,e){function n(t){if(Array.isArray(t)){for(var r=0,e=Array(t.length);r<t.length;r++)e[r]=t[r];return e}return Array.from(t)}var o={},i={};t.exports={bitReverseArray:function(t){if(void 0===o[t]){for(var r=(t-1).toString(2).length,e="0".repeat(r),i={},a=0;a<t;a++){var u=a.toString(2);u=e.substr(u.length)+u,u=[].concat(n(u)).reverse().join(""),i[a]=parseInt(u,2)}o[t]=i}return o[t]},multiply:function(t,r){return{real:t.real*r.real-t.imag*r.imag,imag:t.real*r.imag+t.imag*r.real}},add:function(t,r){return{real:t.real+r.real,imag:t.imag+r.imag}},subtract:function(t,r){return{real:t.real-r.real,imag:t.imag-r.imag}},euler:function(t,r){var e=-2*Math.PI*t/r;return{real:Math.cos(e),imag:Math.sin(e)}},conj:function(t){return t.imag*=-1,t},constructComplexArray:function(t){var r={};r.real=void 0===t.real?t.slice():t.real.slice();var e=r.real.length;return void 0===i[e]&&(i[e]=Array.apply(null,Array(e)).map(Number.prototype.valueOf,0)),r.imag=i[e].slice(),r}}},"./node_modules/inherits/inherits_browser.js":function(t,r){"function"==typeof Object.create?t.exports=function(t,r){t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,r){t.super_=r;var e=function(){};e.prototype=r.prototype,t.prototype=new e,t.prototype.constructor=t}},"./node_modules/process/browser.js":function(t,r){var e,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var c,f=[],s=!1,l=-1;function p(){s&&c&&(s=!1,c.length?f=c.concat(f):l=-1,f.length&&m())}function m(){if(!s){var t=u(p);s=!0;for(var r=f.length;r;){for(c=f,f=[];++l<r;)c&&c[l].run();l=-1,r=f.length}c=null,s=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(r){try{return n.call(null,t)}catch(r){return n.call(this,t)}}}(t)}}function y(t,r){this.fun=t,this.array=r}function h(){}o.nextTick=function(t){var r=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)r[e-1]=arguments[e];f.push(new y(t,r)),1!==f.length||s||u(m)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"./node_modules/webpack-stream/node_modules/util/support/isBufferBrowser.js":function(t,r){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},"./node_modules/webpack-stream/node_modules/util/util.js":function(t,r,e){(function(t){var n=Object.getOwnPropertyDescriptors||function(t){for(var r=Object.keys(t),e={},n=0;n<r.length;n++)e[r[n]]=Object.getOwnPropertyDescriptor(t,r[n]);return e},o=/%[sdj%]/g;r.format=function(t){if(!b(t)){for(var r=[],e=0;e<arguments.length;e++)r.push(u(arguments[e]));return r.join(" ")}e=1;for(var n=arguments,i=n.length,a=String(t).replace(o,function(t){if("%%"===t)return"%";if(e>=i)return t;switch(t){case"%s":return String(n[e++]);case"%d":return Number(n[e++]);case"%j":try{return JSON.stringify(n[e++])}catch(r){return"[Circular]"}default:return t;}}),c=n[e];e<i;c=n[++e])h(c)||!S(c)?a+=" "+c:a+=" "+u(c);return a},r.deprecate=function(e,n){if(void 0!==t&&!0===t.noDeprecation)return e;if(void 0===t)return function(){return r.deprecate(e,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),o=!0}return e.apply(this,arguments)}};var i,a={};function u(t,e){var n={seen:[],stylize:f};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),y(e)?n.showHidden=e:e&&r._extend(n,e),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),s(n,t,n.depth)}function c(t,r){var e=u.styles[r];return e?"\x1B["+u.colors[e][0]+"m"+t+"\x1B["+u.colors[e][1]+"m":t}function f(t,r){return t}function s(t,e,n){if(t.customInspect&&e&&x(e.inspect)&&e.inspect!==r.inspect&&(!e.constructor||e.constructor.prototype!==e)){var o=e.inspect(n,t);return b(o)||(o=s(t,o,n)),o}var i=function(t,r){if(g(r))return t.stylize("undefined","undefined");if(b(r)){var e="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\"")+"'";return t.stylize(e,"string")}if(d(r))return t.stylize(""+r,"number");if(y(r))return t.stylize(""+r,"boolean");if(h(r))return t.stylize("null","null")}(t,e);if(i)return i;var a=Object.keys(e),u=function(t){var r={};return t.forEach(function(t,e){r[t]=!0}),r}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),j(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(e);if(0===a.length){if(x(e)){var c=e.name?": "+e.name:"";return t.stylize("[Function"+c+"]","special")}if(v(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(w(e))return t.stylize(Date.prototype.toString.call(e),"date");if(j(e))return l(e)}var f,S="",_=!1,M=["{","}"];(m(e)&&(_=!0,M=["[","]"]),x(e))&&(S=" [Function"+(e.name?": "+e.name:"")+"]");return v(e)&&(S=" "+RegExp.prototype.toString.call(e)),w(e)&&(S=" "+Date.prototype.toUTCString.call(e)),j(e)&&(S=" "+l(e)),0!==a.length||_&&0!=e.length?n<0?v(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),f=_?function(t,r,e,n,o){for(var i=[],a=0,u=r.length;a<u;++a)O(r,String(a))?i.push(p(t,r,e,n,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(p(t,r,e,n,o,!0))}),i}(t,e,n,u,a):a.map(function(r){return p(t,e,n,u,r,_)}),t.seen.pop(),function(t,r,e){if(t.reduce(function(t,r){return 0,r.indexOf("\n")>=0&&0,t+r.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return e[0]+(""===r?"":r+"\n ")+" "+t.join(",\n  ")+" "+e[1];return e[0]+r+" "+t.join(", ")+" "+e[1]}(f,S,M)):M[0]+S+M[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,r,e,n,o,i){var a,u,c;if((c=Object.getOwnPropertyDescriptor(r,o)||{value:r[o]}).get?u=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(u=t.stylize("[Setter]","special")),O(n,o)||(a="["+o+"]"),u||(t.seen.indexOf(c.value)<0?(u=h(e)?s(t,c.value,null):s(t,c.value,e-1)).indexOf("\n")>-1&&(u=i?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),g(a)){if(i&&o.match(/^\d+$/))return u;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,"\"").replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+u}function m(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function h(t){return null===t}function d(t){return"number"==typeof t}function b(t){return"string"==typeof t}function g(t){return void 0===t}function v(t){return S(t)&&"[object RegExp]"===_(t)}function S(t){return"object"==typeof t&&null!==t}function w(t){return S(t)&&"[object Date]"===_(t)}function j(t){return S(t)&&("[object Error]"===_(t)||t instanceof Error)}function x(t){return"function"==typeof t}function _(t){return Object.prototype.toString.call(t)}function M(t){return t<10?"0"+t.toString(10):t.toString(10)}r.debuglog=function(e){if(g(i)&&(i=""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var n=t.pid;a[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else a[e]=function(){};return a[e]},r.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=m,r.isBoolean=y,r.isNull=h,r.isNullOrUndefined=function(t){return null==t},r.isNumber=d,r.isString=b,r.isSymbol=function(t){return"symbol"==typeof t},r.isUndefined=g,r.isRegExp=v,r.isObject=S,r.isDate=w,r.isError=j,r.isFunction=x,r.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},r.isBuffer=e("./node_modules/webpack-stream/node_modules/util/support/isBufferBrowser.js");var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(t,r){return Object.prototype.hasOwnProperty.call(t,r)}r.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":"),[t.getDate(),E[t.getMonth()],e].join(" ")),r.format.apply(r,arguments))},r.inherits=e("./node_modules/inherits/inherits_browser.js"),r._extend=function(t,r){if(!r||!S(r))return t;for(var e=Object.keys(r),n=e.length;n--;)t[e[n]]=r[e[n]];return t};var T="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(t,r){if(!t){var e=new Error("Promise was rejected with a falsy value");e.reason=t,t=e}return r(t)}r.promisify=function(t){if("function"!=typeof t)throw new TypeError("The \"original\" argument must be of type Function");if(T&&t[T]){var r;if("function"!=typeof(r=t[T]))throw new TypeError("The \"util.promisify.custom\" argument must be of type Function");return Object.defineProperty(r,T,{value:r,enumerable:!1,writable:!1,configurable:!0}),r}function r(){for(var r,e,n=new Promise(function(t,n){r=t,e=n}),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push(function(t,n){t?e(t):r(n)});try{t.apply(this,o)}catch(a){e(a)}return n}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),T&&Object.defineProperty(r,T,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,n(t))},r.promisify.custom=T,r.callbackify=function(r){if("function"!=typeof r)throw new TypeError("The \"original\" argument must be of type Function");function e(){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n]);var o=e.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};r.apply(this,e).then(function(r){t.nextTick(a,null,r)},function(r){t.nextTick(A,r,a)})}return Object.setPrototypeOf(e,Object.getPrototypeOf(r)),Object.defineProperties(e,n(r)),e}}).call(this,e("./node_modules/process/browser.js"))},"./node_modules/webpack-stream/node_modules/webpack/buildin/global.js":function(t,r){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(n){"object"==typeof window&&(e=window)}t.exports=e},"./src/extractors/chroma.js":function(t,r,e){function n(t){return function(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError("Valid ampSpectrum is required to generate chroma");if("object"!==o(t.chromaFilterBank))throw new TypeError("Valid chromaFilterBank is required to generate chroma");var r=t.chromaFilterBank.map(function(r,e){return t.ampSpectrum.reduce(function(t,e,n){return t+e*r[n]},0)}),e=Math.max.apply(Math,n(r));return e?r.map(function(t){return t/e}):r}},"./src/extractors/energy.js":function(t,r,e){e.r(r);e("./node_modules/assert/assert.js");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(){if("object"!==n(arguments[0].signal))throw new TypeError;for(var t=0,r=0;r<arguments[0].signal.length;r++)t+=Math.pow(Math.abs(arguments[0].signal[r]),2);return t}},"./src/extractors/extractorUtilities.js":function(t,r,e){function n(t,r){for(var e=0,n=0,o=0;o<r.length;o++)e+=Math.pow(o,t)*Math.abs(r[o]),n+=r[o];return e/n}e.r(r),e.d(r,"mu",function(){return n})},"./src/extractors/loudness.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(t){if("object"!==n(t.ampSpectrum)||"object"!==n(t.barkScale))throw new TypeError;var r=new Float32Array(24),e=0,o=t.ampSpectrum,i=new Int32Array(25);i[0]=0;for(var a=t.barkScale[o.length-1]/24,u=1,c=0;c<o.length;c++)for(;t.barkScale[c]>a;)i[u++]=c,a=u*t.barkScale[o.length-1]/24;i[24]=o.length-1;for(var f=0;f<24;f++){for(var s=0,l=i[f];l<i[f+1];l++)s+=o[l];r[f]=Math.pow(s,.23)}for(var p=0;p<r.length;p++)e+=r[p];return{specific:r,total:e}}},"./src/extractors/mfcc.js":function(t,r,e){e.r(r);var n=e("./src/extractors/powerSpectrum.js");e("./src/utilities.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=e("./node_modules/dct/index.js");r.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError("Valid ampSpectrum is required to generate MFCC");if("object"!==o(t.melFilterBank))throw new TypeError("Valid melFilterBank is required to generate MFCC");var r=Math.min(40,Math.max(1,t.numberOfMFCCCoefficients||13)),e=Object(n.default)(t),a=t.melFilterBank.length,u=Array(a);if(a<r)throw new Error("Insufficient filter bank for requested number of coefficients");for(var c=new Float32Array(a),f=0;f<c.length;f++){u[f]=new Float32Array(t.bufferSize/2),c[f]=0;for(var s=0;s<t.bufferSize/2;s++)u[f][s]=t.melFilterBank[f][s]*e[s],c[f]+=u[f][s];c[f]=Math.log(c[f]+1)}var l=Array.prototype.slice.call(c);return i(l).slice(0,r)}},"./src/extractors/perceptualSharpness.js":function(t,r,e){e.r(r);var n=e("./src/extractors/loudness.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(){if("object"!==o(arguments[0].signal))throw new TypeError;for(var t=Object(n.default)(arguments[0]),r=t.specific,e=0,i=0;i<r.length;i++)e+=i<15?(i+1)*r[i+1]:.066*Math.exp(.171*(i+1));return e*=.11/t.total}},"./src/extractors/perceptualSpread.js":function(t,r,e){e.r(r);var n=e("./src/extractors/loudness.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(){if("object"!==o(arguments[0].signal))throw new TypeError;for(var t=Object(n.default)(arguments[0]),r=0,e=0;e<t.specific.length;e++)t.specific[e]>r&&(r=t.specific[e]);return Math.pow((t.total-r)/t.total,2)}},"./src/extractors/powerSpectrum.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(){if("object"!==n(arguments[0].ampSpectrum))throw new TypeError;for(var t=new Float32Array(arguments[0].ampSpectrum.length),r=0;r<t.length;r++)t[r]=Math.pow(arguments[0].ampSpectrum[r],2);return t}},"./src/extractors/rms.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(t){if("object"!==n(t.signal))throw new TypeError;for(var r=0,e=0;e<t.signal.length;e++)r+=Math.pow(t.signal[e],2);return r/=t.signal.length,r=Math.sqrt(r)}},"./src/extractors/spectralCentroid.js":function(t,r,e){e.r(r);var n=e("./src/extractors/extractorUtilities.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(){if("object"!==o(arguments[0].ampSpectrum))throw new TypeError;return Object(n.mu)(1,arguments[0].ampSpectrum)}},"./src/extractors/spectralFlatness.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(){if("object"!==n(arguments[0].ampSpectrum))throw new TypeError;for(var t=0,r=0,e=0;e<arguments[0].ampSpectrum.length;e++)t+=Math.log(arguments[0].ampSpectrum[e]),r+=arguments[0].ampSpectrum[e];return Math.exp(t/arguments[0].ampSpectrum.length)*arguments[0].ampSpectrum.length/r}},"./src/extractors/spectralFlux.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(t){if("object"!==n(t.signal)||"object"!=n(t.previousSignal))throw new TypeError;for(var r=0,e=-t.bufferSize/2;e<signal.length/2-1;e++)x=Math.abs(t.signal[e])-Math.abs(t.previousSignal[e]),r+=(x+Math.abs(x))/2;return r}},"./src/extractors/spectralKurtosis.js":function(t,r,e){e.r(r);var n=e("./src/extractors/extractorUtilities.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(){if("object"!==o(arguments[0].ampSpectrum))throw new TypeError;var t=arguments[0].ampSpectrum,r=Object(n.mu)(1,t),e=Object(n.mu)(2,t),i=Object(n.mu)(3,t),a=Object(n.mu)(4,t);return(-3*Math.pow(r,4)+6*r*e-4*r*i+a)/Math.pow(Math.sqrt(e-Math.pow(r,2)),4)}},"./src/extractors/spectralRolloff.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(){if("object"!==n(arguments[0].ampSpectrum))throw new TypeError;for(var t=arguments[0].ampSpectrum,r=arguments[0].sampleRate/(2*(t.length-1)),e=0,o=0;o<t.length;o++)e+=t[o];for(var i=.99*e,a=t.length-1;e>i&&a>=0;)e-=t[a],--a;return(a+1)*r}},"./src/extractors/spectralSkewness.js":function(t,r,e){e.r(r);var n=e("./src/extractors/extractorUtilities.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError;var r=Object(n.mu)(1,t.ampSpectrum),e=Object(n.mu)(2,t.ampSpectrum),i=Object(n.mu)(3,t.ampSpectrum);return(2*Math.pow(r,3)-3*r*e+i)/Math.pow(Math.sqrt(e-Math.pow(r,2)),3)}},"./src/extractors/spectralSlope.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(t){if("object"!==n(t.ampSpectrum))throw new TypeError;for(var r=0,e=0,o=new Float32Array(t.ampSpectrum.length),i=0,a=0,u=0;u<t.ampSpectrum.length;u++){r+=t.ampSpectrum[u];var c=u*t.sampleRate/t.bufferSize;o[u]=c,i+=c*c,e+=c,a+=c*t.ampSpectrum[u]}return(t.ampSpectrum.length*a-e*r)/(r*(i-Math.pow(e,2)))}},"./src/extractors/spectralSpread.js":function(t,r,e){e.r(r);var n=e("./src/extractors/extractorUtilities.js");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.default=function(t){if("object"!==o(t.ampSpectrum))throw new TypeError;return Math.sqrt(Object(n.mu)(2,t.ampSpectrum)-Math.pow(Object(n.mu)(1,t.ampSpectrum),2))}},"./src/extractors/zcr.js":function(t,r,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(r),r.default=function(){if("object"!==n(arguments[0].signal))throw new TypeError;for(var t=0,r=1;r<arguments[0].signal.length;r++)(arguments[0].signal[r-1]>=0&&arguments[0].signal[r]<0||arguments[0].signal[r-1]<0&&arguments[0].signal[r]>=0)&&t++;return t}},"./src/featureExtractors.js":function(t,r,e){e.r(r),e.d(r,"buffer",function(){return S}),e.d(r,"complexSpectrum",function(){return w}),e.d(r,"amplitudeSpectrum",function(){return j});var n=e("./src/extractors/rms.js");e.d(r,"rms",function(){return n.default});var o=e("./src/extractors/energy.js");e.d(r,"energy",function(){return o.default});var i=e("./src/extractors/spectralSlope.js");e.d(r,"spectralSlope",function(){return i.default});var a=e("./src/extractors/spectralCentroid.js");e.d(r,"spectralCentroid",function(){return a.default});var u=e("./src/extractors/spectralRolloff.js");e.d(r,"spectralRolloff",function(){return u.default});var c=e("./src/extractors/spectralFlatness.js");e.d(r,"spectralFlatness",function(){return c.default});var f=e("./src/extractors/spectralSpread.js");e.d(r,"spectralSpread",function(){return f.default});var s=e("./src/extractors/spectralSkewness.js");e.d(r,"spectralSkewness",function(){return s.default});var l=e("./src/extractors/spectralKurtosis.js");e.d(r,"spectralKurtosis",function(){return l.default});var p=e("./src/extractors/zcr.js");e.d(r,"zcr",function(){return p.default});var m=e("./src/extractors/loudness.js");e.d(r,"loudness",function(){return m.default});var y=e("./src/extractors/perceptualSpread.js");e.d(r,"perceptualSpread",function(){return y.default});var h=e("./src/extractors/perceptualSharpness.js");e.d(r,"perceptualSharpness",function(){return h.default});var d=e("./src/extractors/mfcc.js");e.d(r,"mfcc",function(){return d.default});var b=e("./src/extractors/chroma.js");e.d(r,"chroma",function(){return b.default});var g=e("./src/extractors/powerSpectrum.js");e.d(r,"powerSpectrum",function(){return g.default});var v=e("./src/extractors/spectralFlux.js");e.d(r,"spectralFlux",function(){return v.default});var S=function(t){return t.signal},w=function(t){return t.complexSpectrum},j=function(t){return t.ampSpectrum}},"./src/index.js":function(t,r,e){t.exports=e("./src/main.js").default},"./src/main.js":function(t,r,e){e.r(r);var n=e("./src/utilities.js"),o=e("./src/featureExtractors.js"),i=e("./node_modules/fftjs/dist/fft.js"),a=e("./src/meyda-wa.js");function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:o,EXTRACTION_STARTED:!1,numberOfMFCCCoefficients:13,_featuresToExtract:[],windowing:n.applyWindow,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(t){return new a.MeydaAnalyzer(t,Object.assign({},c))},extract:function(t,r,e){var o=this;if(!r)throw this._errors.invalidInput;if("object"!=u(r))throw this._errors.invalidInput;if(!t)throw this._errors.featureUndef;if(!n.isPowerOfTwo(r.length))throw this._errors.notPow2;void 0!==this.barkScale&&this.barkScale.length==this.bufferSize||(this.barkScale=n.createBarkScale(this.bufferSize,this.sampleRate,this.bufferSize)),void 0!==this.melFilterBank&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=n.createMelFilterBank(Math.max(this.melBands,this.numberOfMFCCCoefficients),this.sampleRate,this.bufferSize)),void 0!==this.chromaFilterBank&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=n.createChromaFilterBank(this.chromaBands,this.sampleRate,this.bufferSize)),void 0===r.buffer?this.signal=n.arrayToTyped(r):this.signal=r;var i=f(r,this.windowingFunction,this.bufferSize);if(this.signal=i.windowedSignal,this.complexSpectrum=i.complexSpectrum,this.ampSpectrum=i.ampSpectrum,e){var a=f(e,this.windowingFunction,this.bufferSize);this.previousSignal=a.windowedSignal,this.previousComplexSpectrum=a.complexSpectrum,this.previousAmpSpectrum=a.ampSpectrum}var c=function(t){return o.featureExtractors[t]({ampSpectrum:o.ampSpectrum,chromaFilterBank:o.chromaFilterBank,complexSpectrum:o.complexSpectrum,signal:o.signal,bufferSize:o.bufferSize,sampleRate:o.sampleRate,barkScale:o.barkScale,melFilterBank:o.melFilterBank,previousSignal:o.previousSignal,previousAmpSpectrum:o.previousAmpSpectrum,previousComplexSpectrum:o.previousComplexSpectrum,numberOfMFCCCoefficients:o.numberOfMFCCCoefficients})};if("object"===u(t))return t.reduce(function(t,r){return Object.assign({},t,(e={},n=r,o=c(r),n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e));var e,n,o},{});if("string"==typeof t)return c(t);throw this._errors.invalidFeatureFmt}},f=function(t,r,e){var o={};void 0===t.buffer?o.signal=n.arrayToTyped(t):o.signal=t,o.windowedSignal=n.applyWindow(o.signal,r),o.complexSpectrum=Object(i.fft)(o.windowedSignal),o.ampSpectrum=new Float32Array(e/2);for(var a=0;a<e/2;a++)o.ampSpectrum[a]=Math.sqrt(Math.pow(o.complexSpectrum.real[a],2)+Math.pow(o.complexSpectrum.imag[a],2));return o};r.default=c,"undefined"!=typeof window&&(window.Meyda=c)},"./src/meyda-wa.js":function(t,r,e){e.r(r),e.d(r,"MeydaAnalyzer",function(){return a});var n=e("./src/utilities.js"),o=e("./src/featureExtractors.js");function i(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(r,e){var i=this;if(function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this._m=e,!r.audioContext)throw this._m.errors.noAC;if(r.bufferSize&&!n.isPowerOfTwo(r.bufferSize))throw this._m._errors.notPow2;if(!r.source)throw this._m._errors.noSource;this._m.audioContext=r.audioContext,this._m.bufferSize=r.bufferSize||this._m.bufferSize||256,this._m.hopSize=r.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=r.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=r.callback,this._m.windowingFunction=r.windowingFunction||"hanning",this._m.featureExtractors=o,this._m.EXTRACTION_STARTED=r.startImmediately||!1,this._m.channel="number"==typeof r.channel?r.channel:0,this._m.inputs=r.inputs||1,this._m.outputs=r.outputs||1,this._m.numberOfMFCCCoefficients=r.numberOfMFCCCoefficients||this._m.numberOfMFCCCoefficients||13,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,this._m.inputs,this._m.outputs),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=r.featureExtractors||[],this._m.barkScale=n.createBarkScale(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=n.createMelFilterBank(Math.max(this._m.melBands,this._m.numberOfMFCCCoefficients),this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(r.source),this._m.spn.onaudioprocess=function(t){if(null!==i._m.inputData&&(i._m.previousInputData=i._m.inputData),i._m.inputData=t.inputBuffer.getChannelData(i._m.channel),i._m.previousInputData)(r=new Float32Array(i._m.previousInputData.length+i._m.inputData.length-i._m.hopSize)).set(i._m.previousInputData.slice(i._m.hopSize)),r.set(i._m.inputData,i._m.previousInputData.length-i._m.hopSize);else var r=i._m.inputData;n.frame(r,i._m.bufferSize,i._m.hopSize).forEach(function(t){i._m.frame=t;var r=i._m.extract(i._m._featuresToExtract,i._m.frame,i._m.previousFrame);"function"==typeof i._m.callback&&i._m.EXTRACTION_STARTED&&i._m.callback(r),i._m.previousFrame=i._m.frame})}}var r,e,a;return r=t,(e=[{key:"start",value:function(t){this._m._featuresToExtract=t||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0}},{key:"stop",value:function(){this._m.EXTRACTION_STARTED=!1}},{key:"setSource",value:function(t){this._m.source&&this._m.source.disconnect(this._m.spn),this._m.source=t,this._m.source.connect(this._m.spn)}},{key:"setChannel",value:function(t){t<=this._m.inputs?this._m.channel=t:console.error("Channel ".concat(t," does not exist. Make sure you've provided a value for 'inputs' that is greater than ").concat(t," when instantiating the MeydaAnalyzer"))}},{key:"get",value:function(t){return this._m.inputData?this._m.extract(t||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null}}])&&i(r.prototype,e),a&&i(r,a),t}()},"./src/utilities.js":function(t,r,e){e.r(r),e.d(r,"isPowerOfTwo",function(){return a}),e.d(r,"error",function(){return u}),e.d(r,"pointwiseBufferMult",function(){return c}),e.d(r,"applyWindow",function(){return f}),e.d(r,"createBarkScale",function(){return s}),e.d(r,"typedToArray",function(){return l}),e.d(r,"arrayToTyped",function(){return p}),e.d(r,"_normalize",function(){return m}),e.d(r,"normalize",function(){return y}),e.d(r,"normalizeToOne",function(){return h}),e.d(r,"mean",function(){return d}),e.d(r,"melToFreq",function(){return v}),e.d(r,"freqToMel",function(){return S}),e.d(r,"createMelFilterBank",function(){return w}),e.d(r,"hzToOctaves",function(){return j}),e.d(r,"normalizeByColumn",function(){return x}),e.d(r,"createChromaFilterBank",function(){return _}),e.d(r,"frame",function(){return M});var n=e("./src/windowing.js");function o(t){return function(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i={};function a(t){for(;t%2==0&&t>1;)t/=2;return 1===t}function u(t){throw new Error("Meyda: "+t)}function c(t,r){for(var e=[],n=0;n<Math.min(t.length,r.length);n++)e[n]=t[n]*r[n];return e}function f(t,r){if("rect"!==r){if(""!==r&&r||(r="hanning"),i[r]||(i[r]={}),!i[r][t.length])try{i[r][t.length]=n[r](t.length)}catch(e){throw new Error("Invalid windowing function")}t=c(t,i[r][t.length])}return t}function s(t,r,e){for(var n=new Float32Array(t),o=0;o<n.length;o++)n[o]=o*r/e,n[o]=13*Math.atan(n[o]/1315.8)+3.5*Math.atan(Math.pow(n[o]/7518,2));return n}function l(t){return Array.prototype.slice.call(t)}function p(t){return Float32Array.from(t)}function m(t,r){return t/r}function y(t,r){return t.map(function(t){return m(t,r)})}function h(t){var r=Math.max.apply(null,t);return t.map(function(t){return t/r})}function d(t){return t.reduce(function(t,r){return t+r})/t.length}function b(t){return 700*(Math.exp(t/1125)-1)}function g(t){return 1125*Math.log(1+t/700)}function v(t){return b(t)}function S(t){return g(t)}function w(t,r,e){for(var n=new Float32Array(t+2),o=new Float32Array(t+2),i=r/2,a=g(0),u=(g(i)-a)/(t+1),c=Array(t+2),f=0;f<n.length;f++)n[f]=f*u,o[f]=b(n[f]),c[f]=Math.floor((e+1)*o[f]/r);for(var s=Array(t),l=0;l<s.length;l++){s[l]=Array.apply(null,new Array(e/2+1)).map(Number.prototype.valueOf,0);for(var p=c[l];p<c[l+1];p++)s[l][p]=(p-c[l])/(c[l+1]-c[l]);for(var m=c[l+1];m<c[l+2];m++)s[l][m]=(c[l+2]-m)/(c[l+2]-c[l+1])}return s}function j(t,r){return Math.log2(16*t/r)}function x(t){var r=t[0].map(function(){return 0}),e=t.reduce(function(t,r){return r.forEach(function(r,e){t[e]+=Math.pow(r,2)}),t},r).map(Math.sqrt);return t.map(function(t,r){return t.map(function(t,r){return t/(e[r]||1)})})}function _(t,r,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:440,c=Math.floor(e/2)+1,f=new Array(e).fill(0).map(function(n,o){return t*j(r*o/e,u)});f[0]=f[1]-1.5*t;var s=f.slice(1).map(function(t,r){return Math.max(t-f[r])},1).concat([1]),l=Math.round(t/2),p=new Array(t).fill(0).map(function(r,e){return f.map(function(r){return(10*t+l+r-e)%t-l})}),m=p.map(function(t,r){return t.map(function(t,e){return Math.exp(-.5*Math.pow(2*p[r][e]/s[e],2))})});if(m=x(m),i){var y=f.map(function(r){return Math.exp(-.5*Math.pow((r/t-n)/i,2))});m=m.map(function(t){return t.map(function(t,r){return t*y[r]})})}return a&&(m=[].concat(o(m.slice(3)),o(m.slice(0,3)))),m.map(function(t){return t.slice(0,c)})}function M(t,r,e){if(t.length<r)throw new Error("Buffer is too short for frame length");if(e<1)throw new Error("Hop length cannot be less that 1");if(r<1)throw new Error("Frame length cannot be less that 1");var n=1+Math.floor((t.length-r)/e);return new Array(n).fill(0).map(function(n,o){return t.slice(o*e,o*e+r)})}},"./src/windowing.js":function(t,r,e){function n(t){for(var r=new Float32Array(t),e=2*Math.PI/(t-1),n=2*e,o=0;o<t/2;o++)r[o]=.42-.5*Math.cos(o*e)+.08*Math.cos(o*n);for(var i=t/2;i>0;i--)r[t-i]=r[i-1];return r}function o(t){for(var r=Math.PI/(t-1),e=new Float32Array(t),n=0;n<t;n++)e[n]=Math.sin(r*n);return e}function i(t){for(var r=new Float32Array(t),e=0;e<t;e++)r[e]=.5-.5*Math.cos(2*Math.PI*e/(t-1));return r}function a(t){for(var r=new Float32Array(t),e=0;e<t;e++)r[e]=.54-.46*Math.cos(2*Math.PI*(e/t-1));return r}e.r(r),e.d(r,"blackman",function(){return n}),e.d(r,"sine",function(){return o}),e.d(r,"hanning",function(){return i}),e.d(r,"hamming",function(){return a})}})});var Uc=e&&e.__awaiter||function($,t,r,e){return new(r||(r=Promise))(function(o,i){function d($){try{a(e.next($))}catch(t){i(t)}}function l($){try{a(e.throw($))}catch(t){i(t)}}function a($){var t;$.done?o($.value):(t=$.value,t instanceof r?t:new r(function($){$(t)})).then(d,l)}a((e=e.apply($,t||[])).next())})};const wh=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],xh=g(a($=>Hg($)),f(),wh),Sa=g(wa({raw:a($=>$),tonicMidi:a($=>tc($.tonic+"2")%12),majorKey:a($=>$.tonic),minorKey:a($=>Ag($.minorRelative).toLowerCase()),normalizedMidis:a($=>g(a($=>tc($+"2")%12),f(),$.scale))}),f(),xh);e.scales=Sa;const Vc=$=>{const t=g(T(a(t=>$[t]?t:null),ua($=>null!==$)),f(),Nb(12)),r=g(T(a($=>Ba(new Set($.normalizedMidis),new Set(t))),a($=>Array.from($))),f(),Sa);let e=g(wa({majorKey:a($=>$[0].majorKey),minorKey:a($=>$[0].minorKey),normalizedMidis:a($=>$[0].normalizedMidis),common:a($=>$[1]),similarity:a($=>$[1].length/t.length+(t.includes($[0].tonicMidi)?.1:0))}),f(),of(Sa,r));return e=e.sort(($,t)=>t.similarity-$.similarity)};e.getComparisons=Vc;const H=[...Cf(!1,12)];e.defaultKeyState=H;const yh=[...U(12,Sb([!0,!1],[.5,.5]))];e.randomKeyState=yh;const Wc=$=>{let t=new Tc($).tracks;t.sort(($,t)=>t.notes.length-$.notes.length);const r=t[0],e=g(a($=>$[0]%12),f(),U(7,bc(r.notes.map($=>$.midi))));return Array.from(new Set(e))};e.parseMidiFile=Wc;const zh=()=>{try{return new AudioContext}catch($){return new window.webkitAudioContext}},Ah=($,t)=>Uc(void 0,void 0,void 0,function*(){try{return yield $.decodeAudioData(t)}catch(r){return new Promise((r,e)=>{$.decodeAudioData(t,r,e)})}}),Bh=$=>Math.pow(2,Math.round(Math.log($)/Math.log(2))),Xc=$=>Uc(void 0,void 0,void 0,function*(){var $visD$$interop$default=I(ea);const t=zh(),r=yield Ah(t,$),e=r.getChannelData(0),o=Bh(r.sampleRate/1),i=Math.floor(e.length/o),d=g(a($=>$visD$$interop$default.d.extract("chroma",e.slice($*o,($+1)*o))),f(),Nb(i)),l=g(a($=>$.indexOf(1)),f(),d);return g(a($=>$[0]),f(),g(a($=>$),f(),bc(l)).sort(($,t)=>t[1]-$[1])).slice(0,7)});e.parseAudioFile=Xc;const Ch=e=>{const t=e.views,i=t.size.deref(),r=Math.min(400*1.1,.9*i[0]),o=t.viewConfig.deref(),s=Vc(t.keyState.deref()),a={width:r,height:r/35,rx:5,fill:"#e2e2e2"};return["div.dib",...s.map((t,i)=>["div.mv2.mr2",{onmouseover:i=>{i.preventDefault(),e.bus.dispatch([ya,t.normalizedMidis])},onmouseleave:t=>{t.preventDefault(),e.bus.dispatch([Vb])}},["div.flex",["div",t.majorKey,o.showSmall?["small"," maj"]:[]],o.showMinor?["div",["span.red"," \u30FB "],t.minorKey,o.showSmall?["small"," min"]:[]]:[]],["div",["svg",{width:1.1*r,height:r/35},["g",["rect",a],t.common.length>0?["rect",Object.assign(Object.assign({},a),{width:(t.similarity-.1)*r,fill:"#000"})]:[]]]]])]};var Ta={};var Dh=Ta&&Ta.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function($,o){function i(e){try{s(a.next(e))}catch(t){o(t)}}function n(e){try{s(a.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?$(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,n)}s((a=a.apply(e,t||[])).next())})};const fa=e=>{e.preventDefault()},Eh=(e,t)=>{fa(t);const r=t.dataTransfer.files;if(r&&r.length>0){const t=new FileReader,a=r[0];t.onload=t=>Dh(void 0,void 0,void 0,function*(){if("audio/midi"===a.type){e.dispatch([o,a.name]);const r=Wc(t.target.result);e.dispatch([E,H.map((e,t)=>!!r.includes(t))])}else if("audio/aac"===a.type||"audio/mpeg"===a.type||"audio/wav"===a.type){e.dispatch([o,a.name]);const r=yield Xc(t.target.result);e.dispatch([E,H.map((e,t)=>!!r.includes(t))])}else e.dispatch([Zb])}),t.readAsArrayBuffer(a)}},Yc=e=>{const t=e.bus,r=e.views,a=r.midiFile.deref(),$=r.size.deref();return["div.mt2.mb4.ba.b--dotted.bw1.dib.pa4.v-mid.tc",{ondrop:e=>{e.target.classList.remove("dragover"),Eh(t,e)},ondragenter:e=>{e.target.classList.add("dragover"),fa(e)},ondragleave:e=>{e.target.classList.remove("dragover"),fa(e)},ondragover:e=>fa(e),style:{width:`${Math.min(400*1.1,.9*$[0])}px`}},a]};Ta.fileDropZone=Yc;const Fh={w:16,h:8,pad:2,margin:0},Gh=Ff(Object.assign(Object.assign({},Fh),{vertical:!1})),Hh=e=>{const i=e.views.viewConfig.deref();return["div",Object.entries(i).map(([i,$])=>["div.mv2",[Gh,{class:"pointer mr2",onclick:()=>e.bus.dispatch([Xb,i])},$],i])]};const Ih=Df({element:"h2",attribs:{class:"#000"}}),Jh=e=>()=>["div",[Ih,"OP-Z KEY FINDER"],[Lf,e],[Nf,e],["div.mb2",[Sf,e],[Ch,e]],[Yc,e],["div.db",["details",["summary","View Config"],[Hh,e]]]];const Ua={id:"home",match:["home"]};const Kh={router:{useFragment:!0,defaultRouteID:Ua.id,routes:[Ua]},events:{[Hf]:Qe("debug",$=>1^$),[V]:[($,[o,i])=>({[d]:[O,["keyState",i]]})],[E]:[($,[o,i])=>({[d]:[n,["keyState",i]]})],[Tb]:[()=>({[d]:[E,H]})],[Ub]:[()=>({[d]:[E,[...U(12,Sb([!0,!1],[.5,.5]))]]})],[ya]:[($,[o,i])=>({[d]:[n,["highlights",i]]})],[Vb]:[()=>({[d]:[ya,[]]})],[Wb]:[()=>({[d]:[n,["size",[window.innerWidth,window.innerHeight]]]})],[Xb]:[($,[o,i])=>({[d]:[O,["viewConfig",i]]})],[Yb]:[($,[o,i])=>({[d]:[[O,"enabledMidi"],[n,["midiDevices",i]]]})],[o]:[($,[o,i])=>({[d]:[[n,["midiFile",i]]]})],[Zb]:[()=>({[d]:[o,"INVALID MIDI FILE..."],[wb]:[xb,[500,"DROP MIDI/AUDIO FILE HERE..."],o,o]})],[If]:[($,[o,i])=>({[d]:[[n,["comparison",i]]]})]},effects:{},components:{[Ua.id]:Jh},domRoot:"app",initialState:{enabledMidi:!1,midiDevices:[],midiFile:"DROP MIDI/AUDIO FILE HERE...",keyState:H,highlights:[],size:[window.innerWidth,window.innerHeight],viewConfig:{showMinor:!0,showSmall:!0},route:{},debug:1},views:{enabledMidi:"enabledMidi",midiDevices:"midiDevices",midiFile:"midiFile",keyState:"keyState",highlights:"highlights",size:"size",viewConfig:"viewConfig",json:["",$=>JSON.stringify($,null,2)],debug:"debug"},ui:{root:{class:"flex-ns sans-serif ma0"},toolbar:{button:{class:"mr3 pv2 ph2 bg-black white f4"}},code:{class:"ma0 ml4 pa2 f7 bg-light-gray code overflow-x-hidden"},column:{content:[{class:"w-90-ns ma2"},{class:"w-50-ns ma2"}],debug:[{class:"w-10-ns ma2 close"},{class:"w-50-ns ma2 open"}]},debugToggle:{class:"toggle pointer"}}};new Mf(Kh).start();return{"B6dB":{}};});